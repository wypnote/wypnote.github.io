<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>codetopæ’åºç¯‡</title>
      <link href="/2025/05/19/codetop%E6%8E%92%E5%BA%8F%E7%AF%87/"/>
      <url>/2025/05/19/codetop%E6%8E%92%E5%BA%8F%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h3 id="åŠ›æ‰£912-æ’åºæ•°ç»„"><a href="#åŠ›æ‰£912-æ’åºæ•°ç»„" class="headerlink" title="åŠ›æ‰£912. æ’åºæ•°ç»„"></a>åŠ›æ‰£912. æ’åºæ•°ç»„</h3><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œè¯·ä½ å°†è¯¥æ•°ç»„å‡åºæ’åˆ—ã€‚</p><p>ä½ å¿…é¡»åœ¨ <strong>ä¸ä½¿ç”¨ä»»ä½•å†…ç½®å‡½æ•°</strong> çš„æƒ…å†µä¸‹è§£å†³é—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <code>O(nlog(n))</code>ï¼Œå¹¶ä¸”ç©ºé—´å¤æ‚åº¦å°½å¯èƒ½å°ã€‚</p><h4 id="å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åº"><a href="#å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åº" class="headerlink" title="å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åº"></a>å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åº</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// qsort(nums, 0, nums.size()- 1);</span></span><br><span class="line">        <span class="comment">// merge_sort(nums, 0, nums.size()- 1);</span></span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">qsort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; q, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> x = q[(l + r) &gt;&gt; <span class="number">1</span>], i = l - <span class="number">1</span>, j = r + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">do</span> i ++ ; <span class="keyword">while</span>(q[i] &lt; x);</span><br><span class="line">            <span class="keyword">do</span> j -- ; <span class="keyword">while</span> (q[j] &gt; x);</span><br><span class="line">            <span class="keyword">if</span> (i &lt; j)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> t = q[i];</span><br><span class="line">                q[i] = q[j];</span><br><span class="line">                q[j] = t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">qsort</span>(q, l, j);</span><br><span class="line">        <span class="built_in">qsort</span>(q, j + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">merge_sort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; q, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">merge_sort</span>(q, l, mid), <span class="built_in">merge_sort</span>(q, mid + <span class="number">1</span>, r);</span><br><span class="line"></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tmp</span><span class="params">(r - l + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> k = <span class="number">0</span>, i = l, j = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= r)</span><br><span class="line">            <span class="keyword">if</span> (q[i] &lt;= q[j]) tmp[k ++ ] = q[i ++ ];</span><br><span class="line">            <span class="keyword">else</span> tmp[k ++ ] = q[j ++ ];</span><br><span class="line">        <span class="keyword">while</span>(i &lt;= mid) tmp[k ++ ] = q[i ++ ];</span><br><span class="line">        <span class="keyword">while</span> (j &lt;= r) tmp[k ++ ] = q[j ++ ];</span><br><span class="line">       <span class="comment">// æ¯æ¬¡é€’å½’ï¼Œtmpéƒ½æ˜¯ä»0å¼€å§‹çš„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = l, j = <span class="number">0</span>; i &lt;= r; i ++ , j ++ ) q[i] = tmp[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="å †æ’åº-å¤§æ ¹å †å’Œå°æ ¹å †"><a href="#å †æ’åº-å¤§æ ¹å †å’Œå°æ ¹å †" class="headerlink" title="å †æ’åº(å¤§æ ¹å †å’Œå°æ ¹å †)"></a>å †æ’åº(å¤§æ ¹å †å’Œå°æ ¹å †)</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">heap</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ 1-based ç´¢å¼•ï¼Œåœ¨å‰é¢æ’å…¥ä¸€ä¸ªæ— ç”¨çš„æ•°</span></span><br><span class="line">    nums.<span class="built_in">insert</span>(nums.<span class="built_in">begin</span>(), <span class="number">-1</span>);</span><br><span class="line">    <span class="type">int</span> n = nums.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»ºå †ï¼ˆå°æ ¹å †ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n / <span class="number">2</span>; i; i--) <span class="built_in">down</span>(nums, i, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt; <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">swap</span>(nums[<span class="number">1</span>], nums[i]);</span><br><span class="line">        <span class="built_in">down</span>(nums, <span class="number">1</span>, i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å»æ‰å“¨å…µå…ƒç´ ï¼ˆè¿˜åŸä¸º 0-based æ•°ç»„ï¼‰</span></span><br><span class="line">    nums.<span class="built_in">erase</span>(nums.<span class="built_in">begin</span>());</span><br><span class="line">    <span class="built_in">reverse</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> u, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> t = u;</span><br><span class="line">    <span class="keyword">if</span> (u * <span class="number">2</span> &lt;= size &amp;&amp; nums[u * <span class="number">2</span>] &lt; nums[t]) </span><br><span class="line">        t = u * <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (u * <span class="number">2</span> + <span class="number">1</span> &lt;= size  &amp;&amp; nums[u * <span class="number">2</span> + <span class="number">1</span>] &lt; nums[t]) </span><br><span class="line">        t = u * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (u != t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">swap</span>(nums[t], nums[u]);</span><br><span class="line">        <span class="built_in">down</span>(nums,t,size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ğŸ§ éœ€è¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯ï¼Œç®—æ³•æ¨¡æ¿æ˜¯ä»å°åˆ°å¤§è¾“å‡ºæœ€å°çš„æ•°ï¼Œä½†æ•´ä¸ªçš„å †å¹¶ä¸æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Šä¸‹é¢çš„è¿™æ®µä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt; <span class="number">1</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">swap</span>(nums[<span class="number">1</span>], nums[i]);</span><br><span class="line">    <span class="built_in">down</span>(nums, <span class="number">1</span>, i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>âœ…æœ€å¥½çš„æ–¹æ³•è¿˜æ˜¯ä½¿ç”¨å¤§æ ¹å †æ¥å®ç°å‡åºæ’åº</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">heap</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    nums.<span class="built_in">insert</span>(nums.<span class="built_in">begin</span>(), <span class="number">-1</span>);   <span class="comment">// ä¸‹æ ‡ä»1å¼€å§‹</span></span><br><span class="line">    <span class="type">int</span> n = nums.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å»ºç«‹å¤§æ ¹å †</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n / <span class="number">2</span>; i; i -- ) <span class="built_in">down</span>(nums, i, n);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt; <span class="number">1</span>; i -- )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">swap</span>(nums[<span class="number">1</span>], nums[i]);</span><br><span class="line">        <span class="built_in">up</span>(nums, <span class="number">1</span>, i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">    num.<span class="built_in">erase</span>(nums.<span class="built_in">begin</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> u, <span class="type">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> t = u;</span><br><span class="line">    <span class="keyword">if</span> (u * <span class="number">2</span> &lt;= size &amp;&amp; nums[u * <span class="number">2</span>] &gt; nums[t]) t = u * <span class="number">2</span>;    </span><br><span class="line">    <span class="keyword">if</span> (u * <span class="number">2</span> + <span class="number">1</span> &lt;= size &amp;&amp; nums[u * <span class="number">2</span> + <span class="number">1</span>] &gt; nums[t]) t = u * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (u != t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">swap</span>(nums[u], nums[t]);</span><br><span class="line">        <span class="built_in">down</span>(nums, t, size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¿’ä¸€äº›å®¹å™¨çš„çŸ¥è¯†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;æ•°æ®ç±»å‹&gt; å˜é‡å;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">std::vector&lt;<span class="type">int</span>&gt; s&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line"><span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">s</span><span class="params">(<span class="number">5</span>)</span></span>;  <span class="comment">// è®¾ç½®äº†5ä¸ªå¤§å°çš„å®¹å™¨</span></span><br><span class="line"><span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">s</span><span class="params">(<span class="number">5</span>,<span class="number">100</span>)</span></span>;  <span class="comment">// è¿™ä¸ªå®¹å™¨æ‹¥æœ‰äº”ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ çš„åˆå§‹å€¼ä¸º100</span></span><br></pre></td></tr></table></figure><p>å®¹å™¨çš„å‡ ä¸ªæ–°ç”¨æ³•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;<span class="type">int</span>&gt; s;</span><br><span class="line">s.<span class="built_in">push_back</span>(å€¼);  <span class="comment">//å°†å€¼æ·»åŠ åˆ°å®¹å™¨æœ«å°¾</span></span><br><span class="line">s.<span class="built_in">pop_back</span>();  <span class="comment">//å°†æœ«å°¾çš„å€¼åˆ é™¤æ‰</span></span><br><span class="line">s.<span class="built_in">insert</span>(s.<span class="built_in">begin</span>()<span class="number">+2</span>, <span class="number">2</span>); <span class="comment">// åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ </span></span><br><span class="line">s.<span class="built_in">assign</span>(<span class="number">10</span>,<span class="number">100</span>); <span class="comment">//å°†sé‡æ–°åˆå§‹åŒ–ä¸ºæ‹¥æœ‰10ä¸ªå…ƒç´   æ¯ä¸ªå…ƒç´ ä½100çš„å®¹å™¨</span></span><br><span class="line">s.<span class="built_in">erase</span>(s.<span class="built_in">begin</span>() + <span class="number">2</span>);   <span class="comment">// åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ </span></span><br><span class="line">s.<span class="built_in">clear</span>(); <span class="comment">// å°†å®¹å™¨æ¸…ç©º</span></span><br><span class="line">s.<span class="built_in">empty</span>(); <span class="comment">//çœ‹çœ‹æ˜¯ä¸æ˜¯ç©ºçš„</span></span><br></pre></td></tr></table></figure><p>å®¹å™¨æ¯”æ•°ç»„æ›´çµæ´»ï¼Œæ’åºçš„æ—¶å€™å¯ä»¥å½“åšæ•°ç»„æ¥æ“ä½œï¼ï¼ï¼</p>]]></content>
      
      
      <categories>
          
          <category> codetop </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•ç»å…¸é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿œç¨‹æ¡Œé¢æ§åˆ¶ï¼ˆä¸€ï¼‰</title>
      <link href="/2025/04/07/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%8E%A7%E5%88%B6%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2025/04/07/%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%8E%A7%E5%88%B6%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="å•ä¾‹æ¨¡å¼æ˜¯æ€ä¹ˆå®ç°çš„"><a href="#å•ä¾‹æ¨¡å¼æ˜¯æ€ä¹ˆå®ç°çš„" class="headerlink" title="å•ä¾‹æ¨¡å¼æ˜¯æ€ä¹ˆå®ç°çš„"></a>å•ä¾‹æ¨¡å¼æ˜¯æ€ä¹ˆå®ç°çš„</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CServerSocket</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">static</span> CServerSocket* m_instance;</span><br><span class="line">    <span class="type">static</span> CHelper m_helper; <span class="comment">// è¾…åŠ©ç±»ï¼Œç¡®ä¿æ„é€ å’Œææ„</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> CServerSocket* <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!m_instance) m_instance = <span class="keyword">new</span> <span class="built_in">CServerSocket</span>();</span><br><span class="line">        <span class="keyword">return</span> m_instance;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">CServerSocket</span>() &#123; ... &#125; <span class="comment">// ç§æœ‰æ„é€ </span></span><br><span class="line">    ~<span class="built_in">CServerSocket</span>() &#123; ... &#125; <span class="comment">// ç§æœ‰ææ„</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">CHelper</span> &#123; <span class="comment">// RAII ç®¡ç†å•ä¾‹ç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">CHelper</span>() &#123; CServerSocket::<span class="built_in">getInstance</span>(); &#125;</span><br><span class="line">        ~<span class="built_in">CHelper</span>() &#123; CServerSocket::<span class="built_in">releaseInstance</span>(); &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>è®¾è®¡æ€æƒ³</strong>ï¼š</p><ul><li><strong>ç¦æ­¢ç”¨æˆ·ç›´æ¥æ„é€ </strong>ï¼Œå¿…é¡»é€šè¿‡ <code>getInstance()</code> è·å–å”¯ä¸€å¯¹è±¡ã€‚</li><li><code>CHelper</code> è¾…åŠ©ç±»ï¼š<ul><li>æ„é€ æ—¶è‡ªåŠ¨åˆ›å»º <code>CServerSocket</code> å•ä¾‹ã€‚</li><li>ææ„æ—¶è‡ªåŠ¨é‡Šæ”¾ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</li></ul></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><table><thead><tr><th><strong>æ¨¡å—</strong></th><th><strong>æ ¸å¿ƒåŠŸèƒ½</strong></th></tr></thead><tbody><tr><td><strong><code>CPacket</code></strong></td><td>åè®®å°è£…ï¼Œæä¾› <strong>æ‰“åŒ…&#x2F;è§£åŒ…</strong> èƒ½åŠ›</td></tr><tr><td><strong><code>CServerSocket</code></strong></td><td>æœåŠ¡å™¨æ ¸å¿ƒï¼Œ<strong>å•ä¾‹ç®¡ç†</strong>ã€<strong>æ”¶å‘æ•°æ®</strong></td></tr><tr><td><strong>å•ä¾‹æ¨¡å¼</strong></td><td>ç¡®ä¿å…¨å±€å”¯ä¸€æœåŠ¡å™¨å®ä¾‹</td></tr><tr><td><strong>å­—èŠ‚å¯¹é½ (<code>#pragma pack</code>)</strong></td><td>ä¿è¯æ•°æ®åŒ…ä¸¥æ ¼å¯¹é½ï¼Œé¿å…è§£æé”™è¯¯</td></tr></tbody></table><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>å°å‹å®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡ï¼ˆå¦‚æ–‡ä»¶ä¼ è¾“ã€è¿œç¨‹æ§åˆ¶ç­‰ï¼‰ã€‚</li><li>å¯æ‰©å±•æ€§è¾ƒå¼ºï¼Œ<code>sCmd</code> å¯ç”¨äºæ‰©å±•ä¸åŒä¸šåŠ¡é€»è¾‘ã€‚</li></ul><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CServerSocket* CServerSocket::m_instance = <span class="literal">NULL</span>;  <span class="comment">// é™æ€æˆå‘˜åˆå§‹åŒ–</span></span><br><span class="line">CServerSocket::CHelper CServerSocket::m_helper;   <span class="comment">// RAIIè¾…åŠ©å¯¹è±¡</span></span><br><span class="line">CServerSocket* pserver = CServerSocket::<span class="built_in">getInstance</span>(); <span class="comment">// å…¨å±€è®¿é—®ç‚¹</span></span><br></pre></td></tr></table></figure><h4 id="è®¾è®¡æ¨¡å¼è§£æ"><a href="#è®¾è®¡æ¨¡å¼è§£æ" class="headerlink" title="è®¾è®¡æ¨¡å¼è§£æ"></a>è®¾è®¡æ¨¡å¼è§£æ</h4><ol><li><p><strong>å•ä¾‹æ§åˆ¶</strong></p><ul><li><code>m_instance</code> ä½œä¸ºé™æ€æŒ‡é’ˆï¼Œä¿è¯å…¨è¿›ç¨‹å”¯ä¸€å®ä¾‹</li><li>é€šè¿‡ <code>getInstance()</code> è·å–å”¯ä¸€å®ä¾‹ï¼Œé¦–æ¬¡è°ƒç”¨æ—¶æ„é€ å¯¹è±¡</li></ul></li><li><p><strong>RAII</strong>åŠ©æ‰‹ç±» (<code>CHelper</code>)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CHelper</span> &#123;<span class="keyword">public</span>:    <span class="built_in">CHelper</span>() &#123; CServerSocket::<span class="built_in">getInstance</span>(); &#125;  <span class="comment">// æ„é€ æ—¶è§¦å‘å•ä¾‹åˆ›å»º    ~CHelper() &#123; CServerSocket::releaseInstance(); &#125; // ææ„æ—¶é‡Šæ”¾å•ä¾‹&#125;;</span></span><br></pre></td></tr></table></figure><ul><li><strong>æ„é€ é˜¶æ®µ</strong>ï¼šç¨‹åºå¯åŠ¨æ—¶ï¼Œå…¨å±€ <code>m_helper</code> çš„æ„é€ è‡ªåŠ¨è§¦å‘å•ä¾‹åˆ›å»º</li><li><strong>ææ„é˜¶æ®µ</strong>ï¼šç¨‹åºé€€å‡ºæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ <code>releaseInstance()</code> é‡Šæ”¾èµ„æº</li></ul></li><li><p><strong>å…¨å±€è®¿é—®ç‚¹</strong></p><ul><li><p><code>pserver</code> æä¾›å…¨å±€ç»Ÿä¸€è®¿é—®å…¥å£</p></li><li><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pserver-&gt;<span class="built_in">InitSocket</span>();  <span class="comment">// ä»»ä½•åœ°æ–¹éƒ½å¯ç›´æ¥ä½¿ç”¨</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="https://bu.dusays.com/2025/04/07/67f3df51097fb.png"></p><h3 id="CPacket-æ‰“åŒ…æ„é€ å‡½æ•°"><a href="#CPacket-æ‰“åŒ…æ„é€ å‡½æ•°" class="headerlink" title="CPacket æ‰“åŒ…æ„é€ å‡½æ•°"></a><code>CPacket</code> æ‰“åŒ…æ„é€ å‡½æ•°</h3><h4 id="æ„é€ å‡½æ•°åŸå‹"><a href="#æ„é€ å‡½æ•°åŸå‹" class="headerlink" title="æ„é€ å‡½æ•°åŸå‹"></a>æ„é€ å‡½æ•°åŸå‹</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CPacket::<span class="built_in">CPacket</span>(WORD nCmd, <span class="type">const</span> BYTE* pData, <span class="type">size_t</span> nSize) </span><br></pre></td></tr></table></figure><h4 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h4><table><thead><tr><th>å‚æ•°</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>nCmd</code></td><td><code>WORD</code></td><td>åè®®å‘½ä»¤å­—ï¼ˆ2å­—èŠ‚ï¼‰</td></tr><tr><td><code>pData</code></td><td><code>const BYTE*</code></td><td>è´Ÿè½½æ•°æ®æŒ‡é’ˆ</td></tr><tr><td><code>nSize</code></td><td><code>size_t</code></td><td>è´Ÿè½½æ•°æ®é•¿åº¦</td></tr></tbody></table><h2 id="ä¸»ç¨‹åº"><a href="#ä¸»ç¨‹åº" class="headerlink" title="ä¸»ç¨‹åº"></a>ä¸»ç¨‹åº</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RemoveCtrl.cpp : æ­¤æ–‡ä»¶åŒ…å« &quot;main&quot; å‡½æ•°ã€‚ç¨‹åºæ‰§è¡Œå°†åœ¨æ­¤å¤„å¼€å§‹å¹¶ç»“æŸã€‚</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;pch.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;framework.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;RemoveCtrl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ServerSocket.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;direct.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _DEBUG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> new DEBUG_NEW</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">//#pragma comment(linker, &quot;/subsystem:windows /entry:WinMainCRTStartup&quot; )</span></span><br><span class="line"><span class="comment">//#pragma comment(linker, &quot;/subsystem:windows /entry:mainCRTStartup&quot; )</span></span><br><span class="line"><span class="comment">//#pragma comment(linker, &quot;/subsystem:console /entry:WinMainCRTStartup&quot; )</span></span><br><span class="line"><span class="comment">//#pragma comment(linker, &quot;/subsystem:console /entry:mainCRTStartup&quot; )</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å”¯ä¸€çš„åº”ç”¨ç¨‹åºå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">CWinApp theApp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ç»™å®šçš„äºŒè¿›åˆ¶æ•°æ®ä»¥åå…­è¿›åˆ¶æ ¼å¼æ‰“å°å‡ºæ¥ï¼Œå¹¶å°†è¾“å‡ºå‘é€åˆ°è°ƒè¯•å™¨ï¼ˆé€šè¿‡OutputDebugStringAï¼‰</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dump</span><span class="params">(BYTE* pData, <span class="type">size_t</span> nSize)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    std::string strOut;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; nSize; i++) &#123;</span><br><span class="line">        <span class="type">char</span> buf[<span class="number">8</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; (i % <span class="number">16</span> == <span class="number">0</span>)) strOut += <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="built_in">snprintf</span>(buf, <span class="built_in">sizeof</span>(buf), <span class="string">&quot;%02X &quot;</span>, pData[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        strOut += buf;</span><br><span class="line">    &#125;</span><br><span class="line">    strOut += <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="built_in">OutputDebugStringA</span>(strOut.<span class="built_in">c_str</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">MakeDriverInfo</span><span class="params">()</span> </span>&#123; <span class="comment">// 1 =&gt; A   2 =&gt; B  3 =&gt; C</span></span><br><span class="line">    std::string result;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">26</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//æŸ¥çœ‹æ¯ä¸ªé©±åŠ¨å™¨æ˜¯å¦å­˜åœ¨ï¼ˆé€šè¿‡_chdriveå‡½æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (_chdrive(i) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//å°†å­˜åœ¨çš„é©±åŠ¨å­—æ¯ï¼ˆå¦‚Aã€Bã€Cï¼‰æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨é€—å·åˆ†éš”ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (result.<span class="built_in">size</span>() &gt; <span class="number">0</span>)</span><br><span class="line">result += <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">            result += <span class="string">&#x27;A&#x27;</span> + i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æœ€åè°ƒç”¨ CServerSocket::getInstance()-&gt;Send(CPacket()) å‘é€æ•°æ®åŒ…ã€‚</span></span><br><span class="line">    <span class="comment">//CServerSocket::getInstance()-&gt;Send(CPacket(1,(BYTE*)result.c_str(),result.size()));</span></span><br><span class="line">    <span class="function">CPacket <span class="title">pack</span><span class="params">(<span class="number">1</span>, (BYTE*)result.c_str(), result.size())</span></span>;</span><br><span class="line">    <span class="built_in">Dump</span>((BYTE*)pack.<span class="built_in">Data</span>(), pack.<span class="built_in">Size</span>());</span><br><span class="line"><span class="comment">//CServerSocket::getInstance()-&gt;Send(pack);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;io.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;RemoteCtrl.h&quot;</span></span></span><br><span class="line"><span class="comment">/*ç»“æ„ä½“å’Œç±»ååˆ†ç›¸ä¼¼  åŒºåˆ«æ˜¯ç»“æ„ä½“é»˜è®¤æ˜¯public   ç±»é»˜è®¤æ˜¯private*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">file_info</span>&#123;</span><br><span class="line">    <span class="built_in">file_info</span>() &#123;</span><br><span class="line">        IsInvalid = <span class="number">0</span>;</span><br><span class="line">        IsDirectory = <span class="number">-1</span>;</span><br><span class="line">        HasNext = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">memset</span>(szFileName, <span class="number">0</span>, <span class="built_in">sizeof</span>(szFileName));</span><br><span class="line">    &#125;</span><br><span class="line">    BOOL IsInvalid; <span class="comment">// æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">    BOOL HasNext; <span class="comment">// æ˜¯å¦è¿˜æœ‰åç»­    0   å¦  1 æ˜¯</span></span><br><span class="line">    <span class="type">char</span> szFileName[<span class="number">256</span>]; <span class="comment">// æ–‡ä»¶å </span></span><br><span class="line">    BOOL IsDirectory;  <span class="comment">// æ˜¯å¦ä¸ºç›®å½•  0 å¦ 1  æ˜¯ </span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;FILEINFO, *PFILEINFO;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> nRetCode = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    HMODULE hModule = ::<span class="built_in">GetModuleHandle</span>(<span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (hModule != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ– MFC å¹¶åœ¨å¤±è´¥æ—¶æ˜¾ç¤ºé”™è¯¯  </span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">AfxWinInit</span>(hModule, <span class="literal">nullptr</span>, ::<span class="built_in">GetCommandLine</span>(), <span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> åœ¨æ­¤å¤„ä¸ºåº”ç”¨ç¨‹åºçš„è¡Œä¸ºç¼–å†™ä»£ç ã€‚</span></span><br><span class="line">            <span class="built_in">wprintf</span>(<span class="string">L&quot;é”™è¯¯: MFC åˆå§‹åŒ–å¤±è´¥\n&quot;</span>);</span><br><span class="line">            nRetCode = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¥—æ¥å­—åˆå§‹åŒ–</span></span><br><span class="line">       </span><br><span class="line">            <span class="comment">// è§‚å¯Ÿæ–‡ä»¶</span></span><br><span class="line">            <span class="type">int</span> nCmd = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">switch</span> (nCmd)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// æŸ¥çœ‹ç£ç›˜åˆ†åŒº</span></span><br><span class="line">                <span class="built_in">MakeDriverInfo</span>();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="built_in">MakeDirectoryInfo</span>();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> æ›´æ”¹é”™è¯¯ä»£ç ä»¥ç¬¦åˆéœ€è¦</span></span><br><span class="line">        <span class="built_in">wprintf</span>(<span class="string">L&quot;é”™è¯¯: GetModuleHandle å¤±è´¥\n&quot;</span>);</span><br><span class="line">        nRetCode = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> nRetCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœ¨é©¬è¿œæ§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt09TCP-IPç½‘ç»œé€šä¿¡</title>
      <link href="/2025/03/13/Qt09TCP-IP%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/"/>
      <url>/2025/03/13/Qt09TCP-IP%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<p>TCP&#x2F;IPé€šä¿¡ï¼ˆå³SOCKETé€šä¿¡ï¼‰æ˜¯é€šè¿‡ç½‘çº¿å°†<strong>æœåŠ¡å™¨Serverç«¯</strong>å’Œ<strong>å®¢æˆ·æœºClientç«¯</strong>è¿›è¡Œè¿æ¥ï¼Œåœ¨éµå¾ªISO&#x2F;OSIæ¨¡å‹çš„å››å±‚å±‚çº§æ„æ¶çš„åŸºç¡€ä¸Šé€šè¿‡TCP&#x2F;IPåè®®å»ºç«‹çš„é€šè®¯ã€‚æ§åˆ¶å™¨å¯ä»¥è®¾ç½®ä¸ºæœåŠ¡å™¨ç«¯æˆ–å®¢æˆ·ç«¯ã€‚</p><p>å…³äºTCP&#x2F;IPåè®®å¯è¯¦çœ‹ï¼š<a href="https://zhuanlan.zhihu.com/p/33889997">TCP&#x2F;IPåè®®è¯¦è§£ - çŸ¥ä¹ (zhihu.com)</a></p><p> æ€»çš„æ¥è¯´ï¼ŒTCP&#x2F;IPé€šè®¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><strong>å®¢æˆ·ç«¯</strong>å’Œ<strong>æœåŠ¡å™¨</strong></li><li><strong>QTcpServerï¼ˆç›‘å¬å¥—æ¥å­—ï¼‰<strong>å’Œ</strong>QTcpSocketï¼ˆé€šè®¯å¥—æ¥å­—ï¼‰</strong></li></ul><p>ç›‘å¬å¥—æ¥å­—ï¼Œé¡¾åæ€ä¹‰ï¼Œç›‘å¬å…³äºå„ç§é€šè®¯çš„çŠ¶æ€ï¼Œä¸€æ—¦è¿›è¡Œé€šè®¯ï¼Œç›‘å¬å¥—æ¥å­—ä¼šå¯åŠ¨é€šè®¯å¥—æ¥å­—ï¼Œè¿›è¡Œé€šè®¯</p><p>å®¢æˆ·ç«¯ä½¿ç”¨connectToHostå‡½æ•°ä¸»åŠ¨è¿æ¥æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨ä¼šè§¦å‘newConnectioè¿™ä¸ªæ§½å‡½æ•°ï¼Œå¹¶è¿›è¡Œå–å‡ºQTcpServerï¼ˆç›‘å¬å¥—æ¥å­—ï¼‰ï¼Œå°†ç›¸å…³å†…å®¹å–å‡ºå¹¶èµ‹ç»™QTcpSocketï¼ˆé€šè®¯å¥—æ¥å­—ï¼‰ã€‚<br>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œè§¦å‘readyReadï¼ˆï¼‰ï¼Œè¿›è¡Œå¤„ç†ï¼Œå½¼æ­¤ä¼ é€’æ—¶ï¼ŒåŸç†éƒ½æ˜¯è¿™æ ·çš„ã€‚</p><p><strong>å¯¹åŒæ–¹æ¥è¯´éƒ½èµ·ä½œç”¨çš„éƒ¨åˆ†ï¼š</strong></p><ol><li>ä¸€æ—¦å»ºç«‹è¿æ¥ï¼Œå°±ä¼šè§¦å‘connectedï¼ŒæœåŠ¡å™¨ç‰¹æ®Šä¸€ç‚¹ï¼Œè§¦å‘çš„æ˜¯newConnectio</li><li>äº’ä¼ æ•°æ®ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸€æ—¦æ¥å—åˆ°ï¼Œå°±ä¼šè§¦å‘readyread</li></ol><p>æœåŠ¡å™¨ä¸­ï¼Œéœ€è¦ç›‘å¬å¥—æ¥å­—ä»¥åŠé€šè®¯å¥—æ¥å­—ï¼Œç›‘å¬å¥—æ¥å­—ç”¨äºç›‘å¬å®¢æˆ·ç«¯æ˜¯å¦ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚</p><p>æœ¬ç¯‡åšæ–‡åšäº†åˆæ­¥çš„å­¦ä¹ ä¸å°è¯•ï¼Œç¼–å†™äº†ä¸€ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŸºäºçª—å£é€šä¿¡ä»¥åŠæ–‡ä»¶ä¼ è¾“çš„å°ä¾‹ç¨‹ã€‚</p><h3 id="ä¸€ï¼Œå®¢æˆ·ç«¯"><a href="#ä¸€ï¼Œå®¢æˆ·ç«¯" class="headerlink" title="ä¸€ï¼Œå®¢æˆ·ç«¯"></a><font color="FF0000">ä¸€ï¼Œå®¢æˆ·ç«¯</font></h3><p>å®¢æˆ·ç«¯çš„ä»£ç æ¯”æœåŠ¡å™¨ç¨ç®€å•ï¼Œæ€»çš„æ¥è¯´ï¼Œä½¿ç”¨QTä¸­çš„<strong>QTcpSocketç±»</strong>ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡åªéœ€è¦ä»¥ä¸‹5æ­¥ï¼š</p><p><strong>ï¼ˆ1ï¼‰åˆ›å»ºQTcpSocketå¥—æ¥å­—å¯¹è±¡</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socket = new QTcpSocket(this);</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰ä½¿ç”¨è¿™ä¸ªå¯¹è±¡è¿æ¥æœåŠ¡å™¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QString ip = ui.lineEdit_ip-&gt;text();//è·å–ip</span><br><span class="line">int port = ui.lineEdit_2-&gt;text().toInt();//è·å–ç«¯å£æ•°æ®</span><br><span class="line">socket-&gt;connectToHost(ip, port);</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰ä½¿ç”¨writeå‡½æ•°å‘æœåŠ¡å™¨å‘é€æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QByteArray data = ui.lineEdit_3-&gt;text().toUtf8();//è·å–lineEditæ§ä»¶ä¸­çš„æ•°æ®å¹¶å‘é€ç»™æœåŠ¡å™¨</span><br><span class="line">socket-&gt;write(data);</span><br></pre></td></tr></table></figure><p> <strong>ï¼ˆ4ï¼‰å½“socketæ¥æ”¶ç¼“å†²åŒºæœ‰æ–°æ•°æ®åˆ°æ¥æ—¶ï¼Œä¼šå‘å‡ºreadRead()ä¿¡å·ï¼Œå› æ­¤ä¸ºè¯¥ä¿¡å·æ·»åŠ æ§½å‡½æ•°ä»¥è¯»å–æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> connect(socket, &amp;QTcpSocket::readyRead, this, &amp;QTcpClinet::ReadData);</span><br><span class="line">void QTcpClinet::ReadData()</span><br><span class="line">&#123;</span><br><span class="line">    QByteArray buf = socket-&gt;readAll();</span><br><span class="line">    ui.textEdit-&gt;append(buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ5ï¼‰æ–­å¼€ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼ˆå…³äºclose()å’ŒdisconnectFromHost()çš„åŒºåˆ«ï¼Œå¯ä»¥æŒ‰F1çœ‹å¸®åŠ©ï¼‰</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socket-&gt;disconnectFromHost();</span><br></pre></td></tr></table></figure><p><strong>å®¢æˆ·ç«¯ä¾‹ç¨‹ï¼šï¼ˆæ–°å»ºä¸€ä¸ªqté¡¹ç›®QTcpClinetï¼ˆå®¢æˆ·æœºï¼‰ï¼‰</strong></p><ul><li><strong>uiç•Œé¢</strong></li></ul><p><img src="https://bu.dusays.com/2025/03/13/67d2dbe2f1a93.png"></p><p>æœ¬åœ°å›è·¯ipï¼š127.0.0.1 å¯ä»¥è¿æ¥åˆ°æœ¬åœ°ipï¼ˆç”µè„‘å†…éƒ¨å¾ªç¯çš„ipï¼‰</p><p>å¦‚æœè¦å’Œå±€åŸŸç½‘å…¶ä»–ipè¿æ¥ -&gt; åœ¨è¿è¡Œï¼ˆwin+Rï¼‰+cmd+ipconfig -&gt;ipv4åœ°å€ æŸ¥çœ‹æœ¬æœºip</p><ul><li><strong>QTcpClinet.h</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;QtWidgets/QWidget&gt;</span><br><span class="line">#include &quot;ui_QTcpClinet.h&quot;</span><br><span class="line">#include&quot;QTcpSocket.h&quot;</span><br><span class="line">#pragma execution_character_set(&quot;utf-8&quot;)</span><br><span class="line">class QTcpClinet : public QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    QTcpClinet(QWidget *parent = Q_NULLPTR);</span><br><span class="line">    ~QTcpClinet();</span><br><span class="line">public slots:</span><br><span class="line">    void on_btn_connect_clicked();</span><br><span class="line">    void ReadData();</span><br><span class="line">    void on_btn_push_clicked();</span><br><span class="line">private:</span><br><span class="line">    Ui::QTcpClinetClass ui;</span><br><span class="line">    QTcpSocket* socket;//åˆ›å»ºsocketæŒ‡é’ˆ</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>QTcpClinet.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;QTcpClinet.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">QTcpClinet::<span class="built_in">QTcpClinet</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    socket = <span class="keyword">new</span> <span class="built_in">QTcpSocket</span>(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QTcpClinet::~<span class="built_in">QTcpClinet</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">this</span>-&gt;socket;<span class="comment">//å›æ”¶å†…å­˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QTcpClinet::on_btn_connect_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (ui.btn_connect-&gt;<span class="built_in">text</span>()==<span class="built_in">tr</span>(<span class="string">&quot;è¿æ¥æœåŠ¡å™¨&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    QString ip = ui.lineEdit_ip-&gt;<span class="built_in">text</span>();<span class="comment">//è·å–ip</span></span><br><span class="line">    <span class="type">int</span> port = ui.lineEdit_2-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>();<span class="comment">//è·å–ç«¯å£æ•°æ®</span></span><br><span class="line">    <span class="comment">//å–æ¶ˆå·²æœ‰çš„è¿æ¥</span></span><br><span class="line">    socket-&gt;<span class="built_in">abort</span>();</span><br><span class="line">    <span class="comment">//è¿æ¥æœåŠ¡å™¨</span></span><br><span class="line">    socket-&gt;<span class="built_in">connectToHost</span>(ip, port);</span><br><span class="line">    <span class="type">bool</span> isconnect = socket-&gt;<span class="built_in">waitForConnected</span>();<span class="comment">//ç­‰å¾…ç›´åˆ°è¿æ¥æˆåŠŸ</span></span><br><span class="line">    <span class="comment">//å¦‚æœè¿æ¥æˆåŠŸ</span></span><br><span class="line">    <span class="keyword">if</span> (isconnect)</span><br><span class="line">    &#123;</span><br><span class="line">        ui.textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;The connection was successful!!&quot;</span>);</span><br><span class="line">        ui.btn_push-&gt;<span class="built_in">setEnabled</span>(<span class="literal">true</span>);<span class="comment">//æŒ‰é’®ä½¿èƒ½</span></span><br><span class="line">        <span class="comment">//ä¿®æ”¹æŒ‰é”®æ–‡å­—</span></span><br><span class="line">        ui.btn_connect-&gt;<span class="built_in">setText</span>(<span class="string">&quot;æ–­å¼€æœåŠ¡å™¨è¿æ¥&quot;</span>);</span><br><span class="line">        <span class="comment">//æ¥æ”¶ç¼“å†²åŒºï¼ˆæœåŠ¡å™¨ï¼‰ä¿¡æ¯</span></span><br><span class="line">        <span class="built_in">connect</span>(socket, &amp;QTcpSocket::readyRead, <span class="keyword">this</span>, &amp;QTcpClinet::ReadData);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ui.textEdit-&gt;<span class="built_in">append</span>(<span class="string">&quot;The connection falied!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">//æ–­å¼€è¿æ¥</span></span><br><span class="line">      socket-&gt;<span class="built_in">disconnectFromHost</span>();</span><br><span class="line">      ui.btn_connect-&gt;<span class="built_in">setText</span>(<span class="string">&quot;è¿æ¥æœåŠ¡å™¨&quot;</span>);</span><br><span class="line">      ui.btn_push-&gt;<span class="built_in">setEnabled</span>(<span class="literal">false</span>);<span class="comment">//å…³é—­å‘é€æŒ‰é’®ä½¿èƒ½</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥æ”¶ç¼“å†²åŒºä¿¡æ¯å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QTcpClinet::ReadData</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray buf = socket-&gt;<span class="built_in">readAll</span>();</span><br><span class="line">    ui.textEdit-&gt;<span class="built_in">append</span>(buf);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å‘é€æŒ‰é’®äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QTcpClinet::on_btn_push_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray data = ui.lineEdit_3-&gt;<span class="built_in">text</span>().<span class="built_in">toUtf8</span>();<span class="comment">//è·å–lineEditæ§ä»¶ä¸­çš„æ•°æ®å¹¶å‘é€ç»™æœåŠ¡å™¨</span></span><br><span class="line">    socket-&gt;<span class="built_in">write</span>(data);</span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ˜¯å¦å†™å…¥æˆåŠŸ</span></span><br><span class="line">    <span class="type">bool</span> iswrite = socket-&gt;<span class="built_in">waitForBytesWritten</span>();</span><br><span class="line">    <span class="keyword">if</span> (iswrite)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//å†™å…¥æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æ²¡æœ‰å†™å…¥æˆåŠŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒï¼ŒæœåŠ¡å™¨ï¼ˆéœ€è¦ä¸€ç›´è¿è¡Œå“¦ï¼‰"><a href="#äºŒï¼ŒæœåŠ¡å™¨ï¼ˆéœ€è¦ä¸€ç›´è¿è¡Œå“¦ï¼‰" class="headerlink" title="äºŒï¼ŒæœåŠ¡å™¨ï¼ˆéœ€è¦ä¸€ç›´è¿è¡Œå“¦ï¼‰"></a><font color="FF0000">äºŒï¼ŒæœåŠ¡å™¨ï¼ˆéœ€è¦ä¸€ç›´è¿è¡Œå“¦ï¼‰</font></h3><p>æœåŠ¡å™¨é™¤äº†ä½¿ç”¨åˆ°äº†<strong>QTcpSocketç±»</strong>ï¼Œè¿˜éœ€è¦ç”¨åˆ°<strong>QTcpSeverç±»</strong>ã€‚å³ä¾¿å¦‚æ­¤ï¼Œä¹Ÿåªæ˜¯æ¯”å®¢æˆ·ç«¯å¤æ‚ä¸€ç‚¹ç‚¹ï¼Œç”¨åˆ°äº†6ä¸ªæ­¥éª¤ï¼š</p><p><strong>ï¼ˆ1ï¼‰åˆ›å»ºQTcpSeverå¯¹è±¡</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server = new QTcpServer(this);</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰ä¾¦å¬ä¸€ä¸ªç«¯å£ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªç«¯å£è®¿é—®æœåŠ¡å™¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server-&gt;listen(QHostAddress::Any, 6677);//ç›‘å¬æ‰€æœ‰ipå’Œ6677ç«¯å£</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ3ï¼‰å½“æœåŠ¡å™¨è¢«å®¢æˆ·ç«¯è®¿é—®æ—¶ï¼Œä¼šå‘å‡ºnewConnection()ä¿¡å·ï¼Œå› æ­¤ä¸ºè¯¥ä¿¡å·æ·»åŠ æ§½å‡½æ•°ï¼Œå¹¶ç”¨ä¸€ä¸ªQTcpSocketå¯¹è±¡æ¥å—å®¢æˆ·ç«¯è®¿é—®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">connect(server, &amp;QTcpServer::newConnection, this, &amp;TcpServer::ClientConnect);</span><br><span class="line">void TcpServer::ClientConnect()</span><br><span class="line">&#123;</span><br><span class="line">    //è§£ææ‰€æœ‰å®¢æˆ·è¿æ¥</span><br><span class="line">    while (server-&gt;hasPendingConnections())</span><br><span class="line">    &#123;</span><br><span class="line">        //è¿æ¥ä¸Šåé€šè¿‡socketï¼ˆQTcpSocketå¯¹è±¡ï¼‰è·å–è¿æ¥ä¿¡æ¯</span><br><span class="line">        socket = server-&gt;nextPendingConnection();</span><br><span class="line">        QString str = QString(&quot;[ip:%1,port:%2]&quot;).arg(socket-&gt;peerAddress().toString()).arg(socket-&gt;peerPort());//ç›‘å¬å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ¶ˆæ¯å‘é€</span><br><span class="line">        connect(socket, &amp;QTcpSocket::readyRead, this, &amp;TcpServer::ReadData1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ4ï¼‰ä½¿ç”¨socketçš„writeå‡½æ•°å‘å®¢æˆ·ç«¯å‘é€æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socket-&gt;write(data);</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ5ï¼‰å½“socketæ¥æ”¶ç¼“å†²åŒºæœ‰æ–°æ•°æ®åˆ°æ¥æ—¶ï¼Œä¼šå‘å‡ºreadRead()ä¿¡å·ï¼Œå› æ­¤ä¸ºè¯¥ä¿¡å·æ·»åŠ æ§½å‡½æ•°ä»¥è¯»å–æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//ç›‘å¬å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ¶ˆæ¯å‘é€</span><br><span class="line">connect(socket, &amp;QTcpSocket::readyRead, this, &amp;TcpServer::ReadData1);</span><br><span class="line">//è·å–å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€çš„ä¿¡æ¯</span><br><span class="line">void TcpServer::ReadData1()</span><br><span class="line">&#123;</span><br><span class="line">    QByteArray buf = socket-&gt;readAll();//readAllæœ€å¤šæ¥æ”¶65532çš„æ•°æ®</span><br><span class="line">    QString str = QString(&quot;[ip:%1,port:%2]&quot;).arg(socket-&gt;peerAddress().toString()).arg(socket-&gt;peerPort());</span><br><span class="line">    ui.textEdit_server-&gt;append(str +QString(buf));</span><br><span class="line">    //socket-&gt;write(&quot;ok&quot;);//æœåŠ¡å™¨æ¥æ”¶åˆ°ä¿¡æ¯åè¿”å›ä¸€ä¸ªok</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ6ï¼‰å–æ¶ˆä¾¦å¬</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server-&gt;close();</span><br></pre></td></tr></table></figure><p> <strong>æœåŠ¡å™¨ä¾‹ç¨‹ï¼šï¼ˆæ·»åŠ ä¸€ä¸ªæ–°çš„qté¡¹ç›®TcpServerï¼ˆæœåŠ¡å™¨ï¼‰ï¼‰</strong></p><ul><li><strong>uiç•Œé¢</strong></li></ul><p><img src="https://bu.dusays.com/2025/03/13/67d2dc19a7d8f.png"></p><ul><li><strong>TcpServer.h</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;QtWidgets/QWidget&gt;</span><br><span class="line">#include&quot;ui_TcpServer.h&quot;</span><br><span class="line">#include&quot;qtcpserver.h&quot;</span><br><span class="line">#include&quot;qtcpsocket.h&quot;</span><br><span class="line"></span><br><span class="line">class TcpServer : public QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    TcpServer(QWidget *parent = Q_NULLPTR);</span><br><span class="line">    ~TcpServer();</span><br><span class="line">public slots:</span><br><span class="line">    void on_btn_server_clicked();</span><br><span class="line">    void on_btn_listen_clicked();</span><br><span class="line">private:</span><br><span class="line">    Ui::TcpServerClass ui;</span><br><span class="line">    QTcpServer* server;</span><br><span class="line">    QTcpSocket* socket;//ä¸€ä¸ªå®¢æˆ·ç«¯å¯¹åº”ä¸€ä¸ªsocket</span><br><span class="line">    void ClientConnect();</span><br><span class="line">    void ReadData1();</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>TcpServer.cpp</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;TcpServer.h&quot;</span><br><span class="line">#include&quot;qstring.h&quot;</span><br><span class="line">#include&quot;qdebug.h&quot;</span><br><span class="line">#pragma execution_character_set(&quot;utf-8&quot;)</span><br><span class="line">TcpServer::TcpServer(QWidget *parent)</span><br><span class="line">    : QWidget(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.setupUi(this);</span><br><span class="line">    server = new QTcpServer(this);</span><br><span class="line">   //å®¢æˆ·æœºè¿æ¥ä¿¡å·æ§½</span><br><span class="line">    connect(server, &amp;QTcpServer::newConnection, this, &amp;TcpServer::ClientConnect);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TcpServer::~TcpServer()</span><br><span class="line">&#123;</span><br><span class="line">    server-&gt;close();</span><br><span class="line">    server-&gt;deleteLater();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void TcpServer::on_btn_listen_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    if (ui.btn_listen-&gt;text()==&quot;ä¾¦å¬&quot;)</span><br><span class="line">    &#123;</span><br><span class="line">        //ä»è¾“å…¥æ¡†è·å–ç«¯å£å·</span><br><span class="line">        int port = ui.lineEdit_port-&gt;text().toInt();</span><br><span class="line">        //ä¾¦å¬æŒ‡å®šç«¯å£çš„æ‰€æœ‰ip</span><br><span class="line">        if (!server-&gt;listen(QHostAddress::Any, port))</span><br><span class="line">        &#123;</span><br><span class="line">            //è‹¥å‡ºé”™ï¼Œåˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯</span><br><span class="line">            qDebug() &lt;&lt; server-&gt;errorString();</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        //ä¿®æ”¹æŒ‰é”®æ–‡å­—</span><br><span class="line">        ui.btn_listen-&gt;setText(&quot;å–æ¶ˆä¾¦å¬&quot;);    </span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        socket-&gt;abort();</span><br><span class="line">        //å–æ¶ˆä¾¦å¬</span><br><span class="line">        server-&gt;close();</span><br><span class="line">        //ä¿®æ”¹æŒ‰é”®æ–‡å­—</span><br><span class="line">        ui.btn_listen-&gt;setText(&quot;ä¾¦å¬&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void TcpServer::ClientConnect()</span><br><span class="line">&#123;</span><br><span class="line">    //è§£ææ‰€æœ‰å®¢æˆ·è¿æ¥</span><br><span class="line">    while (server-&gt;hasPendingConnections())</span><br><span class="line">    &#123;</span><br><span class="line">        //è¿æ¥ä¸Šåé€šè¿‡socketè·å–è¿æ¥ä¿¡æ¯</span><br><span class="line">        socket = server-&gt;nextPendingConnection();</span><br><span class="line">        QString str = QString(&quot;[ip:%1,port:%2]&quot;).arg(socket-&gt;peerAddress().toString()).arg(socket-&gt;peerPort());</span><br><span class="line">        //æç¤ºè¿æ¥æˆåŠŸ</span><br><span class="line">        ui.textEdit_server-&gt;append(str+&quot;Connect to the server&quot;);</span><br><span class="line">        //å¤é€‰æ¡†é€‰é¡¹ä¸ºè¿æ¥æœåŠ¡å™¨çš„ip</span><br><span class="line">        ui.comboBox-&gt;addItem(str);</span><br><span class="line">        //å°†socketåœ°å€æ”¾å…¥comboboxå±æ€§å†…</span><br><span class="line">        //ui.comboBox-&gt;setItemData(ui.comboBox-&gt;count()-1, QVariant((int)socket));</span><br><span class="line">        //ç›‘å¬å®¢æˆ·ç«¯æ˜¯å¦æœ‰æ¶ˆæ¯å‘é€</span><br><span class="line">        connect(socket, &amp;QTcpSocket::readyRead, this, &amp;TcpServer::ReadData1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//è·å–å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€çš„ä¿¡æ¯</span><br><span class="line">void TcpServer::ReadData1()</span><br><span class="line">&#123;</span><br><span class="line">    QByteArray buf = socket-&gt;readAll();//readAllæœ€å¤šæ¥æ”¶65532çš„æ•°æ®</span><br><span class="line">    QString str = QString(&quot;[ip:%1,port:%2]&quot;).arg(socket-&gt;peerAddress().toString()).arg(socket-&gt;peerPort());</span><br><span class="line">    ui.textEdit_server-&gt;append(str +QString(buf));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€ä¿¡æ¯</span><br><span class="line">void TcpServer::on_btn_server_clicked()</span><br><span class="line">&#123;</span><br><span class="line">  if(ui.comboBox-&gt;count()== 0)return;</span><br><span class="line">  //QTcpSocket* skt=  (QTcpSocket*)ui.comboBox-&gt;itemData(ui.comboBox-&gt;currentIndex()).value&lt;int&gt;();</span><br><span class="line">  socket-&gt;write(ui.lineEdit1-&gt;text().toUtf8());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šwriteä¸­éœ€è¦å†™å…¥charç±»å‹çš„å…ƒç´ æˆ–QByteArrayç±»å‹çš„å…ƒç´ </p><p><img src="https://bu.dusays.com/2025/03/13/67d2dc2f4307e.png"></p><p><strong>æ•ˆæœå±•ç¤ºï¼š</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d2dc5b93345.gif"></p><h3 id="ä¸‰ï¼ŒTCP-IPæ–‡ä»¶ä¼ è¾“"><a href="#ä¸‰ï¼ŒTCP-IPæ–‡ä»¶ä¼ è¾“" class="headerlink" title="ä¸‰ï¼ŒTCP&#x2F;IPæ–‡ä»¶ä¼ è¾“"></a><font color="FF0000">ä¸‰ï¼ŒTCP&#x2F;IPæ–‡ä»¶ä¼ è¾“</font></h3><p>ä¸Šæ–‡å®ç°äº†æ¶ˆæ¯çš„ä¼ è¾“ï¼Œç”±äº<strong>socket-&gt;readAll();ï¼ˆreadAllæœ€å¤šæ¥æ”¶65532çš„æ•°æ®ï¼‰</strong>ï¼Œå› æ­¤å¯¹äºå¤§æ–‡ä»¶çš„ä¼ è¾“ç”¨æ­¤æ–¹æ³•æ˜¯ä¸å¯å–çš„ã€‚</p><p><strong>TCP&#x2F;IPæ–‡ä»¶ä¼ è¾“çš„æ€è·¯ï¼š</strong></p><ol><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿æ¥</li><li>å®¢æˆ·ç«¯é€‰æ‹©æ–‡ä»¶ï¼Œå¹¶å‘é€æ–‡ä»¶ç»™æœåŠ¡å™¨ï¼ˆå‘é€çš„æ˜¯æ–‡ä»¶çš„å¸§å¤´ï¼Œæ ¼å¼ï¼šæ–‡ä»¶å&amp;å¤§å°ï¼‰</li><li>æœåŠ¡å™¨è§¦å‘readyReadï¼Œç„¶åè§£ææ–‡ä»¶å¸§å¤´ï¼ˆè·å–æ–‡ä»¶åå’Œå¤§å°ï¼‰ï¼Œå¹¶è¿”å›å®¢æˆ·ç«¯ä¸€ä¸ªokæ¶ˆæ¯</li><li>å®¢æˆ·ç«¯è§¦å‘readyReadï¼Œç„¶åå‘é€æ–‡ä»¶æ•°æ®ï¼Œé€šè¿‡progressBaræ˜¾ç¤ºè¿›åº¦</li><li>æœåŠ¡å™¨å†æ¬¡è§¦å‘readyReadï¼Œæ¥æ”¶æ–‡ä»¶æ•°æ®ï¼Œå¹¶ä¿å­˜ï¼ˆé€šè¿‡isheadåˆ¤æ–­æ¥æ”¶çš„æ˜¯æ–‡ä»¶å¸§å¤´è¿˜æ˜¯æ–‡ä»¶æ•°æ®ï¼‰</li></ol><p><strong>ä»£ç å®ç°ï¼š</strong></p><p>æ–°å»ºæœåŠ¡å™¨é¡¹ç›®ï¼ˆTcpServerï¼‰</p><ul><li><strong>TcpServer.h</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#pragma once</span><br><span class="line"></span><br><span class="line">#include &lt;QtWidgets/QWidget&gt;</span><br><span class="line">#include &quot;ui_TcpServer.h&quot;</span><br><span class="line">#include&quot;qtcpserver.h&quot;</span><br><span class="line">#include&quot;qtcpsocket.h&quot;</span><br><span class="line">#pragma execution_character_set(&quot;utf-8&quot;)</span><br><span class="line">class TcpServer : public QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    TcpServer(QWidget *parent = Q_NULLPTR);</span><br><span class="line">    void hasConnect();</span><br><span class="line">private:</span><br><span class="line">    Ui::TcpServerClass ui;</span><br><span class="line">    QTcpServer* server;</span><br><span class="line">    QTcpSocket* socket;</span><br><span class="line">    bool ishead;</span><br><span class="line">    QString fileName;</span><br><span class="line">    int fileSize;//æ¥æ”¶æ–‡ä»¶çš„æ€»å¤§å°</span><br><span class="line">    int recvSize;//å½“å‰æ¥æ”¶æ–‡ä»¶çš„å¤§å°</span><br><span class="line">    QByteArray filebuf;//å½“å‰æ¥æ”¶çš„æ–‡ä»¶æ•°æ®</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>TcpServer.cpp</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;TcpServer.h&quot;</span><br><span class="line">#include&quot;qfile.h&quot;</span><br><span class="line">TcpServer::TcpServer(QWidget *parent)</span><br><span class="line">    : QWidget(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ishead = true;</span><br><span class="line">    ui.setupUi(this);</span><br><span class="line">    server = new QTcpServer(this);</span><br><span class="line">    //ç›‘å¬1122ç«¯å£çš„ip</span><br><span class="line">    server-&gt;listen(QHostAddress::Any, 1122);</span><br><span class="line">    //å¦‚æœæœ‰ç”¨æˆ·è¿æ¥è§¦å‘æ§½å‡½æ•°</span><br><span class="line">    connect(server, &amp;QTcpServer::newConnection, this, &amp;TcpServer::hasConnect);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void TcpServer::hasConnect()</span><br><span class="line">&#123;</span><br><span class="line">    while (server-&gt;hasPendingConnections()&gt;0)//åˆ¤æ–­å½“å‰è¿æ¥äº†å¤šå°‘äºº</span><br><span class="line">    &#123;</span><br><span class="line">        //ç”¨socketå’Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯å¯¹åº”ä¸€ä¸ªå¥—æ¥å­—socket</span><br><span class="line">        socket = server-&gt;nextPendingConnection();</span><br><span class="line">        //æœåŠ¡å™¨ç•Œé¢ä¸Šè¾“å‡ºå®¢æˆ·ç«¯ä¿¡æ¯</span><br><span class="line">        ui.textEdit-&gt;append(QString(&quot;%1ï¼šæ–°ç”¨æˆ·è¿æ¥&quot;).arg(socket-&gt;peerPort()));</span><br><span class="line">        //å¦‚æœå®¢æˆ·ç«¯å‘é€ä¿¡æ¯è¿‡æ¥äº†ï¼Œè§¦å‘åŒ¿åå‡½æ•°</span><br><span class="line">        connect(socket, &amp;QTcpSocket::readyRead, [=]() &#123;</span><br><span class="line">            QByteArray buf = socket-&gt;readAll();</span><br><span class="line">            //ç”¨ä¸€ä¸ªæ ‡å¿—ä½isheadåˆ¤æ–­æ˜¯å¤´è¿˜æ˜¯æ•°æ®ä½</span><br><span class="line">            if (ishead)</span><br><span class="line">            &#123;</span><br><span class="line">                //å¦‚æœæ˜¯å¤´ï¼Œè§£æå¤´ï¼ˆæ–‡ä»¶åï¼Œæ–‡ä»¶å¤§å°ï¼‰</span><br><span class="line">                QString str = QString(buf);</span><br><span class="line">                ui.textEdit-&gt;append(str);</span><br><span class="line">                QStringList strlist = str.split(&quot;&amp;&quot;);</span><br><span class="line">                fileName = strlist.at(0);//è§£æå¸§å¤´æ–‡ä»¶å</span><br><span class="line">                fileSize = strlist.at(1).toInt();//è§£æå¸§å¤´æ–‡ä»¶å¤§å°</span><br><span class="line">                ishead = false;//ä¸‹æ¬¡æ¥æ”¶åˆ°çš„æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬çš„æ•°æ®</span><br><span class="line">                recvSize = 0;</span><br><span class="line">                filebuf.clear();</span><br><span class="line">                socket-&gt;write(&quot;ok&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                //æ ¹æ®æ–‡ä»¶åå’Œæ–‡ä»¶å¤§å°æ¥æ”¶å’Œä¿å­˜æ–‡ä»¶</span><br><span class="line">                filebuf.append(buf);</span><br><span class="line">                recvSize += buf.size();//æ¯æ¥æ”¶ä¸€æ¬¡æ–‡ä»¶ï¼Œå½“å‰æ–‡ä»¶å¤§å°+1</span><br><span class="line">                //å½“æ¥æ”¶æ–‡ä»¶å¤§å°ç­‰äºæ€»æ–‡ä»¶å¤§å°ï¼Œå³æ–‡ä»¶æ•°æ®æ¥æ”¶å®Œæ¯•</span><br><span class="line">                if (recvSize&gt;=fileSize)</span><br><span class="line">                &#123;</span><br><span class="line">                    //ä¿å­˜æ–‡ä»¶</span><br><span class="line">                    QFile file(ui.lineEdit-&gt;text() + fileName);</span><br><span class="line">                    file.open(QIODevice::WriteOnly);</span><br><span class="line">                    file.write(filebuf);</span><br><span class="line">                    file.close();</span><br><span class="line">                    ishead = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºå®¢æˆ·ç«¯é¡¹ç›®ï¼ˆQTcpClientï¼‰</p><ul><li><strong>QTcpClient.h</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;QtWidgets/QWidget&gt;</span><br><span class="line">#include&quot;ui_QTcpClient.h&quot;</span><br><span class="line">#include&quot;qtcpsocket.h&quot;</span><br><span class="line">#pragma execution_character_set(&quot;utf-8&quot;)</span><br><span class="line">class QTcpClient : public QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    QTcpClient(QWidget *parent = Q_NULLPTR);</span><br><span class="line">public slots:</span><br><span class="line">    void on_btn_connect_clicked();</span><br><span class="line">    void on_btn_choose_clicked();</span><br><span class="line">    void on_btn_open_clicked();</span><br><span class="line">    </span><br><span class="line">private:</span><br><span class="line">    Ui::QTcpClientClass ui;</span><br><span class="line">    QTcpSocket* socket;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>QTcpClient.cpp</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;QTcpClient.h&quot;</span><br><span class="line">#include&quot;qfiledialog.h&quot;</span><br><span class="line">#include&quot;qfileinfo.h&quot;</span><br><span class="line">QTcpClient::QTcpClient(QWidget *parent)</span><br><span class="line">    : QWidget(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.setupUi(this);</span><br><span class="line">    socket = new QTcpSocket(this);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">void QTcpClient::on_btn_connect_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    QString ip = ui.lineEdit_ip-&gt;text();//è·å–ip</span><br><span class="line">    int port = ui.lineEdit_port-&gt;text().toInt();//è·å–ç«¯å£æ•°æ®</span><br><span class="line">    socket-&gt;connectToHost(ip, port);//è¿æ¥æœåŠ¡å™¨</span><br><span class="line">    //ç­‰å¾…è¿æ¥æˆåŠŸ</span><br><span class="line">    if (socket-&gt;waitForConnected())</span><br><span class="line">    &#123;</span><br><span class="line">        ui.textEdit-&gt;append(&quot;&lt;font color=&#x27;green&#x27;&gt;è¿æ¥æœåŠ¡å™¨æˆåŠŸï¼&lt;/font&gt;&quot;);    </span><br><span class="line">        ui.btn_open-&gt;setEnabled(true);</span><br><span class="line">        </span><br><span class="line">        //å¦‚æœæœåŠ¡å™¨å‘é€ä¿¡æ¯åˆ°å®¢æˆ·ç«¯ï¼Œè§¦å‘åŒ¿åå‡½æ•°</span><br><span class="line">        connect(socket, &amp;QTcpSocket::readyRead, [=]() &#123;</span><br><span class="line">            //è¯»å–æœåŠ¡å™¨å‘é€çš„ä¿¡æ¯ï¼ˆå³ç¼“å†²åŒºä¿¡æ¯ï¼‰</span><br><span class="line">            QByteArray buf = socket-&gt;readAll();</span><br><span class="line">            if (buf==&quot;ok&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                QFile file = (ui.label_path-&gt;text());</span><br><span class="line">                if (!file.open(QIODevice::ReadWrite))</span><br><span class="line">                &#123;</span><br><span class="line">                    //è¯»å–æ–‡ä»¶å¤±è´¥</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                qint64 currentlen = 0;//å½“å‰å·²ç»å‘é€çš„å¤§å°</span><br><span class="line">                qint64 allLength = file.size();//æ€»æ–‡ä»¶å¤§å°</span><br><span class="line">                do</span><br><span class="line">                &#123;</span><br><span class="line">                    char data[1024];</span><br><span class="line">                    qint64 msize = file.read(data, 1024);//è¯»æ–‡ä»¶æ”¾å…¥æ‰“ä»–æ•°ç»„ä¸­ï¼Œè¿”å›è¯»å–åˆ°çš„å¤§å°</span><br><span class="line">                    socket-&gt;write(data, msize);//æŠŠè¯»å–åˆ°çš„dataæ•°æ®å‘é€ç»™æœåŠ¡å™¨</span><br><span class="line">                    currentlen += msize;//å®æ—¶è·å–å½“å‰å‘é€çš„æ–‡ä»¶å¤§å°</span><br><span class="line">                    ui.progressBar-&gt;setValue(currentlen *100 / allLength);//æ›´æ–°ç•Œé¢è¿›åº¦æ¡</span><br><span class="line">                &#125; while (currentlen &lt; allLength);//å½“å‘é€æ–‡ä»¶ç­‰äºæ–‡ä»¶å¤§å°æ—¶ï¼Œå‘é€å®Œæ¯•ï¼Œå¾ªç¯ç»“æŸ</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        ui.textEdit-&gt;append(&quot;&lt;font color=&#x27;red&#x27;&gt;è¿æ¥æœåŠ¡å™¨å¤±è´¥ï¼&lt;/font&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//é€‰æ‹©æ–‡ä»¶äº‹ä»¶</span><br><span class="line">void QTcpClient::on_btn_choose_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    QString path = QFileDialog::getOpenFileName(this, &quot;æ‰“å¼€æ–‡ä»¶&quot;, &quot;&quot;, &quot;(*.*)&quot;);</span><br><span class="line">    ui.label_path-&gt;setText(path);</span><br><span class="line">&#125;</span><br><span class="line">//å‘é€æ–‡ä»¶äº‹ä»¶</span><br><span class="line">void QTcpClient::on_btn_open_clicked()</span><br><span class="line">&#123;</span><br><span class="line">    QFileInfo info(ui.label_path-&gt;text());</span><br><span class="line">    //ç”¨QFileInfoï¼šï¼šfileNameï¼Œsizeè·å–æ–‡ä»¶åå’Œå¤§å° æ ¼å¼ï¼šæ–‡ä»¶å&amp;å¤§å°</span><br><span class="line">    //æœåŠ¡å™¨ç”¨è¯¥æ ¼å¼è§£ææ–‡ä»¶åå’Œå¤§å°</span><br><span class="line">    QString head = QString(&quot;%1&amp;%2&quot;).arg(info.fileName()).arg(info.size());</span><br><span class="line">    //å°†è¯¥æ ¼å¼å‘é€ç»™æœåŠ¡å™¨ toUtf8ï¼šQStringè½¬QByteArrayæˆ–charç±»å‹</span><br><span class="line">    socket-&gt;write(head.toUtf8()); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ•ˆæœå±•ç¤ºï¼š</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d2dc9a83bfe.gif"></p><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
            <tag> ç½‘ç»œç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt08é¡¹ç›®æ‰“åŒ…å’Œå‘å¸ƒ</title>
      <link href="/2025/03/13/Qt08%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E5%92%8C%E5%8F%91%E5%B8%83/"/>
      <url>/2025/03/13/Qt08%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E5%92%8C%E5%8F%91%E5%B8%83/</url>
      
        <content type="html"><![CDATA[<p>æ‰“åŒ…æ•´ä½“æ€è·¯ï¼š</p><ul><li>å°†ç¼–è¯‘åçš„exeå¯æ‰§è¡Œæ–‡ä»¶åŠå…¶å„ç§ä¾èµ–dllã€libã€å›¾æ ‡ã€é…ç½®æ–‡ä»¶ç­‰å…ˆæ‰“åŒ…æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­</li><li>å¯¹å…¶è¿›è¡Œæ‰“åŒ…å‘å¸ƒï¼ˆä¸¤ç§æ–¹å¼ï¼‰ï¼š</li></ul><ol><li>åˆ©ç”¨VSçš„æ’ä»¶Microsoft Visual Studio Installer Projectså®‰è£…ç¨‹åºæ‰“åŒ…æ’ä»¶è¿›è¡Œæ‰“åŒ…</li><li>åˆ©ç”¨Enigma Virtual Box(å•æ–‡ä»¶å°è£…å·¥å…·) è¿›è¡Œæ‰“åŒ…</li></ol><h3 id="ä¸€ï¼Œå°†ç¼–è¯‘åçš„exeå¯æ‰§è¡Œæ–‡ä»¶åŠå…¶å„ç§ä¾èµ–dllã€libã€å›¾æ ‡ã€é…ç½®æ–‡ä»¶ç­‰å…ˆæ‰“åŒ…æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­"><a href="#ä¸€ï¼Œå°†ç¼–è¯‘åçš„exeå¯æ‰§è¡Œæ–‡ä»¶åŠå…¶å„ç§ä¾èµ–dllã€libã€å›¾æ ‡ã€é…ç½®æ–‡ä»¶ç­‰å…ˆæ‰“åŒ…æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­" class="headerlink" title="ä¸€ï¼Œå°†ç¼–è¯‘åçš„exeå¯æ‰§è¡Œæ–‡ä»¶åŠå…¶å„ç§ä¾èµ–dllã€libã€å›¾æ ‡ã€é…ç½®æ–‡ä»¶ç­‰å…ˆæ‰“åŒ…æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­"></a><font color="FF0000">ä¸€ï¼Œå°†ç¼–è¯‘åçš„exeå¯æ‰§è¡Œæ–‡ä»¶åŠå…¶å„ç§ä¾èµ–dllã€libã€å›¾æ ‡ã€é…ç½®æ–‡ä»¶ç­‰å…ˆæ‰“åŒ…æ”¾åˆ°ä¸€ä¸ªç›®å½•ä¸­</font></h3><p><strong>ï¼ˆ1ï¼‰dumpbinæŒ‡ä»¤æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„dllä¾èµ–åŒ…</strong></p><p>åœ¨VSå¼€å‘äººå‘˜å‘½ä»¤æç¤ºç¬¦ï¼ˆvsç•Œé¢-&gt;å·¥å…·-&gt;å‘½ä»¤è¡Œ-&gt;å¼€å‘è€…å‘½ä»¤æç¤ºï¼‰ä¸­æ‰§è¡Œ<strong>dumpbin &#x2F;dependents ç¨‹åºè·¯å¾„ ï¼šdumpbin&#x2F;dependents C:\Users\WFD\Desktop\GCtest\Debug\GCtest</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d2d919ca716.png"></p><p><strong>ï¼ˆ2ï¼‰windeployqt.exeæŒ‡ä»¤è‡ªåŠ¨å°†qtä¾èµ–åŒ…å¤åˆ¶è¿‡æ¥</strong></p><p> 1ï¸âƒ£å…ˆæ‰“å¼€ Qt çš„å‘½ä»¤è¡Œï¼ˆç”¨çš„32ä½ï¼‰</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d931dc01c.png"></p><p>2ï¸âƒ£ä½¿ç”¨â€œcd&#x2F;d è·¯å¾„â€ å‘½ä»¤è¿›å…¥åˆ°åŒ…å«.exe æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚</p><p>3ï¸âƒ£ Qt å‘½ä»¤è¡Œæ‰§è¡Œ windeployqt å·¥å…·ï¼Œè¾“å…¥ï¼š â€œwindeployqt ***.exeâ€ ï¼Œå°±å¯ä»¥å°†qtä¾èµ–åŒ…å¤åˆ¶åˆ°è¯¥æ–‡ä»¶å¤¹ä¸­</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d94c54e1f.png"></p><p><img src="https://bu.dusays.com/2025/03/13/67d2d95753bae.png"></p><p><strong>ï¼ˆ3ï¼‰éQtä¾èµ–åº“çš„æ·»åŠ </strong></p><p><strong>è¦æ³¨æ„releaseç‰ˆæœ¬ä¸debugç‰ˆæœ¬æ‰€éœ€è¦çš„ä¾èµ–æ˜¯ä¸ä¸€æ ·çš„ï¼Œéœ€è¦åˆ†åˆ«æ‰“åŒ…ï¼ï¼ï¼</strong></p><ul><li><strong>æ–¹æ³•ä¸€</strong></li></ul><p>åœ¨é€šè¿‡vsçš„dumpbinæŒ‡ä»¤æŸ¥è¯¢åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„dllä¾èµ–åŒ…åï¼Œä½¿ç”¨eyerythingè½¯ä»¶æ ¹æ®ä½ç½®å»å¯»æ‰¾dllæ–‡ä»¶ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="http://www.voidtools.com/">http://www.voidtools.com/</a></p><p><img src="https://bu.dusays.com/2025/03/13/67d2d99b229d6.png"></p><ul><li><strong>æ–¹æ³•äºŒ</strong></li></ul><p>å¦‚æœåŠ¨æ€åº“æœ‰å¾ˆå¤šé‚£ä¹ˆå¤åˆ¶èµ·æ¥å¾ˆéº»çƒ¦ï¼ˆæ¯”å¦‚ä¸Šé¢Qtcore.dllæŸ¥æ‰¾åˆ°å¾ˆå¤šè·¯å¾„ï¼Œä½†æ˜¯ä¸çŸ¥é“ç”¨å“ªä¸ªï¼‰ï¼Œå¯ä»¥ä½¿ç”¨windowçš„æ‰¹å¤„ç†ï¼š</p><p>é€šè¿‡è§‚å¯Ÿç¨‹åºè¿è¡Œæ—¶Vsè¾“å‡ºçª—å£ä¸­åŠ è½½çš„dllåº“ï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d9b78f0fc.png"></p><ul><li><strong>æ–¹æ³•ä¸‰</strong></li></ul><p>ä½¿ç”¨Dependency Wallker æ‰“å¼€***.exe æŸ¥æ‰¾ä¸å­˜åœ¨çš„.dllï¼Œå…¶ä¸­é»„è‰²çš„é—®å·æ ‡è¯†æ˜¯ä¸å­˜åœ¨çš„ã€‚Dependency Wallkerå¯ä»¥é€’å½’æ˜¾ç¤ºå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆexeï¼‰å’ŒåŠ¨æ€åº“ï¼ˆdllï¼‰è°ƒç”¨çš„åŠ¨æ€åº“ã€‚</p><p>æ‰“å¼€**.exeæ–‡ä»¶ä¹‹åå„ä¸ªèŠ‚ç‚¹å¯èƒ½æ˜¯å±•å¼€çš„å¾ˆä¹±ï¼Œå¯ä»¥å³å‡»ä»»æ„èŠ‚ç‚¹é€‰æ‹©â€œæŠ˜å æ‰€æœ‰(L)â€,ç„¶åå†å•å‡»æ ¹èŠ‚ç‚¹çš„åŠ å·å±•å¼€å°±æ˜¯å¦‚å›¾æ‰€ç¤ºçš„æ ·å¼ï¼Œè¿™æ ·å¾ˆæ¸…æ™°ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d9d63494d.png"></p><p>åœ¨å…¨éƒ¨æ·»åŠ å®Œä¾èµ–åº“åï¼Œç‚¹å‡»exeè¿è¡Œæ–‡ä»¶å°±å¯ä»¥æœ¬æœºè¿è¡Œäº†ã€‚æˆ–è€…å°†è¯¥æ–‡ä»¶å¤¹å…¨éƒ¨å‘é€ç»™ç”¨æˆ·ä¹Ÿå¯è¿è¡Œã€‚</p><p>é‚£ä¹ˆå¦‚ä½•åªä½¿ç”¨ä¸€ä¸ªexeæ–‡ä»¶å°±å®Œæˆç¨‹åºçš„è¿è¡Œå‘¢ï¼Ÿ</p><p><strong>ğŸ™„è¿™å°±è¦ç”¨åˆ°ä¸‹é¢è¦è¯´çš„æ‰“åŒ…å’Œå‘å¸ƒäº†ã€‚</strong></p><h3 id="äºŒï¼Œåˆ©ç”¨VSçš„æ’ä»¶Microsoft-Visual-Studio-Installer-Projectså®‰è£…ç¨‹åºæ‰“åŒ…æ’ä»¶è¿›è¡Œæ‰“åŒ…"><a href="#äºŒï¼Œåˆ©ç”¨VSçš„æ’ä»¶Microsoft-Visual-Studio-Installer-Projectså®‰è£…ç¨‹åºæ‰“åŒ…æ’ä»¶è¿›è¡Œæ‰“åŒ…" class="headerlink" title="äºŒï¼Œåˆ©ç”¨VSçš„æ’ä»¶Microsoft Visual Studio Installer Projectså®‰è£…ç¨‹åºæ‰“åŒ…æ’ä»¶è¿›è¡Œæ‰“åŒ…"></a><font color="FF0000">äºŒï¼Œåˆ©ç”¨VSçš„æ’ä»¶Microsoft Visual Studio Installer Projectså®‰è£…ç¨‹åºæ‰“åŒ…æ’ä»¶è¿›è¡Œæ‰“åŒ…</font></h3><p>å®‰è£…è¿‡ç¨‹ä¸å†è¯¦è¿°å‚è§ï¼š<a href="https://www.cnblogs.com/wuyubing/p/12378014.html">Installer Projectsæ’ä»¶çš„å®‰è£…</a></p><p> <strong>ï¼ˆ1ï¼‰æ–°å»ºå®‰è£…é¡¹ç›®</strong></p><p>è§£å†³æ–¹æ¡ˆ-&gt;æ–°å»ºé¡¹ç›®-&gt;setup project</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d9ff7680d.png"></p><p>è¿›å…¥æ–‡ä»¶ç³»ç»Ÿï¼š(setup1-&gt;view-&gt;æ–‡ä»¶ç³»ç»Ÿï¼‰</p><p><img src="https://bu.dusays.com/2025/03/13/67d2da14e0621.png"></p><p> <strong>ï¼ˆ2ï¼‰æ·»åŠ æ–‡ä»¶</strong></p><p>Application Folder-&gt;add-&gt;æ–‡ä»¶ï¼ˆåœ¨æ­¤æ·»åŠ ç›¸å…³çš„ä¾èµ–èµ„æºï¼‰</p><p><img src="https://bu.dusays.com/2025/03/13/67d2da26840fa.png"></p><p> å°†exeæ‰€åœ¨ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°è¯¥å¤„</p><p> <strong>ï¼ˆ3ï¼‰æ·»åŠ é¡¹ç›®è¾“å‡º</strong></p><p>Application Folder-&gt;add-&gt;é¡¹ç›®è¾“å‡ºï¼ˆä¸»ç¨‹åºå…¥å£ï¼‰</p><p><img src="https://bu.dusays.com/2025/03/13/67d2da3facb0a.png"></p><p>å¯¹ä¸»è¾“å‡ºåˆ›å»ºå¿«æ·æ–¹å¼ï¼Œå¹¶å°†å…¶æ‹–åŠ¨åˆ°Userâ€˜s Desktopå†…</p><p><img src="https://bu.dusays.com/2025/03/13/67d2da4f4073b.png"></p><p><strong>ï¼ˆ4ï¼‰æ‰“åŒ…å‘å¸ƒ</strong></p><p> å¯¹setup1é¡¹ç›®è¿›è¡Œé‡æ–°ç”Ÿæˆï¼Œå³ç”Ÿæˆå®‰è£…ç¨‹åº</p><p><img src="https://bu.dusays.com/2025/03/13/67d2da5f3f9fd.png"></p><h3 id="ä¸‰ï¼Œåˆ©ç”¨Enigma-Virtual-Box-å•æ–‡ä»¶å°è£…å·¥å…·-è¿›è¡Œæ‰“åŒ…"><a href="#ä¸‰ï¼Œåˆ©ç”¨Enigma-Virtual-Box-å•æ–‡ä»¶å°è£…å·¥å…·-è¿›è¡Œæ‰“åŒ…" class="headerlink" title="ä¸‰ï¼Œåˆ©ç”¨Enigma Virtual Box(å•æ–‡ä»¶å°è£…å·¥å…·) è¿›è¡Œæ‰“åŒ…"></a><font color="FF0000">ä¸‰ï¼Œåˆ©ç”¨Enigma Virtual Box(å•æ–‡ä»¶å°è£…å·¥å…·) è¿›è¡Œæ‰“åŒ…</font></h3><p>Enigma è™šæ‹Ÿæ–‡ä»¶æ‰“åŒ…ç³»ç»Ÿå¯ä»¥å°†ç¨‹åºå’Œé…å¥—æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œæ²¡æœ‰ä»»ä½•æ•ˆç‡çš„æŸå¤±ï¼Œé…å¥—æ–‡ä»¶ä¹Ÿä¸ä¼šè¢«é‡Šæ”¾è‡³ç¡¬ç›˜ã€‚ï¼ˆåŒæ—¶æ”¯æŒX86å’ŒX64äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚</p><p>å¦‚å›¾ï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d2da99e4610.png"></p><p><img src="https://bu.dusays.com/2025/03/13/67d2daa7c6d41.png"></p><p>å°†ç”Ÿæˆçš„GCtest_boxedæ–‡ä»¶å¤åˆ¶åˆ°è¦è¿è¡Œçš„è®¾å¤‡ä¸Šå³å¯ï¼ˆå¯ä»¥å•ç‹¬è¿è¡Œï¼‰</p><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt07é¼ æ ‡äº‹ä»¶</title>
      <link href="/2025/03/13/Qt07%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6/"/>
      <url>/2025/03/13/Qt07%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>ä¸ªäººè®¤ä¸ºï¼Œäº‹ä»¶æœºåˆ¶æ˜¯Qtæœ€éš¾ä»¥ç†è§£ä¸”æœ€ä¸ºç²¾å¦™çš„ä¸€éƒ¨åˆ†ã€‚äº‹ä»¶ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p><ol><li><strong>åœ¨ä¸ç”¨æˆ·äº¤äº’æ—¶å‘ç”Ÿ</strong>ã€‚æ¯”å¦‚æŒ‰ä¸‹é¼ æ ‡ï¼ˆmousePressEventï¼‰ï¼Œæ•²å‡»é”®ç›˜ï¼ˆkeyPressEventï¼‰ç­‰ã€‚</li><li><strong>ç³»ç»Ÿè‡ªåŠ¨å‘ç”Ÿ</strong>ï¼Œæ¯”å¦‚è®¡æ—¶å™¨äº‹ä»¶ï¼ˆtimerEventï¼‰ç­‰ã€‚</li></ol><p>åœ¨å‘ç”Ÿäº‹ä»¶æ—¶ï¼ˆæ¯”å¦‚è¯´ä¸Šé¢è¯´çš„æŒ‰ä¸‹é¼ æ ‡ï¼‰ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªQEventå¯¹è±¡ï¼ˆè¿™é‡Œæ˜¯QMouseEventï¼Œä¸ºQEventçš„å­ç±»ï¼‰ï¼Œè¿™ä¸ªQEventå¯¹è±¡ä¼šä¼ ç»™å½“å‰ç»„ä»¶çš„eventå‡½æ•°ã€‚å¦‚æœå½“å‰ç»„ä»¶æ²¡æœ‰å®‰è£…<strong>äº‹ä»¶è¿‡æ»¤å™¨</strong>ï¼ˆè¿™ä¸ªåé¢ä¼šæåˆ°ï¼‰ï¼Œåˆ™ä¼šè¢«eventå‡½æ•°å‘æ”¾åˆ°ç›¸åº”çš„xxxEventå‡½æ•°ä¸­ï¼ˆè¿™é‡Œæ˜¯mousePressEventå‡½æ•°ï¼‰ã€‚</p><p>éœ€è¦åŒºåˆ†çš„æ˜¯ï¼š<strong>äº‹ä»¶ä¸ä¿¡å·å¹¶ä¸ç›¸åŒã€‚</strong></p><p>æ¯”å¦‚ï¼šé¼ æ ‡å•å‡»æŒ‰é’®ï¼Œé¼ æ ‡äº‹ä»¶ï¼ˆQMouseEventï¼‰ï¼Œè€ŒæŒ‰é’®æœ¬èº«å‘å°„clickedï¼ˆï¼‰ä¿¡å·ã€‚ä¸€èˆ¬è€Œè¨€æˆ‘ä»¬åªéœ€è¦å…³æ³¨å•å‡»ä¿¡å·ï¼Œä¸ç”¨è€ƒè™‘é¼ æ ‡äº‹ä»¶ã€‚ä½†æ˜¯å½“æˆ‘ä»¬è¦å¯¹è¯¥æŒ‰é’®åšé¢å¤–æ“ä½œï¼Œä¸æƒ³é€šè¿‡ä¿¡å·å¤„ç†ï¼Œæ­¤æ—¶äº‹ä»¶å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚å…³é—­äº‹ä»¶ï¼ˆQCloseEventï¼‰æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„äº‹ä»¶ã€‚</p><hr><h3 id="ä¸€ï¼Œäº‹ä»¶"><a href="#ä¸€ï¼Œäº‹ä»¶" class="headerlink" title="ä¸€ï¼Œäº‹ä»¶"></a><font color="FF0000">ä¸€ï¼Œäº‹ä»¶</font></h3><p>Qt ä¸­æ‰€æœ‰äº‹ä»¶ç±»éƒ½ç»§æ‰¿äº QEventã€‚åœ¨äº‹ä»¶å¯¹è±¡åˆ›å»ºå®Œæ¯•åï¼ŒQt å°†è¿™ä¸ªäº‹ä»¶å¯¹è±¡ä¼ é€’ç»™ QObject çš„ event()å‡½æ•°ã€‚event()å‡½æ•°å¹¶ä¸ç›´æ¥å¤„ç†äº‹ä»¶ï¼Œè€Œæ˜¯æŒ‰ç…§äº‹ä»¶å¯¹è±¡çš„ç±»å‹åˆ†æ´¾ç»™ç‰¹å®šçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆeventhandlerï¼‰ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d29bf3e8d89.png"></p><p>ä¿¡å·æ˜¯é€šè¿‡connectï¼ˆï¼‰æ¥ç»‘å®šæ§½å‡½æ•°å¤„ç†å“åº”ï¼Œé‚£ä¹ˆäº‹ä»¶æ˜¯æ€ä¹ˆå¤„ç†çš„å‘¢ï¼Ÿ</p><p><strong>å¤„ç†äº‹ä»¶æœ‰5ç§å¸¸ç”¨çš„æ–¹æ³•ï¼š</strong></p><ol><li>é‡æ–°å®ç°éƒ¨ä»¶çš„paintEventï¼ˆï¼‰ã€mousePressEvent()ç­‰äº‹ä»¶å¤„ç†å‡½æ•°ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§æ–¹æ³•ï¼Œä¸è¿‡åªèƒ½ç”¨æ¥å¤„ç†ç‰¹å®šéƒ¨ä»¶çš„ç‰¹å®šäº‹ä»¶ï¼ˆå³éœ€è¦æ–°å»ºç±»å»å®ç°ï¼‰</li><li>é‡æ–°å®ç°notifyï¼ˆï¼‰å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½å¼ºå¤§ï¼Œæä¾›äº†å®Œå…¨çš„æ§åˆ¶ï¼Œå¯ä»¥å†äº‹ä»¶è¿‡æ»¤å™¨å¾—åˆ°äº‹ä»¶ä¹‹é—´å°±è·å¾—ä»–ä»¬ã€‚ä½†æ˜¯ï¼Œå®ƒä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªäº‹ä»¶ã€‚</li><li>å‘QApplicationå¯¹è±¡ä¸Šå®‰è£…äº‹ä»¶è¿‡æ»¤å™¨ã€‚å› ä¸ºä¸€ä¸ªç¨‹åºåªæœ‰ä¸€ä¸ªQApplicationå¯¹è±¡ï¼Œå®ç°çš„åŠŸèƒ½å’Œnotifyï¼ˆï¼‰å‡½æ•°ç›¸åŒï¼Œä¼˜ç‚¹æ˜¯å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªäº‹ä»¶ã€‚</li><li>é‡æ–°å®ç°eventï¼ˆï¼‰å‡½æ•°ã€‚QObjectç±»çš„eventï¼ˆï¼‰å‡½æ•°å¯ä»¥åœ¨äº‹ä»¶è¾¾åˆ°é»˜è®¤äº‹ä»¶å¤„ç†å‡½æ•°ä¹‹å‰è·å¾—è¯¥äº‹ä»¶ã€‚</li><li>åœ¨å¯¹è±¡ä¸Šå®‰è£…äº‹ä»¶è¿‡æ»¤å™¨ã€‚ä½¿ç”¨äº‹ä»¶è¿‡æ»¤å™¨å¯ä»¥å†ä¸€ä¸ªç•Œé¢ç±»ä¸­åŒæ—¶å¤„ç†ä¸åŒå­éƒ¨ä»¶çš„äº‹ä»¶ï¼ˆåœ¨æœ¬ç±»ä¸­å®ç°ï¼‰</li></ol><p>å®é™…ç¼–ç¨‹ä¸­æœ€å¸¸ç”¨çš„æ˜¯æ–¹æ³•ï¼ˆ1ï¼‰ï¼Œå…¶æ¬¡æ˜¯æ–¹æ³•ï¼ˆ5ï¼‰ã€‚æ–¹æ³•2è¦ç»§æ‰¿QApplicationç±»ï¼Œæ–¹æ³•3éœ€è¦å…¨å±€çš„äº‹ä»¶è¿‡æ»¤å™¨ï¼Œå‡ç¼“äº‹ä»¶çš„ä¼ é€’ã€‚</p><p><strong>é¼ æ ‡äº‹ä»¶ï¼š</strong></p><p>å¸¸ç”¨çš„é¼ æ ‡äº‹ä»¶ï¼šï¼ˆæœ¬ç¯‡å¤„ç†äº‹ä»¶ç”¨çš„æ˜¯æ–¹æ³•ä¸€ï¼šé‡å†™é¼ æ ‡äº‹ä»¶ï¼‰</p><ul><li>void mousePressEvent(QMouseEvent *event);      &#x2F;&#x2F;å•å‡»</li><li>void mouseReleaseEvent(QMouseEvent *event);    &#x2F;&#x2F;é‡Šæ”¾</li><li>void mouseDoubleClickEvent(QMouseEvent *event); &#x2F;&#x2F;åŒå‡»</li><li>void mouseMoveEvent(QMouseEvent *event);      &#x2F;&#x2F;ç§»åŠ¨</li><li>void wheelEvent(QWheelEvent *event);           &#x2F;&#x2F;æ»‘è½®</li></ul><p><strong>é¼ æ ‡äº‹ä»¶ä½¿ç”¨çš„æ—¶å€™ï¼ŒåŠ å¤´æ–‡ä»¶ï¼š #include <QMouseEvent></strong></p><p><strong>é‡å†™äº‹ä»¶æ¡†æ¶ï¼š</strong></p><p><strong>1ï¸âƒ£é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::mousePressEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯é¼ æ ‡å·¦é”®æŒ‰ä¸‹   </span></span><br><span class="line">    <span class="keyword">if</span>(event-&gt;<span class="built_in">button</span>() == Qt::LeftButton)&#123;</span><br><span class="line">        Â·Â·Â·</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯é¼ æ ‡å³é”®æŒ‰ä¸‹</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(event-&gt;<span class="built_in">button</span>() == Qt::RightButton)&#123;</span><br><span class="line">       Â·Â·Â·</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2ï¸âƒ£é¼ æ ‡ç§»åŠ¨äº‹ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::mouseMoveEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå¿…é¡»ä½¿ç”¨buttons()</span></span><br><span class="line">    <span class="keyword">if</span>(event-&gt;<span class="built_in">buttons</span>() &amp; Qt::LeftButton)&#123;  <span class="comment">//è¿›è¡Œçš„æŒ‰ä½ä¸</span></span><br><span class="line">       Â·Â·Â·</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè§¦å‘äº‹ä»¶éœ€è¦ç‚¹å‡»ä¸€ä¸‹ï¼Œæ‰èƒ½è§¦å‘ã€‚å¯è®¾ç½®ä¸ºè‡ªåŠ¨è§¦å‘:<strong>setMouseTracking(true);</strong> </p><p><strong>3ï¸âƒ£é¼ æ ‡é‡Šæ”¾äº‹ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::mouseReleaseEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   Â·Â·Â·</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4ï¸âƒ£é¼ æ ‡åŒå‡»äº‹ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::mouseDoubleClickEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯é¼ æ ‡å·¦é”®æŒ‰ä¸‹</span></span><br><span class="line">    <span class="keyword">if</span>(event-&gt;<span class="built_in">button</span>() == Qt::LeftButton)&#123;</span><br><span class="line">      </span><br><span class="line">        Â·Â·Â·</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5ï¸âƒ£æ»šè½®äº‹ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::wheelEvent</span><span class="params">(QWheelEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å½“æ»šè½®è¿œç¦»ä½¿ç”¨è€…æ—¶</span></span><br><span class="line">    <span class="keyword">if</span>(event-&gt;<span class="built_in">delta</span>() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        Â·Â·Â·</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;<span class="comment">//å½“æ»šè½®å‘ä½¿ç”¨è€…æ–¹å‘æ—‹è½¬æ—¶</span></span><br><span class="line">        Â·Â·Â·</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å®ä¾‹æ¼”ç¤º</strong>ï¼ˆåœ¨labelæ§ä»¶ä¸­ï¼Œç§»åŠ¨é¼ æ ‡è·å–å®æ—¶ä½ç½®ï¼Œå¹¶æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šï¼‰</p><ul><li><strong>åˆ›å»ºmylabelç±»ï¼ŒåŸºç±»è®¾ç½®ä¸ºQLabel</strong></li></ul><p><img src="https://bu.dusays.com/2025/03/13/67d29c1584eb6.png"></p><p>è¿™é‡Œç”¨äº†ç±»ä¼¼è‡ªå®šä¹‰æ§ä»¶çš„æ–¹æ³•ï¼Œå¯¹Mylabelç±»è¿›è¡Œå°è£…ã€‚è®¾ç½®åŸºç±»QLabel æ˜¯ä¸ºäº†åœ¨uiç•Œé¢ä¸­æå‡labelæ§ä»¶ï¼ˆå³å°†labelæ§ä»¶å’ŒMylabelå…³è”ï¼Œæå‡æ—¶å€™å¿…é¡»äºŒè€…åŸºç±»ç›¸åŒï¼‰</p><ul><li>åœ¨mylabel.hä¸­å£°æ˜é¼ æ ‡äº‹ä»¶</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;qlabel.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">mylabel</span> : <span class="keyword">public</span> QLabel</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">mylabel</span>(QWidget* parent = <span class="number">0</span>);</span><br><span class="line">    ~<span class="built_in">mylabel</span>();</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//é¼ æ ‡ç§»åŠ¨äº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mouseMoveEvent</span><span class="params">(QMouseEvent* event)</span></span>;</span><br><span class="line">    <span class="comment">//é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mousePressEvent</span><span class="params">(QMouseEvent* event)</span></span>;</span><br><span class="line">    <span class="comment">//é¼ æ ‡é‡Šæ”¾äº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mouseReleaseEvent</span><span class="params">(QMouseEvent* event)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>åœ¨mylabel.cppä¸­é‡å†™äº‹ä»¶</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mylabel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;QMouseEvent&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mylabel::<span class="built_in">mylabel</span>(QWidget* parent) :<span class="built_in">QLabel</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">mylabel::~<span class="built_in">mylabel</span>()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é¼ æ ‡ç§»åŠ¨æ˜¾ç¤ºåæ ‡</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mylabel::mouseMoveEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event-&gt;<span class="built_in">buttons</span>() &amp; Qt::LeftButton)  <span class="comment">//è¿›è¡Œçš„æŒ‰ä½ä¸ï¼ˆåªæœ‰å·¦é”®ç‚¹å‡»ç§»åŠ¨æ‰æ»¡è¶³ï¼‰</span></span><br><span class="line">    &#123; </span><br><span class="line">        QString str = <span class="built_in">QString</span>(<span class="string">&quot;Move:(X:%1,Y:%2)&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>());</span><br><span class="line">         <span class="keyword">this</span>-&gt;<span class="built_in">setText</span>(str);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é¼ æ ‡æŒ‰ä¸‹æ˜¾ç¤ºâ€œokï¼Œmouse is pressâ€</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mylabel::mousePressEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setText</span>(<span class="string">&quot;Ok, mouse is press&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é¼ æ ‡é‡Šæ”¾æ¸…é™¤æ˜¾ç¤º</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mylabel::mouseReleaseEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setText</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸»å‡½æ•°ï¼ˆQTest.cppï¼‰ä¸­å£°æ˜mylabelçš„ç±»å¯¹è±¡ï¼ˆå³å£°æ˜ä¸€ä¸ªmylabelç±»çš„labelæ§ä»¶ï¼‰</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;qtest.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">QTest::<span class="built_in">QTest</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);    <span class="comment">//å£°æ˜mylabelç±»çš„æ§ä»¶</span></span><br><span class="line">    mylabel* label1 = <span class="keyword">new</span> <span class="built_in">mylabel</span>(<span class="keyword">this</span>);</span><br><span class="line">    label1-&gt;<span class="built_in">setGeometry</span>(<span class="built_in">QRect</span>(<span class="number">130</span>, <span class="number">100</span>, <span class="number">271</span>, <span class="number">161</span>));    <span class="comment">//è®¾ç½®è¾¹æ¡†</span></span><br><span class="line">    label1-&gt;<span class="built_in">setFrameShape</span>(QFrame::Panel);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d29c2b5a2ed.png"></p><p> å¦å¤–ï¼Œå½“è°ƒç”¨<strong>setMouseTracking(true)</strong>;æ—¶ï¼ˆå³è®¾ç½®é¼ æ ‡çŠ¶æ€ä¸ºè‡ªåŠ¨è§¦å‘ï¼‰ï¼Œéœ€è¦å°†é¼ æ ‡ç§»åŠ¨äº‹ä»¶çš„ifè¯­å¥å»æ‰ï¼ˆå› ä¸ºä¸éœ€è¦ç‚¹å‡»è§¦å‘äº†ï¼‰</p><p><strong>ä¿®æ”¹maylabel.cppäº‹ä»¶ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mylabel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;QMouseEvent&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mylabel::<span class="built_in">mylabel</span>(QWidget* parent) :<span class="built_in">QLabel</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//è®¾ç½®é¼ æ ‡çŠ¶æ€ï¼ˆè‡ªåŠ¨è§¦å‘ï¼‰</span></span><br><span class="line">    <span class="built_in">setMouseTracking</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">mylabel::~<span class="built_in">mylabel</span>()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é¼ æ ‡ç§»åŠ¨æ˜¾ç¤ºåæ ‡</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mylabel::mouseMoveEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   QString str = <span class="built_in">QString</span>(<span class="string">&quot;Move:(X:%1,Y:%2)&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>());</span><br><span class="line">   <span class="keyword">this</span>-&gt;<span class="built_in">setText</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é¼ æ ‡æŒ‰ä¸‹æ˜¾ç¤ºâ€œokï¼Œmouse is pressâ€</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mylabel::mousePressEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setText</span>(<span class="string">&quot;Ok, mouse is press&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é¼ æ ‡é‡Šæ”¾æ¸…é™¤æ˜¾ç¤º</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mylabel::mouseReleaseEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setText</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ•ˆæœå±•ç¤ºï¼š</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d29c4cbb6f7.gif"></p><p><strong>ğŸ˜’è¿™é‡Œç”¨çš„æ˜¯ä»£ç åˆ›å»ºlabelæ§ä»¶ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½ç”¨uiç•Œé¢ç¼–è¾‘ç„¶ååœ¨å¯¹labelæ§ä»¶æå‡å‘¢ï¼Ÿ</strong></p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<strong>æ­¤å¤„ä¸èƒ½é€‰æ‹©å…¨å±€åŒ…å«</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d29c64cf2e2.png"></p><p> <strong>å¦åˆ™ä¼šå‡ºç°ï¼š</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d29c7542d19.png"></p><p>æˆ‘æƒ³å…¶ä¸­çš„åŸå› ä¸»è¦æ˜¯å› ä¸ºï¼š</p><p>æœ¬å®ä¾‹æ˜¯æ–°å»ºäº†ä¸€ä¸ªmylabelç±»ï¼Œè€Œä¸æ˜¯åƒ<a href="https://www.cnblogs.com/xyf327/p/15097726.html">QTå¸¸ç”¨æ§ä»¶ï¼ˆä¸‰ï¼‰â€”â€”è‡ªå®šä¹‰æ§ä»¶å°è£… - å”¯æœ‰è‡ªå·±å¼ºå¤§ - åšå®¢å›­ (cnblogs.com)</a>è¿™ç¯‡åšæ–‡ä¸­ç›´æ¥æ–°æ·»åŠ äº†ä¸€ä¸ªè®¾è®¡å¸ˆç•Œé¢ç±»ï¼ˆå³åŒ…å«ui .h .cpp)ã€‚å½“é€‰æ‹©å…¨å±€åŒ…å«æ—¶ï¼Œå°±åŒ…å«äº†ä¸»ç±»ã€‚</p><p>å…¶å®ä¹Ÿæœ‰è§£å†³çš„åŠæ³•ï¼šéœ€è¦åœ¨æå‡ç•Œé¢çš„å¤´æ–‡ä»¶å¤„ï¼Œå°†å·¥ç¨‹ç›®å½•ä¸‹è‡ªå®šä¹‰æ§ä»¶çš„åœ°å€æ”¾äºæ­¤å¤„</p><p><img src="https://bu.dusays.com/2025/03/13/67d29c8d1fe53.png"></p><h3 id="äºŒï¼Œäº‹ä»¶çš„åˆ†å‘ï¼ševentå‡½æ•°"><a href="#äºŒï¼Œäº‹ä»¶çš„åˆ†å‘ï¼ševentå‡½æ•°" class="headerlink" title=" äºŒï¼Œäº‹ä»¶çš„åˆ†å‘ï¼ševentå‡½æ•°"></a><font color="FF0000"> äºŒï¼Œäº‹ä»¶çš„åˆ†å‘ï¼ševentå‡½æ•°</font></h3><p>ä¸Šé¢æåˆ°çš„xxxEventå‡½æ•°ï¼Œç§°ä¸ºäº‹ä»¶å¤„ç†å™¨ï¼ˆevent handlerï¼‰ã€‚è€Œeventå‡½æ•°çš„ä½œç”¨å°±åœ¨äºäº‹ä»¶çš„åˆ†å‘ã€‚å¦‚æœæƒ³åœ¨äº‹ä»¶çš„åˆ†å‘ä¹‹å‰å°±è¿›è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚ç›‘å¬ï¼ˆ<strong>é˜»å¡</strong>ï¼‰é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ã€‚</p><p> å¦‚æœå¸Œæœ›åœ¨äº‹ä»¶åˆ†å‘ä¹‹å‰åšä¸€äº›æ“ä½œï¼Œå°±å¯ä»¥é‡å†™è¿™ä¸ª event()å‡½æ•°äº†ã€‚æ¯”å¦‚æˆ‘ä»¬å¸Œæœ›é˜»å¡é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åœ¨æ–°å»ºçš„Mylabelç±»ä¸­é‡å†™event()å‡½æ•°ï¼ˆ<strong>è¯¥ç±»çš„çˆ¶ç±»æ˜¯QLabel</strong>ï¼‰</p><ul><li><strong>åœ¨Mylabel.hä¸­å£°æ˜eventäº‹ä»¶</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qlabel.h&quot;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mylabel</span> : <span class="keyword">public</span> QLabel</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Mylabel</span><span class="params">(QWidget* parent = <span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mousePressEvent</span><span class="params">(QMouseEvent* event)</span></span>; </span><br><span class="line">    <span class="comment">//é¼ æ ‡é‡Šæ”¾äº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mouseReleaseEvent</span><span class="params">(QMouseEvent* event)</span></span>;</span><br><span class="line">    <span class="comment">//å£°æ˜eventäº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">event</span><span class="params">(QEvent* e)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>åœ¨Mylabel.cppä¸­é‡å†™eventäº‹ä»¶ã€‚</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Mylabel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;QMouseEvent&quot;</span></span></span><br><span class="line"></span><br><span class="line">Mylabel::<span class="built_in">Mylabel</span>(QWidget* parent) :<span class="built_in">QLabel</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡å†™é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Mylabel::mousePressEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(<span class="string">&quot;mouse is press x:%1,y:%2&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é‡å†™é¼ æ ‡é‡Šæ”¾äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Mylabel::mouseReleaseEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">setText</span>(<span class="string">&quot;mouse is release &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é‡å†™eventäº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Mylabel::event</span><span class="params">(QEvent* e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//å¦‚æœé¼ æ ‡æŒ‰ä¸‹ï¼Œå†äº‹ä»¶åˆ†å‘ä¸­åšæ‹¦æˆª</span></span><br><span class="line">    <span class="keyword">if</span> (e-&gt;<span class="built_in">type</span>()==QEvent::MouseButtonPress)</span><br><span class="line">    &#123;        <span class="comment">//é™æ€è½¬æ¢ï¼ˆå°†QEventçš„å¯¹è±¡è½¬æ¢ä¸ºQMouseEventå¯¹è±¡ï¼‰</span></span><br><span class="line">        QMouseEvent* event = <span class="built_in">static_cast</span>&lt;QMouseEvent*&gt;(e);</span><br><span class="line">        <span class="keyword">this</span>-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(<span class="string">&quot;event mouse is press x:%1,y:%2&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>()));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//è¿”å›tureï¼Œè¯´æ˜ç”¨æˆ·è‡ªå·±å¤„ç†äº‹ä»¶ï¼Œä¸å¾€ä¸‹åˆ†å‘ï¼ˆå³æ‹¦æˆªä¸Šé¢çš„æŒ‰ä¸‹äº‹ä»¶ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> QLabel::<span class="built_in">event</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d29cb547ab2.png"></p><p>ç‚¹å‡»é¼ æ ‡å¯ä»¥çœ‹åˆ°ï¼Œè§¦å‘çš„æ˜¯eventçš„äº‹ä»¶ï¼ˆå³é˜»å¡äº†mousePressEventçš„äº‹ä»¶ï¼‰ã€‚<strong>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨å°†ä¸éœ€è¦é˜»å¡åˆ†å‘çš„æ—¶å€™ï¼Œéœ€è¦åˆ†å‘ç»™çˆ¶ç±»çš„eventå‡½æ•°å¤„ç†ã€‚å³ï¼ˆreturn QLable::event(e)ï¼›)</strong></p><p>ç”±æ­¤å¯ä»¥è§ï¼Œevent()æ˜¯ä¸€ä¸ªé›†ä¸­å¤„ç†ä¸åŒç±»å‹çš„äº‹ä»¶çš„åœ°æ–¹ã€‚å¦‚æœä½ ä¸æƒ³é‡å†™ä¸€å¤§å †äº‹ä»¶å¤„ç†å™¨ï¼Œå°±å¯ä»¥é‡å†™è¿™ä¸ª event()å‡½æ•°ï¼Œé€šè¿‡ QEvent::type()åˆ¤æ–­ä¸åŒçš„äº‹ä»¶ã€‚é‰´äºé‡å†™ event()å‡½æ•°éœ€è¦ååˆ†å°å¿ƒæ³¨æ„çˆ¶ç±»çš„åŒåå‡½æ•°çš„è°ƒç”¨ï¼Œä¸€ä¸ç•™ç¥å°±å¯èƒ½å‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥ä¸€èˆ¬è¿˜æ˜¯å»ºè®®åªé‡å†™äº‹ä»¶å¤„ç†å™¨ï¼ˆå½“ç„¶ï¼Œä¹Ÿå¿…é¡»è®°å¾—æ˜¯ä¸æ˜¯åº”è¯¥è°ƒç”¨çˆ¶ç±»çš„åŒåå¤„ç†å™¨ï¼‰ã€‚</p><h3 id="ä¸‰ï¼Œäº‹ä»¶è¿‡æ»¤å™¨ï¼ˆEven-Filterï¼‰"><a href="#ä¸‰ï¼Œäº‹ä»¶è¿‡æ»¤å™¨ï¼ˆEven-Filterï¼‰" class="headerlink" title="ä¸‰ï¼Œäº‹ä»¶è¿‡æ»¤å™¨ï¼ˆEven Filterï¼‰"></a><strong>ä¸‰ï¼Œäº‹ä»¶è¿‡æ»¤å™¨ï¼ˆEven Filterï¼‰</strong></h3><p> æŸäº›åº”ç”¨åœºæ™¯ä¸‹ï¼Œéœ€è¦æ‹¦æˆªæŸä¸ªç»„ä»¶å‘ç”Ÿçš„äº‹ä»¶ï¼Œè®©è¿™ä¸ªäº‹ä»¶ä¸å†å‘å…¶ä»–ç»„ä»¶è¿›è¡Œä¼ æ’­ï¼Œè¿™æ—¶å€™å¯ä»¥ä¸ºè¿™ä¸ªç»„ä»¶æˆ–å…¶çˆ¶ç»„ä»¶å®‰è£…ä¸€ä¸ªäº‹ä»¶è¿‡æ»¤å™¨ï¼Œ<strong>è¯¥è¿‡æ»¤å™¨åœ¨eventåˆ†å‘ä¹‹å‰è¿›è¡Œæ‹¦æˆªã€‚</strong></p><p><strong>äº‹ä»¶çš„è¿‡æ»¤æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼š</strong></p><p>1ï¸âƒ£å¯¹QObjectç»„ä»¶å®‰è£…è¿‡æ»¤å™¨ï¼ˆ<strong>è°ƒç”¨installEvenFilterå‡½æ•°</strong>ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">QObject::installEventFilter</span> <span class="params">( QObject * filterObj )</span></span>;</span><br></pre></td></tr></table></figure><p>å‚æ•°filterobj æ˜¯æŒ‡è°ä¸ºç»„ä»¶å®‰è£…è¿‡æ»¤å™¨ï¼ˆä¸€èˆ¬æ˜¯çˆ¶ç±»ï¼‰</p><ul><li>è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ª QObject *ç±»å‹çš„å‚æ•°ã€‚è®°å¾—åˆšåˆšæˆ‘ä»¬è¯´çš„ï¼ŒeventFilter()å‡½æ•°æ˜¯ QObject çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œå› æ­¤ï¼Œä»»æ„ QObject éƒ½å¯ä»¥ä½œä¸ºäº‹ä»¶è¿‡æ»¤å™¨ï¼ˆé—®é¢˜åœ¨äºï¼Œå¦‚æœä½ æ²¡æœ‰é‡å†™ eventFilter()å‡½æ•°ï¼Œè¿™ä¸ªäº‹ä»¶è¿‡æ»¤å™¨æ˜¯æ²¡æœ‰ä»»ä½•ä½œç”¨çš„ï¼Œå› ä¸ºé»˜è®¤ä»€ä¹ˆéƒ½ä¸ä¼šè¿‡æ»¤ï¼‰ã€‚å·²ç»å­˜åœ¨çš„è¿‡æ»¤å™¨åˆ™å¯ä»¥é€šè¿‡**QObject::removeEventFilter()**å‡½æ•°ç§»é™¤ã€‚ </li><li>æˆ‘ä»¬å¯ä»¥å‘ä¸€ä¸ªå¯¹è±¡ä¸Šé¢å®‰è£…å¤šä¸ªäº‹ä»¶å¤„ç†å™¨ ï¼Œåªè¦è°ƒç”¨å¤šæ¬¡installEventFilter()å‡½æ•°ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å­˜åœ¨å¤šä¸ªäº‹ä»¶è¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆï¼Œæœ€åä¸€ä¸ªå®‰è£…çš„ä¼šç¬¬ä¸€ä¸ªæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åè¿›å…ˆæ‰§è¡Œçš„é¡ºåºã€‚</li></ul><p>2ï¸âƒ£äº‹ä»¶è¿‡æ»¤å™¨çš„é‡å†™ï¼ˆ<strong>evenFilterå‡½æ•°</strong>ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">QObject::eventFilter</span> <span class="params">( QObject * watched, QEvent * event )</span></span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸ºå…·ä½“å‘ç”Ÿäº‹ä»¶çš„ç»„ä»¶ï¼Œä¸€ä¸ªä¸ºå‘ç”Ÿçš„äº‹ä»¶ï¼ˆäº§ç”Ÿçš„QEventå¯¹è±¡ï¼‰ã€‚å½“äº‹ä»¶æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç±»å‹ï¼Œå¯ä»¥å°±åœ°è¿›è¡Œå¤„ç†ï¼Œå¹¶ä»¤å…¶ä¸å†è½¬å‘ç»™å…¶ä»–ç»„ä»¶ã€‚å‡½æ•°çš„è¿”å›å€¼ä¹Ÿæ˜¯boolç±»å‹ï¼Œä½œç”¨è·Ÿevenå‡½æ•°ç±»ä¼¼ï¼Œè¿”å›trueä¸ºä¸å†è½¬å‘ï¼Œfalseåˆ™è®©å…¶ç»§ç»­è¢«å¤„ç†ã€‚</p><p><strong>å®ä¾‹</strong>ï¼šé€šè¿‡äº‹ä»¶è¿‡æ»¤å™¨é˜»å¡ä¸Šé¢ä»£ç ä¸­çš„é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;qtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qmouseevent&quot;</span></span></span><br><span class="line"></span><br><span class="line">QTest::<span class="built_in">QTest</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ï¼šç»™labelæ·»åŠ è¿‡æ»¤å™¨</span></span><br><span class="line">    ui.label-&gt;<span class="built_in">installEventFilter</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç¬¬äºŒæ­¥ï¼šé‡å†™è¿‡æ»¤äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QTest::eventFilter</span><span class="params">(QObject* obj, QEvent* e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj == ui.label)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//å¦‚æœé¼ æ ‡æŒ‰ä¸‹ï¼Œå†äº‹ä»¶åˆ†å‘ä¸­åšæ‹¦æˆª</span></span><br><span class="line">        <span class="keyword">if</span> (e-&gt;<span class="built_in">type</span>() == QEvent::MouseButtonPress)</span><br><span class="line">        &#123;</span><br><span class="line">            QMouseEvent* event = <span class="built_in">static_cast</span>&lt;QMouseEvent*&gt;(e);</span><br><span class="line">            ui.label-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(<span class="string">&quot;eventfilter mouse is press x:%1,y:%2&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>()));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//è¿”å›tureï¼Œè¯´æ˜ç”¨æˆ·è‡ªå·±å¤„ç†äº‹ä»¶ï¼Œä¸å¾€ä¸‹åˆ†å‘ï¼ˆå³æ‹¦æˆªä¸Šé¢çš„æŒ‰ä¸‹äº‹ä»¶ï¼‰</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> QWidget::<span class="built_in">eventFilter</span>(obj, e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡å†™é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QTest::mousePressEvent</span><span class="params">(QMouseEvent* event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ui.label-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(<span class="string">&quot;mouse is press x:%1,y:%2&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>()));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é‡å†™äº‹ä»¶åˆ†å‘</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QTest::event</span><span class="params">(QEvent* e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//å¦‚æœé¼ æ ‡æŒ‰ä¸‹ï¼Œå†äº‹ä»¶åˆ†å‘ä¸­åšæ‹¦æˆª</span></span><br><span class="line">    <span class="keyword">if</span> (e-&gt;<span class="built_in">type</span>() == QEvent::MouseButtonPress)</span><br><span class="line">    &#123;</span><br><span class="line">        QMouseEvent* event = <span class="built_in">static_cast</span>&lt;QMouseEvent*&gt;(e);</span><br><span class="line">        ui.label-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(<span class="string">&quot;event mouse is press x:%1,y:%2&quot;</span>).<span class="built_in">arg</span>(event-&gt;<span class="built_in">x</span>()).<span class="built_in">arg</span>(event-&gt;<span class="built_in">y</span>()));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//è¿”å›tureï¼Œè¯´æ˜ç”¨æˆ·è‡ªå·±å¤„ç†äº‹ä»¶ï¼Œä¸å¾€ä¸‹åˆ†å‘ï¼ˆå³æ‹¦æˆªä¸Šé¢çš„æŒ‰ä¸‹äº‹ä»¶ï¼‰</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> QWidget::<span class="built_in">event</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœï¼š</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d29ccad815a.png"></p><p>å¯ä»¥çœ‹åˆ°åœ¨è¿‡æ»¤å™¨äº‹ä»¶ä¸­å°±ç›‘å¬äº†é¼ æ ‡æŒ‰å‹ï¼ˆå³é˜»å¡äº†åé¢çš„äº‹ä»¶åˆ†å‘å’Œé¼ æ ‡æŒ‰å‹ï¼‰</p><h3 id="æŒ‰é’®é•¿æŒ‰äº‹ä»¶"><a href="#æŒ‰é’®é•¿æŒ‰äº‹ä»¶" class="headerlink" title="æŒ‰é’®é•¿æŒ‰äº‹ä»¶"></a><font color="FF0000">æŒ‰é’®é•¿æŒ‰äº‹ä»¶</font></h3><p>æœ€è¿‘åœ¨åšqté¡¹ç›®ï¼Œéœ€è¦å¯¹buttonæŒ‰é’®æ·»åŠ ä¸€ä¸ªé•¿æŒ‰äº‹ä»¶ï¼ˆæ¯”å¦‚ç‚¹å‡»æŒ‰é’®ï¼Œå¼€å§‹è¿åŠ¨ã€‚æ¾å¼€æŒ‰é’®ï¼Œè¿åŠ¨åœæ­¢ï¼‰ã€‚æŸ¥äº†äº›è®¸èµ„æ–™ï¼Œï¼ˆå·®ç‚¹è¯¯æŠŠQPushButtonçš„pressä¿¡å·å’Œé•¿æŒ‰äº‹ä»¶æ··æ·†ï¼‰åœ¨æ­¤è®°å½•ä¸€ä¸‹ç»éªŒã€‚</p><h4 id="setAutoRepeat"><a href="#setAutoRepeat" class="headerlink" title="setAutoRepeat"></a><font color="FF0000">setAutoRepeat</font></h4><p>ä»¥å‰ä¸€ç›´ä»¥ä¸ºQPushButtonä¸æ”¯æŒé•¿æŒ‰ï¼Œæ‰å‘ç°è¿˜æœ‰è¿™ä¸ªåŠŸèƒ½ã€‚ç”¨èµ·æ¥å¾ˆç®€å•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QPushButton *pBtnSub = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="keyword">this</span>);</span><br><span class="line">pBtnSub = <span class="built_in">setAutoRepeat</span>(<span class="literal">true</span>);  <span class="comment">//å¯åŠ¨é•¿æŒ‰</span></span><br><span class="line">pBtnSub = <span class="built_in">setAutoRepeatDelay</span>(<span class="number">400</span>);  <span class="comment">// è§¦å‘é•¿æŒ‰æ—¶é—´</span></span><br><span class="line">pBtnSub = <span class="built_in">setAutoRepeatInterval</span>(<span class="number">50</span>);  <span class="comment">// é•¿æŒ‰æ—¶clickä¿¡å·é—´éš”</span></span><br><span class="line"><span class="built_in">connect</span>(pBtnSub,&amp;QPushButton::clicked,[&amp;]&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;send&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>MouseEventä¸­æ²¡æœ‰repeatè¿™ä¸ªä¸œè¥¿çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªæŒ‰é’®è¢«é¼ æ ‡ç‚¹å‡»è¿˜èƒ½è¿ç»­è§¦å‘ï¼Œé‚£åŸºæœ¬å°±æ˜¯ä¸€ä¸ªå®šæ—¶å™¨åšå‡ºæ¥çš„ã€‚</p><p><strong>æ‰€ä»¥åº”è¯¥è¯´æ˜¯é¼ æ ‡æŒ‰ä¸‹Delayæ—¶é—´åä¼šå¯åŠ¨ä¸€ä¸ªå¤šæ¬¡è§¦å‘çš„TimerEventï¼ˆå®šæ—¶å™¨ï¼‰ï¼Œç”±timeOutå†æ¬¡è§¦å‘clickæ§½ã€‚</strong></p><h4 id="QPushButton-ç‚¹å‡»ä¿¡å·åˆ†æ"><a href="#QPushButton-ç‚¹å‡»ä¿¡å·åˆ†æ" class="headerlink" title="QPushButton ç‚¹å‡»ä¿¡å·åˆ†æ"></a><font color="FF0000">QPushButton ç‚¹å‡»ä¿¡å·åˆ†æ</font></h4><p>å†æ¥åˆ†æä¸€ä¸‹QPushButtonçš„ç‚¹å‡»ä¿¡å·ã€‚QPushButtonæœ‰ä¸‰ä¸ªå¾ˆé‡è¦çš„ä¿¡å·è·Ÿç‚¹å‡»æœ‰å…³ï¼š</p><ul><li>pressed</li><li>clicked</li><li>toggled</li></ul><p>è¡¨é¢ä¸Šçœ‹ï¼Œpressedå’Œclickedéƒ½ä¼šåœ¨ç‚¹å‡»æŒ‰é’®æ—¶è§¦å‘ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿtoggledå¥½åƒæœ‰æ—¶å€™è§¦å‘ï¼Œæœ‰æ—¶å€™ä¸è§¦å‘ï¼Œåˆ°åº•æ€ä¹ˆå›äº‹å‘¢ï¼Ÿä¸‹é¢å°±ä¸€èµ·èŠä¸€ä¸‹è¿™ä¸‰ä¸ªä¿¡å·</p><p><strong>ğŸ˜ŠéªŒè¯è¿‡ç¨‹å°±ä¸æ”¾äº†ï¼Œç›´æ¥ç»™ç»“è®ºå§ï¼</strong></p><p>é¦–å…ˆï¼Œè¿™ä¸‰ä¸ªä¿¡å·éƒ½æ˜¯ä»QAbstractButtonç»§æ‰¿æ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‹é¢æƒ…å†µå¯¹QAbstractButtonçš„æ‰€æœ‰å­ç±»éƒ½é€‚ç”¨</p><p><strong>ç»“è®ºï¼š</strong></p><ol><li>pressedæœ€å…ˆæ‰§è¡Œï¼Œç›¸å½“äºæŒ‰ä¸‹æ“ä½œ</li><li>æŒ‰ä¸‹ä¹‹åï¼ŒæŒ‰é’®çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œè§¦å‘toggled</li><li>clickedæœ€åæ‰§è¡Œï¼Œç›¸å½“äºå¼¹èµ·æ“ä½œ</li></ol><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt06å®šæ—¶å™¨</title>
      <link href="/2025/03/13/Qt06%E5%AE%9A%E6%97%B6%E5%99%A8/"/>
      <url>/2025/03/13/Qt06%E5%AE%9A%E6%97%B6%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>Qtä¸­æœ‰ä¸¤ç§æ–¹æ³•æ¥ä½¿ç”¨å®šæ—¶å™¨ï¼Œä¸€ç§æ˜¯å®šæ—¶å™¨äº‹ä»¶ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨ä¿¡å·å’Œæ§½ã€‚</p><p>å¸¸ä½¿ç”¨ä¿¡å·å’Œæ§½ï¼ˆä»£ç çœ‹èµ·æ¥æ¯”è¾ƒæ•´æ´ï¼‰ä½†æ˜¯å½“ä½¿ç”¨å¤šä¸ªå®šæ—¶å™¨çš„æ—¶å€™æœ€å¥½ç”¨å®šæ—¶å™¨äº‹ä»¶æ¥å¤„ç†ã€‚ </p><h3 id="å®šæ—¶å™¨æ–¹å¼ä¸€ï¼šå®šæ—¶å™¨äº‹ä»¶"><a href="#å®šæ—¶å™¨æ–¹å¼ä¸€ï¼šå®šæ—¶å™¨äº‹ä»¶" class="headerlink" title="å®šæ—¶å™¨æ–¹å¼ä¸€ï¼šå®šæ—¶å™¨äº‹ä»¶"></a><font color="FF0000">å®šæ—¶å™¨æ–¹å¼ä¸€ï¼šå®šæ—¶å™¨äº‹ä»¶</font></h3><p><strong>éœ€è¦</strong>ï¼š #include <QTimerEvent></p><p><strong>æ–¹å¼</strong>ï¼š</p><ul><li>åˆ©ç”¨å¯¹void timerEvent(QTimerEvent* e)äº‹ä»¶çš„é‡å†™ã€‚</li><li>å¯åŠ¨å®šæ—¶å™¨ int QObject::startTimer ( int interval ) ;</li></ul><p>å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¿”å›å€¼ä¸ºintç±»å‹ã€‚ä»–çš„å‚æ•°intervalæ˜¯æ¯«ç§’çº§åˆ«ã€‚å½“å¼€å¯æˆåŠŸåä¼šè¿”å›è¿™ä¸ªå®šæ—¶å™¨çš„ID, å¹¶ä¸”æ¯éš”interval æ—¶é—´åä¼šè¿›å…¥timerEvent å‡½æ•°ã€‚ç›´åˆ°å®šæ—¶å™¨è¢«æ€æ­»ï¼ˆkillTimerï¼‰</p><ul><li>timerEventçš„è¿”å›å€¼æ˜¯å®šæ—¶å™¨çš„å”¯ä¸€æ ‡è¯†ã€‚å¯ä»¥å’Œe-&gt;timerIdæ¯”è¾ƒ</li><li>void killTimer(int id); &#x2F;&#x2F;åœæ­¢ ID ä¸º id çš„è®¡æ—¶å™¨ï¼ŒID ç”± startTimer()å‡½æ•°è¿”å›</li></ul><p><strong>å®ä¾‹</strong>ï¼šåœ¨ä¸¤ä¸ªlabelä¸­è‡ªåŠ¨è®¡æ•°ï¼Œä¸€ä¸ªé—´éš”ä¸º1ç§’ï¼Œä¸€ä¸ªä¸º2ç§’ã€‚</p><ul><li><strong>åœ¨å¤´æ–‡ä»¶ä¸­å…ˆå£°æ˜void timerEvent(QTimerEvent* e)äº‹ä»¶</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_Qtcontrol.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Qtcontrol</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Qtcontrol</span>(QWidget *parent = Q_NULLPTR);</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//é‡å†™å®šæ—¶å™¨äº‹ä»¶</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">timerEvent</span><span class="params">(QTimerEvent* e)</span></span>;</span><br><span class="line">    <span class="type">int</span> ID1;</span><br><span class="line">    <span class="type">int</span> ID2;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::QtcontrolClass ui;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>åœ¨æºæ–‡ä»¶ä¸­å®ç°</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Qtcontrol.h&quot;</span></span></span><br><span class="line">Qtcontrol::<span class="built_in">Qtcontrol</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//å¯åŠ¨å®šæ—¶å™¨</span></span><br><span class="line"> ID1=   <span class="built_in">startTimer</span>(<span class="number">1000</span>);<span class="comment">//å¯åŠ¨å®šæ—¶å™¨äº‹ä»¶,åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨å¹¶è¿”å›å®šæ—¶å™¨ID</span></span><br><span class="line"><span class="comment">//å‚æ•°ï¼šå•ä½æ¯«ç§’---æ¯éš”næ¯«ç§’æ—¶é—´ï¼Œå°±æ‰§è¡Œä¸€æ¬¡å®šæ—¶å™¨äº‹ä»¶</span></span><br><span class="line"><span class="comment">//è¿”å›å€¼ï¼šå®šæ—¶å™¨IDå·</span></span><br><span class="line"> ID2 = <span class="built_in">startTimer</span>(<span class="number">2000</span>);<span class="comment">//ä¸¤ç§’å¯åŠ¨ä¸€æ¬¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Qtcontrol::timerEvent</span><span class="params">(QTimerEvent* e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e-&gt;<span class="built_in">timerId</span>()==ID1)</span><br><span class="line">    &#123;</span><br><span class="line">   <span class="type">static</span> <span class="type">int</span> num = <span class="number">1</span>;</span><br><span class="line">    ui.label-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(num++));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (e-&gt;<span class="built_in">timerId</span>()==ID2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">static</span> <span class="type">int</span> num = <span class="number">1</span>;</span><br><span class="line">        ui.label_2 -&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(num++));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ‰€æœ‰çš„äº‹ä»¶éƒ½é‡å†™åœ¨äº†timerEventä¸­ï¼Œå› æ­¤å½“éœ€è¦å¤šä¸ªå®šæ—¶å™¨æ—¶ï¼Œå¯ä»¥ç”¨å®šæ—¶å™¨çš„IDå»å¯¹åº”timerEventä¸­çš„äº‹ä»¶ã€‚</p><h3 id="å®šæ—¶å™¨æ–¹å¼äºŒï¼šQTimerç±»ï¼ˆä¿¡å·ä¸æ§½ï¼‰"><a href="#å®šæ—¶å™¨æ–¹å¼äºŒï¼šQTimerç±»ï¼ˆä¿¡å·ä¸æ§½ï¼‰" class="headerlink" title="å®šæ—¶å™¨æ–¹å¼äºŒï¼šQTimerç±»ï¼ˆä¿¡å·ä¸æ§½ï¼‰"></a><font color="FF0000">å®šæ—¶å™¨æ–¹å¼äºŒï¼šQTimerç±»ï¼ˆä¿¡å·ä¸æ§½ï¼‰</font></h3><p><strong>éœ€è¦</strong> ï¼š #include <QTimer></p><p><strong>æ–¹å¼ï¼š</strong></p><ol><li>åˆ©ç”¨å®šæ—¶å™¨ç±»QTimer</li><li>åˆ›å»ºå®šæ—¶å™¨å¯¹è±¡ QTimer *timer&#x3D;new QTimer(this)</li><li>å¯åŠ¨å®šæ—¶å™¨timer-&gt;start( 500ï¼‰ &#x2F;&#x2F;å‚æ•°ï¼šæ¯éš”næ¯«ç§’å‘é€ä¸€ä¸ªä¿¡å·ï¼ˆtimeoutï¼‰</li><li>ç”¨connectè¿æ¥ä¿¡å·å’Œæ§½å‡½æ•°ï¼ˆè‡ªå®šä¹‰æ§½ï¼‰</li><li>æš‚åœ timer-&gt;stop</li></ol><p><strong>å®ä¾‹</strong>ï¼šå¯åŠ¨label æ¯éš”0.5ç§’è®¡æ—¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Qtcontrol.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qtimer.h&quot;</span></span></span><br><span class="line">Qtcontrol::<span class="built_in">Qtcontrol</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">QTimer* timer = <span class="keyword">new</span> <span class="built_in">QTimer</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="comment">//å¯åŠ¨å®šæ—¶å™¨</span></span><br><span class="line">timer-&gt;<span class="built_in">start</span>(<span class="number">500</span>);<span class="comment">//æ¯éš”0.5ç§’ä¼šå‘ä¸€ä¸ªä¿¡å·</span></span><br><span class="line"><span class="built_in">connect</span>(timer, &amp;QTimer::timeout, [=]() &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> num = <span class="number">1</span>;</span><br><span class="line">    ui.label-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(num++));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt05å¤šçº¿ç¨‹å’Œçº¿ç¨‹æ± </title>
      <link href="/2025/03/13/Qt05%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
      <url>/2025/03/13/Qt05%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€ï¼Œ-æœ€ç®€å•çš„å¤šçº¿ç¨‹QtConcurrent-run"><a href="#ä¸€ï¼Œ-æœ€ç®€å•çš„å¤šçº¿ç¨‹QtConcurrent-run" class="headerlink" title=" ä¸€ï¼Œ æœ€ç®€å•çš„å¤šçº¿ç¨‹QtConcurrent::run()"></a><font color="FF0000"> ä¸€ï¼Œ æœ€ç®€å•çš„å¤šçº¿ç¨‹QtConcurrent::run()</font></h3><ul><li><strong>å…¶å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QFuture&lt;T&gt; <span class="title">QtConcurrent::run</span><span class="params">(Function function, ...)</span></span></span><br><span class="line"><span class="function">QFuture&lt;T&gt; <span class="title">QtConcurrent::run</span><span class="params">(QThreadPool *pool, Function function, ...)</span></span></span><br></pre></td></tr></table></figure><p>å‚æ•°functionéœ€è¦å¤–éƒ¨å‡½æ•°ï¼šï¼ˆæˆ–è€…lambdaå‡½æ•°ï¼‰ï¼Œåé¢ä¹Ÿå¯è·Ÿå¤–éƒ¨å‡½æ•°çš„å‚æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">extern</span> <span class="type">void</span> <span class="title">func</span><span class="params">(QString str)</span></span>;</span><br></pre></td></tr></table></figure><p><strong>QtConcurrent :: runï¼ˆï¼‰ä¹Ÿæ¥å—æŒ‡å‘æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆ</strong>ã€‚ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªconstå¼•ç”¨æˆ–ä¸€ä¸ªæŒ‡å‘è¯¥ç±»å®ä¾‹çš„æŒ‡é’ˆã€‚constæˆå‘˜å‡½æ•°ä¸€èˆ¬ä¼ é€’ å¸¸é‡å¼•ç”¨ (const reference)ï¼Œè€Œéå¸¸é‡æˆå‘˜å‡½æ•°ä¸€èˆ¬ä¼ é€’ æŒ‡é’ˆ (pointer)</p><ul><li><strong>åœ¨VSç¯å¢ƒä¸­éœ€è¦å¼•ç”¨ï¼š</strong> <strong>#includeâ€QtConcurrent&#x2F;qtconcurrentrun.hâ€</strong></li></ul><p>ç®€å•çš„è¯´ï¼ŒQtConcurrent::run()å‡½æ•°ä¼šåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå¹¶ä¸”è¯¥çº¿ç¨‹å–è‡ªå…¨å±€QThreadPoolï¼Œè¯¥å‡½æ•°çš„è¿”å›å€¼é€šè¿‡QFuture APIæä¾›ã€‚<br>è¯·æ³¨æ„ï¼šè¯¥å‡½æ•°å¯èƒ½ä¸ä¼šç«‹å³è¿è¡Œ; å‡½æ•°åªæœ‰åœ¨çº¿ç¨‹å¯ç”¨æ—¶æ‰ä¼šè¿è¡Œã€‚é€šè¿‡QtConcurrent::run()è¿”å›çš„QFutureä¸æ”¯æŒå–æ¶ˆã€æš‚åœï¼Œè¿”å›çš„QFutureåªèƒ½ç”¨äºæŸ¥è¯¢å‡½æ•°çš„è¿è¡Œ&#x2F;å®ŒæˆçŠ¶æ€å’Œè¿”å›å€¼ã€‚</p><ul><li><strong>å®ä¾‹ï¼šå®ç°å¤šçº¿ç¨‹è€—æ—¶æ“ä½œï¼ˆè°ƒç”¨æˆå‘˜å‡½æ•°ï¼‰</strong></li></ul><p>åœ¨ä¸»ç¨‹åºthreadtest.hä¸­å£°æ˜æˆå‘˜å‡½æ•°ï¼ˆå¹¶æ·»åŠ å¼•ç”¨ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QMainWindow&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;workThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;QtConcurrent/qtconcurrentrun.h&quot;</span><span class="comment">//QtConcurrentå¼•ç”¨</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> execution_character_set(<span class="string">&quot;utf-8&quot;</span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Threadtest</span> : <span class="keyword">public</span> QMainWindow</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Threadtest</span>(QWidget *parent = Q_NULLPTR);</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::ThreadtestClass ui;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span></span>;<span class="comment">//æˆå‘˜å‡½æ•°</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸»ç¨‹åºthreadtest.cppä¸­è°ƒç”¨æˆå‘˜å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Threadtest::<span class="built_in">Threadtest</span>(QWidget* parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">connect</span>(ui.btn_start, &amp;QPushButton::clicked, [=]()</span><br><span class="line">        &#123;        <span class="comment">//å°†æˆå‘˜å‡½æ•°æ”¾å…¥å‚æ•°ä¸­ï¼ˆæˆå‘˜å‡½æ•°éœ€è¦å¼•ç”¨æŒ‡é’ˆï¼‰</span></span><br><span class="line">            QtConcurrent::<span class="built_in">run</span>(<span class="keyword">this</span>, &amp;Threadtest::work);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Threadtest::work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å­çº¿ç¨‹è¿è¡Œï¼š&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    QThread::<span class="built_in">sleep</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å­çº¿ç¨‹ç»“æŸï¼š&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»æŒ‰é’®å³å¯è§¦å‘å­çº¿ç¨‹è¿è¡Œã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d70d1e369.png"></p><ul><li><strong>å®ä¾‹ï¼šå®ç°å¤šçº¿ç¨‹è€—æ—¶æ“ä½œï¼ˆè°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œå¸¦å‚æ•°ï¼‰</strong></li></ul><p>åœ¨ä¸»ç¨‹åºthreadtest.hä¸­å£°æ˜å¤–éƒ¨å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QMainWindow&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;workThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;QtConcurrent/qtconcurrentrun.h&quot;</span><span class="comment">//QtConcurrentå¼•ç”¨</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> execution_character_set(<span class="string">&quot;utf-8&quot;</span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Threadtest</span> : <span class="keyword">public</span> QMainWindow</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Threadtest</span>(QWidget *parent = Q_NULLPTR);  </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::ThreadtestClass ui;</span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="type">void</span> <span class="title">func</span><span class="params">(QString str)</span></span>;<span class="comment">//å¤–éƒ¨å‡½æ•°</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸»ç¨‹åºthreadtest.cppä¸­è°ƒç”¨å¤–éƒ¨å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Threadtest::<span class="built_in">Threadtest</span>(QWidget* parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">connect</span>(ui.btn_start, &amp;QPushButton::clicked, [=]()</span><br><span class="line">        &#123;</span><br><span class="line">            QtConcurrent::<span class="built_in">run</span>(func,<span class="built_in">QString</span>(<span class="string">&quot;extern&quot;</span>));</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(QString str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å­çº¿ç¨‹è¿è¡Œï¼š&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>()&lt;&lt; str;</span><br><span class="line">    QThread::<span class="built_in">sleep</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å­çº¿ç¨‹ç»“æŸï¼š&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>()&lt;&lt; str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d2d72cb57a3.png"></p><h3 id="äºŒï¼Œçº¿ç¨‹æ± "><a href="#äºŒï¼Œçº¿ç¨‹æ± " class="headerlink" title="äºŒï¼Œçº¿ç¨‹æ± "></a><font color="FF0000">äºŒï¼Œçº¿ç¨‹æ± </font></h3><h4 id="2-1-çº¿ç¨‹æ± åŸç†"><a href="#2-1-çº¿ç¨‹æ± åŸç†" class="headerlink" title="2.1 çº¿ç¨‹æ± åŸç†"></a><font color="FF0000">2.1 çº¿ç¨‹æ± åŸç†</font></h4><p>æˆ‘ä»¬ä½¿ç”¨çº¿ç¨‹çš„æ—¶å€™å°±å»åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™æ ·å®ç°èµ·æ¥éå¸¸ç®€ä¾¿ï¼Œä½†æ˜¯å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœå¹¶å‘çš„çº¿ç¨‹æ•°é‡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯æ‰§è¡Œä¸€ä¸ªæ—¶é—´å¾ˆçŸ­çš„ä»»åŠ¡å°±ç»“æŸäº†ï¼Œè¿™æ ·é¢‘ç¹åˆ›å»ºçº¿ç¨‹å°±ä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹éœ€è¦æ—¶é—´ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§åŠæ³•ä½¿å¾—çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œå°±æ˜¯æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸è¢«é”€æ¯ï¼Œè€Œæ˜¯å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡å‘¢ï¼Ÿ</p><p><strong>çº¿ç¨‹æ± </strong>æ˜¯ä¸€ç§å¤šçº¿ç¨‹å¤„ç†å½¢å¼ï¼Œ<strong>å¤„ç†è¿‡ç¨‹ä¸­å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œç„¶ååœ¨åˆ›å»ºçº¿ç¨‹åè‡ªåŠ¨å¯åŠ¨è¿™äº›ä»»åŠ¡</strong>ã€‚çº¿ç¨‹æ± çº¿ç¨‹éƒ½æ˜¯åå°çº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ä½¿ç”¨é»˜è®¤çš„å †æ ˆå¤§å°ï¼Œä»¥é»˜è®¤çš„ä¼˜å…ˆçº§è¿è¡Œï¼Œå¹¶å¤„äºå¤šçº¿ç¨‹å•å…ƒä¸­ã€‚å¦‚æœæŸä¸ªçº¿ç¨‹åœ¨æ‰˜ç®¡ä»£ç ä¸­ç©ºé—²ï¼ˆå¦‚æ­£åœ¨ç­‰å¾…æŸä¸ªäº‹ä»¶ï¼‰, åˆ™çº¿ç¨‹æ± å°†æ’å…¥å¦ä¸€ä¸ªè¾…åŠ©çº¿ç¨‹æ¥ä½¿æ‰€æœ‰å¤„ç†å™¨ä¿æŒç¹å¿™ã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹æ± çº¿ç¨‹éƒ½å§‹ç»ˆä¿æŒç¹å¿™ï¼Œä½†é˜Ÿåˆ—ä¸­åŒ…å«æŒ‚èµ·çš„å·¥ä½œï¼Œåˆ™çº¿ç¨‹æ± å°†åœ¨ä¸€æ®µæ—¶é—´ååˆ›å»ºå¦ä¸€ä¸ªè¾…åŠ©çº¿ç¨‹ä½†çº¿ç¨‹çš„æ•°ç›®æ°¸è¿œä¸ä¼šè¶…è¿‡æœ€å¤§å€¼ã€‚è¶…è¿‡æœ€å¤§å€¼çš„çº¿ç¨‹å¯ä»¥æ’é˜Ÿï¼Œä½†ä»–ä»¬è¦ç­‰åˆ°å…¶ä»–çº¿ç¨‹å®Œæˆåæ‰å¯åŠ¨ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d2d7749a097.png"></p><h4 id="2-2-QRunnable"><a href="#2-2-QRunnable" class="headerlink" title="2.2 QRunnable"></a><font color="FF0000">2.2 QRunnable</font></h4><p>åœ¨ Qt ä¸­ä½¿ç”¨çº¿ç¨‹æ± éœ€è¦å…ˆåˆ›å»ºä»»åŠ¡ï¼Œæ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­çš„æ¯ä¸€ä¸ªä»»åŠ¡éƒ½éœ€è¦æ˜¯ä¸€ä¸ª QRunnable ç±»å‹ï¼Œå› æ­¤åœ¨ç¨‹åºä¸­éœ€è¦åˆ›å»ºå­ç±»ç»§æ‰¿ QRunnable è¿™ä¸ªç±»ï¼Œç„¶åé‡å†™ run() æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ç¼–å†™è¦åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶å°†è¿™ä¸ªå­ç±»å¯¹è±¡ä¼ é€’ç»™çº¿ç¨‹æ± ï¼Œè¿™æ ·ä»»åŠ¡å°±å¯ä»¥è¢«çº¿ç¨‹æ± ä¸­çš„æŸä¸ªå·¥ä½œçš„çº¿ç¨‹å¤„ç†æ‰äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å­ç±»ä¸­å¿…é¡»è¦é‡å†™çš„å‡½æ•°, é‡Œè¾¹æ˜¯ä»»åŠ¡çš„å¤„ç†æµç¨‹</span></span><br><span class="line">[pure <span class="keyword">virtual</span>] <span class="function"><span class="type">void</span> <span class="title">QRunnable::run</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‚æ•°è®¾ç½®ä¸º true: è¿™ä¸ªä»»åŠ¡å¯¹è±¡åœ¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¸­å¤„ç†å®Œæ¯•, è¿™ä¸ªä»»åŠ¡å¯¹è±¡å°±ä¼šè‡ªåŠ¨é”€æ¯</span></span><br><span class="line"><span class="comment">// å‚æ•°è®¾ç½®ä¸º false: è¿™ä¸ªä»»åŠ¡å¯¹è±¡åœ¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¸­å¤„ç†å®Œæ¯•, å¯¹è±¡éœ€è¦ç¨‹åºçŒ¿æ‰‹åŠ¨é”€æ¯</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QRunnable::setAutoDelete</span><span class="params">(<span class="type">bool</span> autoDelete)</span></span>;</span><br><span class="line"><span class="comment">// è·å–å½“å‰ä»»åŠ¡å¯¹è±¡çš„ææ„æ–¹å¼,è¿”å›true-&gt;è‡ªåŠ¨ææ„, è¿”å›false-&gt;æ‰‹åŠ¨ææ„</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QRunnable::autoDelete</span><span class="params">()</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼šåˆ›å»ºä¸€ä¸ªè¦æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡ç±»ï¼Œå¤„ç†æ–¹å¼å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyWork</span> : <span class="keyword">public</span> QObject, <span class="keyword">public</span> QRunnable</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyWork</span><span class="params">(QObject *parent = <span class="literal">nullptr</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// ä»»åŠ¡æ‰§è¡Œå®Œæ¯•,è¯¥å¯¹è±¡è‡ªåŠ¨é”€æ¯</span></span><br><span class="line">        <span class="built_in">setAutoDelete</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">MyWork</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> <span class="keyword">override</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ MyWork ç±»æ˜¯ä¸€ä¸ªå¤šé‡ç»§æ‰¿ï¼Œå¦‚æœéœ€è¦åœ¨è¿™ä¸ªä»»åŠ¡ä¸­ä½¿ç”¨ Qt çš„ä¿¡å·æ§½æœºåˆ¶è¿›è¡Œæ•°æ®çš„ä¼ é€’å°±å¿…é¡»ç»§æ‰¿ QObject è¿™ä¸ªç±»ï¼Œå¦‚æœä¸ä½¿ç”¨ä¿¡å·æ§½ä¼ é€’æ•°æ®å°±å¯ä»¥ä¸ç»§æ‰¿äº†ï¼Œåªç»§æ‰¿ QRunnable å³å¯ã€‚</strong></p><h4 id="2-3-QThreadPool"><a href="#2-3-QThreadPool" class="headerlink" title="2.3 QThreadPool"></a><font color="FF0000">2.3 QThreadPool</font></h4><p>Qt ä¸­çš„ QThreadPool ç±»ç®¡ç†äº†ä¸€ç»„ QThreads, é‡Œè¾¹è¿˜ç»´æŠ¤äº†ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ã€‚QThreadPool ç®¡ç†å’Œå›æ”¶å„ä¸ª QThread å¯¹è±¡ï¼Œä»¥å¸®åŠ©å‡å°‘ä½¿ç”¨çº¿ç¨‹çš„ç¨‹åºä¸­çš„çº¿ç¨‹åˆ›å»ºæˆæœ¬ã€‚æ¯ä¸ªQtåº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ªå…¨å±€ QThreadPool å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ globalInstance() æ¥è®¿é—®å®ƒã€‚ä¹Ÿå¯ä»¥å•ç‹¬åˆ›å»ºä¸€ä¸ª QThreadPool å¯¹è±¡ä½¿ç”¨ã€‚</p><p>çº¿ç¨‹æ± å¸¸ç”¨çš„ API å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å’Œè®¾ç½®çº¿ç¨‹ä¸­çš„æœ€å¤§çº¿ç¨‹ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maxThreadCount</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMaxThreadCount</span><span class="params">(<span class="type">int</span> maxThreadCount)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™çº¿ç¨‹æ± æ·»åŠ ä»»åŠ¡, ä»»åŠ¡æ˜¯ä¸€ä¸ª QRunnable ç±»å‹çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">// å¦‚æœçº¿ç¨‹æ± ä¸­æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹äº†, ä»»åŠ¡ä¼šæ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­, ç­‰å¾…çº¿ç¨‹å¤„ç†</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QThreadPool::start</span><span class="params">(QRunnable * runnable, <span class="type">int</span> priority = <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="comment">// å¦‚æœçº¿ç¨‹æ± ä¸­æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹äº†, ç›´æ¥è¿”å›å€¼, ä»»åŠ¡æ·»åŠ å¤±è´¥, ä»»åŠ¡ä¸ä¼šæ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QThreadPool::tryStart</span><span class="params">(QRunnable * runnable)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹æ± ä¸­è¢«æ¿€æ´»çš„çº¿ç¨‹çš„ä¸ªæ•°(æ­£åœ¨å·¥ä½œçš„çº¿ç¨‹ä¸ªæ•°)</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">QThreadPool::activeThreadCount</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°è¯•æ€§çš„å°†æŸä¸€ä¸ªä»»åŠ¡ä»çº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­åˆ é™¤, å¦‚æœä»»åŠ¡å·²ç»å¼€å§‹æ‰§è¡Œå°±æ— æ³•åˆ é™¤äº†</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QThreadPool::tryTake</span><span class="params">(QRunnable *runnable)</span></span>;</span><br><span class="line"><span class="comment">// å°†çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡é˜Ÿåˆ—é‡Œè¾¹æ²¡æœ‰å¼€å§‹å¤„ç†çš„æ‰€æœ‰ä»»åŠ¡åˆ é™¤, å¦‚æœå·²ç»å¼€å§‹å¤„ç†äº†å°±æ— æ³•é€šè¿‡è¯¥å‡½æ•°åˆ é™¤äº†</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QThreadPool::clear</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æ¯ä¸ªQtåº”ç”¨ç¨‹åºä¸­éƒ½æœ‰ä¸€ä¸ªå…¨å±€çš„çº¿ç¨‹æ± å¯¹è±¡, é€šè¿‡è¿™ä¸ªå‡½æ•°ç›´æ¥è®¿é—®è¿™ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="type">static</span> QThreadPool * <span class="title">QThreadPool::globalInstance</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨ Qt ç¨‹åºä¸­åˆ›å»ºçº¿ç¨‹æ± å¯¹è±¡ï¼Œç›´æ¥ä½¿ç”¨ Qt ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºæä¾›çš„çº¿ç¨‹æ± å…¨å±€å¯¹è±¡å³å¯ã€‚å¾—åˆ°çº¿ç¨‹æ± å¯¹è±¡ä¹‹åï¼Œè°ƒç”¨ start() æ–¹æ³•å°±å¯ä»¥å°†ä¸€ä¸ªä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ï¼Œè¿™ä¸ªä»»åŠ¡å°±å¯ä»¥è¢«çº¿ç¨‹æ± å†…éƒ¨çš„çº¿ç¨‹æ± å¤„ç†æ‰äº†ï¼Œä½¿ç”¨çº¿ç¨‹æ± æ¯”è‡ªå·±åˆ›å»ºçº¿ç¨‹çš„è¿™ç§å¤šç§å¤šçº¿ç¨‹æ–¹å¼æ›´åŠ ç®€å•å’Œæ˜“äºç»´æŠ¤ã€‚</p><p><strong>å…·ä½“çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</strong></p><ul><li><strong>mywork.h</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyWork</span> :<span class="keyword">public</span> QRunnable</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyWork</span><span class="params">()</span></span>;</span><br><span class="line">    ~<span class="built_in">MyWork</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>mywork.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MyWork::<span class="built_in">MyWork</span>() : <span class="built_in">QRunnable</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä»»åŠ¡æ‰§è¡Œå®Œæ¯•,è¯¥å¯¹è±¡è‡ªåŠ¨é”€æ¯</span></span><br><span class="line">    <span class="built_in">setAutoDelete</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MyWork::run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä¸šåŠ¡å¤„ç†ä»£ç </span></span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>mainwindow.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent) :</span><br><span class="line">    <span class="built_in">QMainWindow</span>(parent),</span><br><span class="line">    <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çº¿ç¨‹æ± åˆå§‹åŒ–ï¼Œè®¾ç½®æœ€å¤§çº¿ç¨‹æ± æ•°</span></span><br><span class="line">    QThreadPool::<span class="built_in">globalInstance</span>()-&gt;<span class="built_in">setMaxThreadCount</span>(<span class="number">4</span>);</span><br><span class="line">    <span class="comment">// æ·»åŠ ä»»åŠ¡</span></span><br><span class="line">    MyWork* task = <span class="keyword">new</span> MyWork;</span><br><span class="line">    QThreadPool::<span class="built_in">globalInstance</span>()-&gt;<span class="built_in">start</span>(task);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±æ­¤çœ‹è§ï¼Œçº¿ç¨‹æ± çš„æ“ä½œå’ŒQThreadçš„runé‡å†™ç±»ä¼¼ã€‚<strong>ä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥æœ€å¤§é™åº¦çš„åˆ©ç”¨çº¿ç¨‹ï¼Œå‡å°‘èµ„æºçš„æµªè´¹</strong></p><p><strong>æ¯”å¦‚æˆ‘ä»¬éœ€è¦åŒæ—¶å¤„ç†ä¸‰ä¸ªäº‹ä»¶</strong>ï¼šç”Ÿæˆéšæœºæ•°ï¼Œå†’æ³¡æ’åºï¼Œå¿«é€Ÿæ’åºï¼ˆå…ˆç”Ÿæˆéšæœºæ•°ï¼Œç„¶åå†å¯¹å…¶åŒæ—¶è¿›è¡Œå†’æ³¡æ’åºå’Œå¿«é€Ÿæ’åºï¼‰</p><p>ç”¨QThreadçš„runé‡å†™çš„è¯ï¼Œéœ€è¦å¼€å¯ä¸‰ä¸ªçº¿ç¨‹ã€‚</p><p>ä½†æ˜¯ç”¨çº¿ç¨‹æ± çš„è¯ï¼Œå®ƒå¯ä»¥æ ¹æ®äº‹ä»¶çš„é•¿çŸ­ï¼Œï¼ˆå°†ç”Ÿæˆéšæœºæ•°å’Œå†’æ³¡æ’åºæ”¾åœ¨åŒä¸€ä¸ªçº¿ç¨‹å»å¤„ç†ï¼‰åªéœ€è¦å¼€å¯ä¸¤ä¸ªçº¿ç¨‹å³å¯ã€‚</p><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt04å¤šçº¿ç¨‹</title>
      <link href="/2025/03/13/Qt04%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
      <url>/2025/03/13/Qt04%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€ã€çŸ¥è¯†å›é¡¾"><a href="#ä¸€ã€çŸ¥è¯†å›é¡¾" class="headerlink" title="ä¸€ã€çŸ¥è¯†å›é¡¾"></a><font color="FF0000">ä¸€ã€çŸ¥è¯†å›é¡¾</font></h3><p><strong>1ï¼Œä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹ï¼Ÿ</strong></p><ul><li><font color="FF0000">ä»è®¡ç®—æœºåº•å±‚æ¥è¯´</font>ï¼š çº¿ç¨‹å¯ä»¥æ¯”ä½œæ˜¯è½»é‡çº§çš„è¿›ç¨‹ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½,çº¿ç¨‹é—´çš„åˆ‡æ¢å’Œè°ƒåº¦çš„æˆæœ¬è¿œè¿œå°äºè¿›ç¨‹ã€‚å¦å¤–ï¼Œå¤šæ ¸ CPU æ—¶ä»£æ„å‘³ç€å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¿è¡Œï¼Œè¿™å‡å°‘äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚ </li><li><font color="FF0000">ä»å½“ä»£äº’è”ç½‘å‘å±•è¶‹åŠ¿æ¥è¯´</font><strong>ï¼š</strong> ç°åœ¨çš„ç³»ç»ŸåŠ¨ä¸åŠ¨å°±è¦æ±‚ç™¾ä¸‡çº§ç”šè‡³åƒä¸‡çº§çš„å¹¶å‘é‡ï¼Œè€Œå¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹æ­£æ˜¯å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿçš„åŸºç¡€ï¼Œåˆ©ç”¨å¥½å¤šçº¿ç¨‹æœºåˆ¶å¯ä»¥å¤§å¤§æé«˜ç³»ç»Ÿæ•´ä½“çš„å¹¶å‘èƒ½åŠ›ä»¥åŠæ€§èƒ½ã€‚</li></ul><p>å†æ·±å…¥åˆ°è®¡ç®—æœºåº•å±‚æ¥æ¢è®¨ï¼š</p><ul><li><font color="FF0000">å•æ ¸æ—¶ä»£</font>ï¼šåœ¨å•æ ¸æ—¶ä»£å¤šçº¿ç¨‹ä¸»è¦æ˜¯ä¸ºäº†æé«˜ CPU å’Œ IO è®¾å¤‡çš„ç»¼åˆåˆ©ç”¨ç‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå½“åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ä¼šå¯¼è‡´ CPU è®¡ç®—æ—¶ï¼ŒIO è®¾å¤‡ç©ºé—²ï¼›è¿›è¡Œ IO æ“ä½œæ—¶ï¼ŒCPU ç©ºé—²ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°è¯´è¿™ä¸¤è€…çš„åˆ©ç”¨ç‡ç›®å‰éƒ½æ˜¯ 50%å·¦å³ã€‚ä½†æ˜¯å½“æœ‰ä¸¤ä¸ªçº¿ç¨‹çš„æ—¶å€™å°±ä¸ä¸€æ ·äº†ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ CPU è®¡ç®—æ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¿›è¡Œ IO æ“ä½œï¼Œè¿™æ ·ä¸¤ä¸ªçš„åˆ©ç”¨ç‡å°±å¯ä»¥åœ¨ç†æƒ³æƒ…å†µä¸‹è¾¾åˆ° 100%äº†ã€‚ </li><li><font color="FF0000">å¤šæ ¸æ—¶ä»£</font>: å¤šæ ¸æ—¶ä»£å¤šçº¿ç¨‹ä¸»è¦æ˜¯ä¸ºäº†æé«˜ CPU åˆ©ç”¨ç‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡å¦‚æˆ‘ä»¬è¦è®¡ç®—ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬åªç”¨ä¸€ä¸ªçº¿ç¨‹çš„è¯ï¼ŒCPU åªä¼šä¸€ä¸ª CPU æ ¸å¿ƒè¢«åˆ©ç”¨åˆ°ï¼Œè€Œåˆ›å»ºå¤šä¸ªçº¿ç¨‹å°±å¯ä»¥è®©å¤šä¸ª CPU æ ¸å¿ƒè¢«åˆ©ç”¨åˆ°ï¼Œè¿™æ ·å°±æé«˜äº† CPU çš„åˆ©ç”¨ç‡ã€‚</li></ul><p><strong>2ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼š</strong></p><p>è¿›ç¨‹ï¼šä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œè¦å’Œå…¶ä»–è¿›ç¨‹é€šä¿¡ï¼Œéœ€è¦ä½¿ç”¨è¿›ç¨‹é€šä¿¡çš„æœºåˆ¶ã€‚</p><p>çº¿ç¨‹ï¼šæ²¡æœ‰è‡ªå·±çš„èµ„æºï¼Œéƒ½æ˜¯å…±äº«è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå¤šä¸ªçº¿ç¨‹é€šä¿¡å­˜åœ¨éšæ‚£ã€‚</p><p>PSï¼šåœ¨æ“ä½œç³»ç»Ÿæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œçº¿ç¨‹çš„å¼€é”€è¿œå°äºè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ã€‚ï¼ˆå› æ­¤æˆ‘ä»¬å¸¸ç”¨å¤šçº¿ç¨‹å¹¶å‘ï¼Œè€Œéå¤šè¿›ç¨‹å¹¶å‘ï¼‰</p><p>ä¸ºäº†æ›´å®¹æ˜“ç†è§£å¤šçº¿ç¨‹çš„ä½œç”¨ï¼Œå…ˆçœ‹ä¸€ä¸ªå®ä¾‹ï¼š</p><p>åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œä¸€ä¸ª10sè€—æ—¶çš„æ“ä½œã€‚ï¼ˆé€šè¿‡æŒ‰é’®æ¥è§¦å‘ï¼‰</p><p><img src="https://bu.dusays.com/2025/03/13/67d28d3da16f3.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line">Threadtest::<span class="built_in">Threadtest</span>(QWidget* parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">connect</span>(ui.btn_start, &amp;QPushButton::clicked, <span class="keyword">this</span>,  </span><br><span class="line">            &amp;Threadtest::on_pushButton_clicked);</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Threadtest::on_pushButton_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QThread::<span class="built_in">sleep</span>(<span class="number">10</span>);<span class="comment">//ä¸»çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªçº¿ç¨‹éƒ½åœ¨å“åº”10ç§’çš„è€—æ—¶æ“ä½œï¼Œå¯¹äºçº¿ç¨‹çš„æ¶ˆæ¯å¾ªç¯exec()å‡½æ•°å°±æœªå“åº”äº†ï¼ˆå°±æ˜¯ä½ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ‹–åŠ¨ç•Œé¢æ˜¯æ— ååº”çš„ï¼‰</p><p><img src="https://bu.dusays.com/2025/03/13/67d28db830489.png"></p><h3 id="äºŒã€çº¿ç¨‹ç±»QThread"><a href="#äºŒã€çº¿ç¨‹ç±»QThread" class="headerlink" title="äºŒã€çº¿ç¨‹ç±»QThread"></a><font color="FF0000">äºŒã€çº¿ç¨‹ç±»QThread</font></h3><p>Qt ä¸­æä¾›äº†ä¸€ä¸ªçº¿ç¨‹ç±»ï¼Œé€šè¿‡è¿™ä¸ªç±»å°±å¯ä»¥åˆ›å»ºå­çº¿ç¨‹äº†ï¼ŒQt ä¸­ä¸€å…±æä¾›äº†ä¸¤ç§åˆ›å»ºå­çº¿ç¨‹çš„æ–¹å¼ï¼Œåè¾¹ä¼šä¾æ¬¡ä»‹ç»å…¶ä½¿ç”¨æ–¹å¼ã€‚å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç±»ä¸­æä¾›çš„ä¸€äº›å¸¸ç”¨ API å‡½æ•°ï¼š</p><ul><li><strong>2.1 å¸¸ç”¨å…±ç”¨æˆå‘˜å‡½æ•°</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// QThread ç±»å¸¸ç”¨ API</span></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">QThread::<span class="built_in">QThread</span>(QObject *parent = Q_NULLPTR);</span><br><span class="line"><span class="comment">// åˆ¤æ–­çº¿ç¨‹ä¸­çš„ä»»åŠ¡æ˜¯ä¸æ˜¯å¤„ç†å®Œæ¯•äº†</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QThread::isFinished</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="comment">// åˆ¤æ–­å­çº¿ç¨‹æ˜¯ä¸æ˜¯åœ¨æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QThread::isRunning</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Qtä¸­çš„çº¿ç¨‹å¯ä»¥è®¾ç½®ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="comment">// å¾—åˆ°å½“å‰çº¿ç¨‹çš„ä¼˜å…ˆçº§</span></span><br><span class="line"><span class="function">Priority <span class="title">QThread::priority</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QThread::setPriority</span><span class="params">(Priority priority)</span></span>;</span><br><span class="line">ä¼˜å…ˆçº§:</span><br><span class="line">    QThread::IdlePriority        --&gt; æœ€ä½çš„ä¼˜å…ˆçº§</span><br><span class="line">    QThread::LowestPriority</span><br><span class="line">    QThread::LowPriority</span><br><span class="line">    QThread::NormalPriority</span><br><span class="line">    QThread::HighPriority</span><br><span class="line">    QThread::HighestPriority</span><br><span class="line">    QThread::TimeCriticalPriority</span><br><span class="line">    QThread::InheritPriority    --&gt; æœ€é«˜çš„ä¼˜å…ˆçº§, é»˜è®¤æ˜¯è¿™ä¸ª</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€€å‡ºçº¿ç¨‹, åœæ­¢åº•å±‚çš„äº‹ä»¶å¾ªç¯</span></span><br><span class="line"><span class="comment">// é€€å‡ºçº¿ç¨‹çš„å·¥ä½œå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">QThread::exit</span><span class="params">(<span class="type">int</span> returnCode = <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="comment">// è°ƒç”¨çº¿ç¨‹é€€å‡ºå‡½æ•°ä¹‹å, çº¿ç¨‹ä¸ä¼šé©¬ä¸Šé€€å‡ºå› ä¸ºå½“å‰ä»»åŠ¡æœ‰å¯èƒ½è¿˜æ²¡æœ‰å®Œæˆ, è°ƒå›ç”¨è¿™ä¸ªå‡½æ•°æ˜¯</span></span><br><span class="line"><span class="comment">// ç­‰å¾…ä»»åŠ¡å®Œæˆ, ç„¶åé€€å‡ºçº¿ç¨‹, ä¸€èˆ¬æƒ…å†µä¸‹ä¼šåœ¨ exit() åè¾¹è°ƒç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">QThread::wait</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> time = ULONG_MAX)</span></span>;</span><br></pre></td></tr></table></figure><ul><li><strong>2.2 ä¿¡å·æ§½</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å’Œè°ƒç”¨ exit() æ•ˆæœæ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="comment">// è°ƒç”¨è¿™ä¸ªå‡½æ•°ä¹‹å, å†è°ƒç”¨ wait() å‡½æ•°</span></span><br><span class="line">[slot] <span class="function"><span class="type">void</span> <span class="title">QThread::quit</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// å¯åŠ¨å­çº¿ç¨‹</span></span><br><span class="line">[slot] <span class="function"><span class="type">void</span> <span class="title">QThread::start</span><span class="params">(Priority priority = InheritPriority)</span></span>;</span><br><span class="line"><span class="comment">// çº¿ç¨‹é€€å‡º, å¯èƒ½æ˜¯ä¼šé©¬ä¸Šç»ˆæ­¢çº¿ç¨‹, ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä½¿ç”¨è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">[slot] <span class="function"><span class="type">void</span> <span class="title">QThread::terminate</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»»åŠ¡å®Œæˆäº†, å‘å‡ºè¯¥ä¿¡å·</span></span><br><span class="line"><span class="comment">// ä»»åŠ¡å‡½æ•°ä¸­çš„å¤„ç†é€»è¾‘æ‰§è¡Œå®Œæ¯•äº†</span></span><br><span class="line">[signal] <span class="function"><span class="type">void</span> <span class="title">QThread::finished</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// å¼€å§‹å·¥ä½œä¹‹å‰å‘å‡ºè¿™ä¸ªä¿¡å·, ä¸€èˆ¬ä¸ä½¿ç”¨</span></span><br><span class="line">[signal] <span class="function"><span class="type">void</span> <span class="title">QThread::started</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><ul><li><strong>2.3é™æ€å‡½æ•°</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿”å›ä¸€ä¸ªæŒ‡å‘ç®¡ç†å½“å‰æ‰§è¡Œçº¿ç¨‹çš„QThreadçš„æŒ‡é’ˆ</span></span><br><span class="line">[<span class="type">static</span>] <span class="function">QThread *<span class="title">QThread::currentThread</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// è¿”å›å¯ä»¥åœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„ç†æƒ³çº¿ç¨‹æ•° == å’Œå½“å‰ç”µè„‘çš„ CPU æ ¸å¿ƒæ•°ç›¸åŒ</span></span><br><span class="line">[<span class="type">static</span>] <span class="function"><span class="type">int</span> <span class="title">QThread::idealThreadCount</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// çº¿ç¨‹ä¼‘çœ å‡½æ•°</span></span><br><span class="line">[<span class="type">static</span>] <span class="function"><span class="type">void</span> <span class="title">QThread::msleep</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> msecs)</span></span>;    <span class="comment">// å•ä½: æ¯«ç§’</span></span><br><span class="line">[<span class="type">static</span>] <span class="function"><span class="type">void</span> <span class="title">QThread::sleep</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> secs)</span></span>;    <span class="comment">// å•ä½: ç§’</span></span><br><span class="line">[<span class="type">static</span>] <span class="function"><span class="type">void</span> <span class="title">QThread::usleep</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> usecs)</span></span>;    <span class="comment">// å•ä½: å¾®ç§’</span></span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€Qtä¸­å®ç°å¤šçº¿ç¨‹çš„ä¸¤ç§æ–¹æ³•"><a href="#ä¸‰ã€Qtä¸­å®ç°å¤šçº¿ç¨‹çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="ä¸‰ã€Qtä¸­å®ç°å¤šçº¿ç¨‹çš„ä¸¤ç§æ–¹æ³•"></a><font color="FF0000">ä¸‰ã€Qtä¸­å®ç°å¤šçº¿ç¨‹çš„ä¸¤ç§æ–¹æ³•</font></h3><p><strong>ğŸ§¡ğŸ§¡3.1.æ´¾ç”ŸQThreadç±»å¯¹è±¡çš„æ–¹æ³•ï¼ˆé‡å†™Runå‡½æ•°ï¼‰</strong></p><p>é¦–å…ˆï¼Œä»¥æ–‡å­—å½¢å¼æ¥è¯´æ˜éœ€è¦å“ªå‡ ä¸ªæ­¥éª¤ã€‚</p><ol><li>è‡ªå®šä¹‰ä¸€ä¸ªè‡ªå·±çš„ç±»ï¼Œä½¿å…¶ç»§æ‰¿è‡ªQThreadç±»ï¼›</li><li>åœ¨è‡ªå®šä¹‰ç±»ä¸­è¦†å†™QThreadç±»ä¸­çš„è™šå‡½æ•°run()ã€‚</li></ol><p>è¿™å¾ˆå¯èƒ½å°±æ˜¯C++ä¸­å¤šæ€çš„ä½¿ç”¨ã€‚è¡¥å……ä¸€ç‚¹ï¼šQThreadç±»ç»§æ‰¿è‡ªQObjectç±»ã€‚</p><p>è¿™é‡Œè¦é‡ç‚¹è¯´ä¸€ä¸‹run()å‡½æ•°äº†ã€‚å®ƒä½œä¸ºçº¿ç¨‹çš„å…¥å£ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä»run()å¼€å§‹æ‰§è¡Œï¼Œæˆ‘ä»¬æ‰“ç®—åœ¨çº¿ç¨‹ä¸­å®Œæˆçš„å·¥ä½œéƒ½è¦å†™åœ¨run()å‡½æ•°ä¸­ï¼Œä¸ªäººè®¤ä¸ºå¯ä»¥æŠŠrun()å‡½æ•°ç†è§£ä¸ºçº¿ç¨‹å‡½æ•°ã€‚è¿™ä¹Ÿå°±æ˜¯å­ç±»è¦†å†™åŸºç±»çš„è™šå‡½æ•°ï¼ŒåŸºç±»QThreadçš„run()å‡½æ•°åªæ˜¯ç®€å•å¯åŠ¨exec()æ¶ˆæ¯å¾ªç¯ï¼Œå…³äºè¿™ä¸ªexec()åé¢æœ‰å¾ˆå¤šä¸œè¥¿è¦è®²ï¼Œè¯·åšå¥½å‡†å¤‡ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬å°±æ¥å°è¯•ç”¨å¤šçº¿ç¨‹å®ç°10sè€—æ—¶çš„æ“ä½œï¼šï¼ˆç”¨æŒ‰é’®è§¦å‘)</p><ul><li><strong>1ï¸âƒ£åœ¨ç¼–è¾‘å¥½uiç•Œé¢åï¼Œå…ˆåˆ›å»ºä¸€ä¸ªworkThreadçš„ç±»ã€‚ï¼ˆç»§æ‰¿è‡ªQThreadç±»)</strong></li></ul><p><img src="https://bu.dusays.com/2025/03/13/67d2986e707f0.png"></p><ul><li>2ï¸âƒ£<strong>åœ¨workThread1çš„ç±»ä¸­é‡å†™runå‡½æ•°</strong></li></ul><p>åœ¨workThread.hçš„å£°æ˜runå‡½æ•°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;qthread.h&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">workThread</span> : <span class="keyword">public</span> QThread</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨workThread.cppä¸­é‡å†™runå‡½æ•°(å¹¶æ‰“å°å­çº¿ç¨‹çš„ID)ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;workThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line">workThread::<span class="built_in">workThread</span>(QObject* parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é‡å†™runå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">workThread::run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å½“å‰å­çº¿ç¨‹ID:&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;å¼€å§‹æ‰§è¡Œçº¿ç¨‹&quot;</span>;</span><br><span class="line">    QThread::<span class="built_in">sleep</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;çº¿ç¨‹ç»“æŸ&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>3ï¸âƒ£åœ¨ä¸»ç±»ä¸­å¯åŠ¨çº¿ç¨‹</strong></li></ul><p>threadtest.hä¸­å£°æ˜çº¿ç¨‹å’ŒæŒ‰é’®äº‹ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QMainWindow&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;workThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> execution_character_set(<span class="string">&quot;utf-8&quot;</span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Threadtest</span> : <span class="keyword">public</span> QMainWindow</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Threadtest</span>(QWidget *parent = Q_NULLPTR);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::ThreadtestClass ui;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">btn_clicked</span><span class="params">()</span></span>;</span><br><span class="line">workThread* thread;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>threadtest.cppä¸­å®ç°ï¼Œå¹¶å¯åŠ¨å­çº¿ç¨‹çº¿ç¨‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Threadtest::<span class="built_in">Threadtest</span>(QWidget* parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">connect</span>(ui.btn_start, &amp;QPushButton::clicked, <span class="keyword">this</span>, &amp;Threadtest::btn_clicked);</span><br><span class="line">   thread = <span class="keyword">new</span> <span class="built_in">workThread</span>(<span class="keyword">this</span>);  </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Threadtest::btn_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;ä¸»çº¿ç¨‹idï¼š&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    thread-&gt;<span class="built_in">start</span>();<span class="comment">//å¯åŠ¨å­çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å®ç°ï¼Œåœ¨æ‰§è¡Œè€—æ—¶æ“ä½œæ—¶ä¹Ÿå¯æ‹–åŠ¨ç•Œé¢ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d28d3da16f3.png"></p><p><img src="https://bu.dusays.com/2025/03/13/67d298c015337.png"></p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p><p><strong>åœ¨ä¸»ç¨‹åºä¸­æ·»åŠ workThreadç±»çš„å¤´æ–‡ä»¶æ—¶ï¼Œéœ€è¦å°†workThread.hæ”¾åœ¨threadtest.hä¸­ï¼ˆä¸ç„¶ä¼šæŠ¥é”™ï¼ï¼ï¼ï¼ï¼‰</strong></p><p><img src="https://bu.dusays.com/2025/03/13/67d298dace251.png"></p><p>ä½¿ç”¨QThread::currentThreadId()æ¥æŸ¥çœ‹å½“å‰çº¿ç¨‹çš„IDï¼Œæ— è®ºæ˜¯å­çº¿ç¨‹è¿˜æ˜¯ä¸»çº¿ç¨‹ï¼Œä¸åŒçº¿ç¨‹å…¶IDæ˜¯ä¸åŒçš„ã€‚æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œå› æ­¤å¯ä»¥ä¸ç»è¿‡å¯¹è±¡æ¥è°ƒç”¨ã€‚</p><p><strong>åˆ›å»ºçš„workThread1ç±»çš„æ‰§è¡Œå®é™…ä¸Šæ˜¯åœ¨ä¸»çº¿ç¨‹é‡Œçš„ï¼Œåªæœ‰runå‡½æ•°å†…çš„ç¨‹åºæ‰ä¼šåœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œï¼ï¼ˆå³QThreadåªæ˜¯çº¿ç¨‹çš„ç®¡ç†ç±»ï¼Œåªæœ‰run()æ‰æ˜¯æˆ‘ä»¬çš„çº¿ç¨‹å‡½æ•°ï¼‰</strong></p><p>å› æ­¤åœ¨QThreadï¼ˆå³åˆ›å»ºçš„ç±»ï¼‰ä¸­çš„æˆå‘˜å˜é‡å±äºä¸»çº¿ç¨‹ï¼Œåœ¨è®¿é—®å‰éœ€è¦åˆ¤æ–­è®¿é—®æ˜¯å¦å®‰å…¨ã€‚runï¼ˆï¼‰ä¸­åˆ›å»ºçš„å˜é‡å±äºå­çº¿ç¨‹ã€‚</p><p>çº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜æ˜¯ä¸å®‰å…¨çš„ï¼ˆç”±äºå¤šçº¿ç¨‹äº‰å¤ºèµ„æºä¼šå½±å“æ•°æ®å®‰å…¨é—®é¢˜ï¼‰ï¼Œè§£å†³çš„åŠæ³•å°±æ˜¯è¦ä¸Šé”ã€‚</p><p><strong><p align = "center">å…³äºäº’æ–¥é”</p></strong></p><p>ä¸ªäººè®¤ä¸ºï¼Œexec()è¿™ä¸ªç‚¹å¤ªé‡è¦äº†ï¼ŒåŒæ—¶è¿˜ä¸å¤ªå®¹æ˜“ç†è§£ã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„ä»£ç ä¸­æœ‰ä¸¤ä¸ªexec()ï¼Œæˆ‘ä»¬è®²â€œä¸€å±±ä¸å®¹äºŒè™â€ï¼Œæ”¾åœ¨è¿™é‡Œå°±æ˜¯è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸­ä¸èƒ½åŒæ—¶è¿è¡Œä¸¤ä¸ªexec()ï¼Œå¦åˆ™å°±ä¼šé€ æˆå¦ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯å¾—ä¸åˆ°æ¶ˆæ¯ã€‚åƒQDialogæ¨¡æ€çª—å£ä¸­çš„exec()å°±æ˜¯å› ä¸ºåœ¨ä¸»çº¿ç¨‹ä¸­åŒæ—¶å¼€äº†ä¸¤ä¸ªexec()ï¼Œå¯¼è‡´ä¸»çª—å£çš„exec()æ¥æ”¶ä¸åˆ°ç”¨æˆ·çš„æ¶ˆæ¯äº†ã€‚ä½†æ˜¯ï¼ä½†æ˜¯ï¼ä½†æ˜¯ï¼æˆ‘ä»¬è¿™é‡Œå´æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰å‡ºç°åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¸€ä¸ªæ˜¯ä¸»çº¿ç¨‹ä¸­çš„exec()ï¼Œä¸€ä¸ªæ˜¯å­çº¿ç¨‹ä¸­çš„exec()ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyThread</span>:<span class="keyword">public</span> QThread</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;child thread begin&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;child thread&quot;</span>&lt;&lt;QThread::<span class="built_in">currentThreadId</span>()&lt;&lt;endl;</span><br><span class="line">            QThread::<span class="built_in">sleep</span>(<span class="number">5</span>);</span><br><span class="line">            <span class="built_in">qDebugu</span>()&lt;&lt;<span class="string">&quot;QThread end&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">exec</span>();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span> ** argv)</span> <span class="comment">//mian()ä½œä¸ºä¸»çº¿ç¨‹</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">app</span><span class="params">(argc,argv)</span></span>;</span><br><span class="line"> </span><br><span class="line">    MyThread thread; <span class="comment">//åˆ›å»ºä¸€ä¸ªQThreadæ´¾ç”Ÿç±»å¯¹è±¡å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    thread.<span class="built_in">start</span>(); <span class="comment">//å¯åŠ¨å­çº¿ç¨‹ï¼Œç„¶åä¼šè‡ªåŠ¨è°ƒç”¨çº¿ç¨‹å‡½æ•°run()</span></span><br><span class="line"> </span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;main thread&quot;</span>&lt;&lt;QThread::<span class="built_in">currentThreadId</span>()&lt;&lt;endl;</span><br><span class="line">    QThread::<span class="built_in">sleep</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">qDebugu</span>()&lt;&lt;<span class="string">&quot;main thread&quot;</span>&lt;&lt;QThread::<span class="built_in">currentThreadId</span>()&lt;&lt;endl;</span><br><span class="line"> </span><br><span class="line">    thread.<span class="built_in">quit</span>(); <span class="comment">//ä½¿ç”¨quit()æˆ–è€…exit()ä½¿å¾—å­çº¿ç¨‹èƒ½å¤Ÿé€€å‡ºæ¶ˆæ¯å¾ªç¯ï¼Œè€Œä¸è‡³äºé™·åœ¨å­çº¿ç¨‹ä¸­</span></span><br><span class="line">    thread.<span class="built_in">wait</span>(); <span class="comment">//ç­‰å¾…å­çº¿ç¨‹é€€å‡ºï¼Œç„¶åå›æ”¶èµ„æº</span></span><br><span class="line">                   <span class="comment">//thread.wait(5000); //è®¾å®šç­‰å¾…çš„æ—¶é—´</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> app.<span class="built_in">exec</span>();    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœrun()å‡½æ•°ä¸­æ²¡æœ‰æ‰§è¡Œexec()æ¶ˆæ¯å¾ªç¯å‡½æ•°ï¼Œé‚£ä¹ˆrun()æ‰§è¡Œå®Œäº†ä¹Ÿå°±æ„å‘³ç€å­çº¿ç¨‹é€€å‡ºäº†ã€‚ä¸€èˆ¬åœ¨å­çº¿ç¨‹é€€å‡ºçš„æ—¶å€™éœ€è¦ä¸»çº¿ç¨‹å»å›æ”¶èµ„æºï¼Œå¯ä»¥è°ƒç”¨QThreadçš„wait()ï¼Œä½¿ä¸»çº¿ç¨‹ç­‰å¾…å­çº¿ç¨‹é€€å‡ºï¼Œç„¶åå›æ”¶èµ„æºã€‚è¿™é‡Œwait()æ˜¯ä¸€ä¸ªé˜»å¡å‡½æ•°ï¼Œæœ‰ç‚¹åƒC++11ä¸­çš„join()å‡½æ•°ã€‚</p><p>ä½†æ˜¯ï¼ä½†æ˜¯ï¼ä½†æ˜¯ï¼run()å‡½æ•°ä¸­è°ƒç”¨äº†exec()å‡½æ•°ï¼Œexec()æ˜¯ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ï¼Œä¹Ÿå¯ä»¥å«åšäº‹ä»¶å¾ªç¯ï¼Œä¹Ÿæ˜¯ä¼šé˜»å¡çš„ï¼Œç›¸å½“äºä¸€ä¸ªæ­»å¾ªç¯ä½¿å­çº¿ç¨‹å¡åœ¨è¿™é‡Œæ°¸ä¸é€€å‡ºï¼Œå¿…é¡»è°ƒç”¨QThreadçš„quit()å‡½æ•°æˆ–è€…exit()å‡½æ•°æ‰å¯ä»¥ä½¿å­çº¿ç¨‹é€€å‡ºæ¶ˆæ¯å¾ªç¯ï¼Œå¹¶ä¸”æœ‰æ—¶è¿˜ä¸æ˜¯é©¬ä¸Šå°±é€€å‡ºï¼Œéœ€è¦ç­‰åˆ°CPUçš„æ§åˆ¶æƒäº¤ç»™çº¿ç¨‹çš„exec()ã€‚</p><p>æ‰€ä»¥å…ˆè¦thread.quit();ä½¿é€€å‡ºå­çº¿ç¨‹çš„æ¶ˆæ¯å¾ªç¯ï¼Œ ç„¶åthread.wait();åœ¨ä¸»çº¿ç¨‹ä¸­å›æ”¶å­çº¿ç¨‹çš„èµ„æºã€‚</p><p><strong>å€¼å¾—æ³¨æ„çš„æœ‰ä¸¤ç‚¹</strong>ï¼šå­çº¿ç¨‹çš„exet()æ¶ˆæ¯å¾ªç¯å¿…é¡»åœ¨run()å‡½æ•°ä¸­è°ƒç”¨ï¼›å¦‚æœæ²¡æœ‰æ¶ˆæ¯å¾ªç¯çš„è¯ï¼Œåˆ™æ²¡æœ‰å¿…è¦è°ƒç”¨quit( )æˆ–è€…exit()ï¼Œå› ä¸ºè°ƒç”¨äº†ä¹Ÿä¸ä¼šèµ·ä½œç”¨ã€‚</p><p>ç¬¬ä¸€ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼éœ€è¦åœ¨run()ä¸­æ˜¾å¼è°ƒç”¨exec()ï¼Œä½†æ˜¯exec()æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Œç›®å‰è¿˜çœ‹ä¸å‡ºæ¥ï¼Œéœ€è¦åœ¨ç¬¬äºŒç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼ä¸­æ‰èƒ½çŸ¥é“ã€‚</p><hr><p> <strong>ğŸ’œğŸ’œ3.2.ä½¿ç”¨ä¿¡å·ä¸æ§½æ–¹å¼æ¥å®ç°å¤šçº¿ç¨‹</strong></p><p> åˆšè®²å®Œä½¿ç”¨QThreadæ´¾ç”Ÿç±»å¯¹è±¡çš„æ–¹æ³•åˆ›å»ºçº¿ç¨‹ï¼Œç°åœ¨å°±è¦æ¥è¯´å®ƒä¸€ç‚¹åè¯ã€‚è¿™ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªå±€é™æ€§ï¼Œåªæœ‰ä¸€ä¸ªrun()å‡½æ•°èƒ½å¤Ÿåœ¨çº¿ç¨‹ä¸­å»è¿è¡Œï¼Œä½†æ˜¯å½“æœ‰å¤šä¸ªå‡½æ•°åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œæ—¶ï¼Œå°±æ²¡åŠæ³•äº†ï¼Œè‡³å°‘å®ç°èµ·æ¥å¾ˆéº»çƒ¦ã€‚æ‰€ä»¥ï¼Œå½“å½“å½“å½“ï¼Œä¸‹é¢å°†ä»‹ç»ç¬¬äºŒç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼ï¼š<strong>ä½¿ç”¨ä¿¡å·ä¸æ§½çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠåœ¨çº¿ç¨‹ä¸­æ‰§è¡Œçš„å‡½æ•°ï¼ˆæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºçº¿ç¨‹å‡½æ•°ï¼‰å®šä¹‰ä¸ºä¸€ä¸ªæ§½å‡½æ•°ã€‚</strong></p><p>ä»ç„¶æ˜¯é¦–å…ˆä»¥æ–‡å­—å½¢å¼è¯´æ˜è¿™ç§æ–¹æ³•çš„å‡ ä¸ªæ­¥éª¤ã€‚</p><ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»(mywork)ï¼Œè®©è¿™ä¸ªç±»ä» QObject æ´¾ç”Ÿï¼Œåœ¨è¿™ä¸ªç±»ä¸­æ·»åŠ ä¸€ä¸ªå…¬å…±çš„æˆå‘˜å‡½æ•°(working)ï¼Œå‡½æ•°ä½“å°±æ˜¯æˆ‘ä»¬è¦å­çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyWork</span>:<span class="keyword">public</span> QObject</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    .......</span><br><span class="line">    <span class="comment">// å‡½æ•°åè‡ªå·±æŒ‡å®š, å«ä»€ä¹ˆéƒ½å¯ä»¥, å‚æ•°å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ·»åŠ </span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">working</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ª QThread å¯¹è±¡ï¼Œè¿™å°±æ˜¯å­çº¿ç¨‹çš„å¯¹è±¡</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QThread* sub = <span class="keyword">new</span> QThread;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºå·¥ä½œçš„ç±»å¯¹è±¡ï¼ˆåƒä¸‡ä¸è¦æŒ‡å®šç»™åˆ›å»ºçš„å¯¹è±¡æŒ‡å®šçˆ¶å¯¹è±¡ï¼‰</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyWork* work = <span class="keyword">new</span> <span class="built_in">MyWork</span>(<span class="keyword">this</span>);    <span class="comment">// error</span></span><br><span class="line">MyWork* work = <span class="keyword">new</span> MyWork;          <span class="comment">// ok</span></span><br></pre></td></tr></table></figure><ul><li>å°† MyWork å¯¹è±¡ç§»åŠ¨åˆ°åˆ›å»ºçš„å­çº¿ç¨‹å¯¹è±¡ä¸­ï¼Œéœ€è¦è°ƒç”¨ QObject ç±»æä¾›çš„ moveToThread() æ–¹æ³•</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// void QObject::moveToThread(QThread *targetThread);</span></span><br><span class="line"><span class="comment">// å¦‚æœç»™workæŒ‡å®šäº†çˆ¶å¯¹è±¡, è¿™ä¸ªå‡½æ•°è°ƒç”¨å°±å¤±è´¥äº†</span></span><br><span class="line"><span class="comment">// æç¤ºï¼š QObject::moveToThread: Cannot move objects with a parent</span></span><br><span class="line">work-&gt;<span class="built_in">moveToThread</span>(sub);    <span class="comment">// ç§»åŠ¨åˆ°å­çº¿ç¨‹ä¸­å·¥ä½œ</span></span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨å­çº¿ç¨‹ï¼Œè°ƒç”¨ start(), è¿™æ—¶å€™çº¿ç¨‹å¯åŠ¨äº†ï¼Œä½†æ˜¯ç§»åŠ¨åˆ°çº¿ç¨‹ä¸­çš„å¯¹è±¡å¹¶æ²¡æœ‰å·¥ä½œ</li><li>è°ƒç”¨ MyWork ç±»å¯¹è±¡çš„å·¥ä½œå‡½æ•°ï¼Œè®©è¿™ä¸ªå‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œè¿™æ—¶å€™æ˜¯åœ¨ç§»åŠ¨åˆ°çš„é‚£ä¸ªå­çº¿ç¨‹ä¸­è¿è¡Œçš„</li></ul><p><strong>ä»£ç å®ä¾‹ï¼š</strong></p><ul><li>1ï¸âƒ£<strong>åˆ›å»ºä¸€ä¸ªworkThreadçš„ç±»ã€‚ï¼ˆç»§æ‰¿è‡ªQThreadç±»ï¼‰</strong></li></ul><p>å®šä¹‰æ§½å‡½æ•°ï¼ˆ<strong>å­çº¿ç¨‹æ‰§è¡Œçš„ç¨‹åºéƒ½å¯ä»¥æ”¾åœ¨æ§½å‡½æ•°ä¸­</strong>ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//workThread.cppï¼ˆå…ˆåœ¨workThread.hä¸­å£°æ˜æ§½å‡½æ•°ï¼‰void workThread:: doWork()</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;å½“å‰çº¿ç¨‹ID:&quot;</span>&lt;&lt;QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">      <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;å¼€å§‹æ‰§è¡Œ&quot;</span>;</span><br><span class="line">      QThread::<span class="built_in">sleep</span>(<span class="number">10</span>);    </span><br><span class="line">      <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;ç»“æŸæ‰§è¡Œ&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><ul><li>2ï¸âƒ£<strong>ä¸»çº¿ç¨‹ä¸­åˆ†åˆ«å¯¹workThreadç±»å’ŒQTreadç±»å®ä¾‹åŒ–</strong></li></ul><p>åœ¨threadtest.hä¸­å£°æ˜</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QMainWindow&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;workThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> execution_character_set(<span class="string">&quot;utf-8&quot;</span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Threadtest</span> : <span class="keyword">public</span> QMainWindow</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Threadtest</span>(QWidget *parent = Q_NULLPTR);  </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::ThreadtestClass ui;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">btn_clicked</span><span class="params">()</span></span>;</span><br><span class="line">    workThread* thread; <span class="comment">//å®ä¾‹åŒ–workThreadç±»</span></span><br><span class="line">    QThread* qthread;   <span class="comment">//å®ä¾‹åŒ–QThreadç±»</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨threadtest.cppä¸­å®ç°<strong>å¹¶é€šè¿‡moveToThreadå°†è‡ªå·±æ”¾åˆ°çº¿ç¨‹QThreadå¯¹è±¡ä¸­ï¼Œæœ€åå¯åŠ¨çº¿ç¨‹</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;threadtest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Threadtest::<span class="built_in">Threadtest</span>(QWidget* parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//ä¸èƒ½æŒ‡å®šè‡ªå®šä¹‰ç±»çš„å¯¹è±¡çš„çˆ¶ç±»ä¸ºwidgetï¼Œå³æ²¡æœ‰thisï¼ˆå¾ˆé‡è¦ï¼ï¼ï¼ï¼ï¼‰</span></span><br><span class="line">   thread = <span class="keyword">new</span> <span class="built_in">workThread</span>();  </span><br><span class="line">   qthread1 = <span class="keyword">new</span> <span class="built_in">QThread</span>(<span class="keyword">this</span>);</span><br><span class="line">   thread-&gt;<span class="built_in">moveToThread</span>(qthread1);</span><br><span class="line">   <span class="comment">//çº¿ç¨‹ç»“æŸæ—¶æ¸…ç†çº¿ç¨‹å†…å­˜</span></span><br><span class="line">   <span class="built_in">connect</span>(qthread1, &amp;QThread::finished, qthread1, &amp;QThread::deleteLater);</span><br><span class="line">   <span class="comment">//å°†æŒ‰é’®äº‹ä»¶ï¼ˆä¿¡å·ï¼‰ç»‘å®šæ§½å‡½æ•°</span></span><br><span class="line">   <span class="built_in">connect</span>(ui.btn_start, &amp;QPushButton::clicked, thread, &amp;workThread::dowork);</span><br><span class="line">   <span class="comment">//æ‰“å°ä¸»çº¿ç¨‹</span></span><br><span class="line">   <span class="built_in">connect</span>(ui.btn_start, &amp;QPushButton::clicked, [=]() &#123;</span><br><span class="line">       <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;ä¸»çº¿ç¨‹idï¼š&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">       &#125;);</span><br><span class="line">   <span class="comment">//çº¿ç¨‹å¯åŠ¨</span></span><br><span class="line">   qthread1-&gt;<span class="built_in">start</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿è¡Œæ§½å‡½æ•°æ—¶ï¼Œä¸èƒ½åœ¨æ­¤ç›´æ¥è°ƒç”¨ï¼ˆå¦‚ï¼šthread1-&gt;doWork()ï¼‰ã€‚è€Œæ˜¯ç”¨connectè¿æ¥ä¿¡å·å’Œæ§½</p><p>è¿™é‡Œå°†æ‰“å°ä¸»çº¿ç¨‹å’Œæ§½å‡½æ•°éƒ½ç»‘å®šåœ¨äº†buttonæŒ‰é’®çš„clickäº‹ä»¶ä¸Šäº†ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d28d3da16f3.png"></p><p><img src="https://bu.dusays.com/2025/03/13/67d2995e14e1b.png"></p><ul><li><strong>å­çº¿ç¨‹ä¸­ä¸èƒ½æ“ä½œUI</strong></li></ul><p>Qtåˆ›å»ºçš„å­çº¿ç¨‹ä¸­æ˜¯ä¸èƒ½å¯¹UIå¯¹è±¡è¿›è¡Œä»»ä½•æ“ä½œçš„ï¼Œå³QWidgetåŠå…¶æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯æˆ‘æ‰çš„ç¬¬ä¸€ä¸ªå‘ã€‚å¯èƒ½æ˜¯ç”±äºè€ƒè™‘åˆ°å®‰å…¨æ€§çš„é—®é¢˜ï¼Œæ‰€ä»¥Qtä¸­å­çº¿ç¨‹ä¸èƒ½æ‰§è¡Œä»»ä½•å…³äºç•Œé¢çš„å¤„ç†ï¼ŒåŒ…æ‹¬æ¶ˆæ¯æ¡†çš„å¼¹å‡ºã€‚æ­£ç¡®çš„æ“ä½œåº”è¯¥æ˜¯é€šè¿‡ä¿¡å·æ§½ï¼Œå°†ä¸€äº›å‚æ•°ä¼ é€’ç»™ä¸»çº¿ç¨‹ï¼Œè®©ä¸»çº¿ç¨‹ï¼ˆä¹Ÿå°±æ˜¯Controllerï¼‰å»å¤„ç†ã€‚</p><ul><li><strong>è‡ªå®šä¹‰çš„ç±»ä¸èƒ½æŒ‡å®šçˆ¶å¯¹è±¡</strong></li></ul><p>æ¯”å¦‚ä¸Šé¢ç¨‹åºä¸­çš„ï¼šï¼ˆä¸èƒ½æŒ‡å®šè‡ªå®šä¹‰ç±»å¯¹è±¡ä¸ºwidgetï¼Œå³ä¸å¯ä»¥åŠ thisï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">thread1=<span class="keyword">new</span> <span class="built_in">workThread1</span>();<span class="comment">//åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><ul><li><strong>QThreadå’Œconnectçš„å…³ç³»</strong></li></ul><p>æˆ‘ä»¬ä½¿ç”¨æœ€å¤šçš„æ˜¯QThreadäºconnectçš„å…³ç³»ï¼Œåœ¨ä½¿ç”¨connectå‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠæœ€åä¸€ä¸ªå‚æ•°å¿½ç•¥æ‰ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦çœ‹ä¸‹å‡½æ•°åŸå‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">static</span>] <span class="function">QMetaObject::Connection <span class="title">QObject::connect</span><span class="params">(<span class="type">const</span> QObject *sender, <span class="type">const</span> <span class="type">char</span> *signal, <span class="type">const</span> QObject *receiver, <span class="type">const</span> <span class="type">char</span> *method, Qt::ConnectionType type = Qt::AutoConnection)</span></span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ€åä¸€ä¸ªå‚æ•°ä»£è¡¨çš„æ˜¯è¿æ¥çš„æ–¹å¼ã€‚æˆ‘ä»¬ä¸€èˆ¬ä¼šç”¨åˆ°æ–¹å¼æ˜¯æœ‰ä¸‰ç§ï¼š</p><p><strong>è‡ªåŠ¨è¿æ¥(AutoConnection)</strong>ï¼šé»˜è®¤çš„è¿æ¥æ–¹å¼ã€‚å¦‚æœä¿¡å·ä¸æ§½ï¼Œä¹Ÿå°±æ˜¯å‘é€è€…ä¸æ¥å—è€…åœ¨åŒä¸€çº¿ç¨‹ï¼Œç­‰åŒäºç›´æ¥è¿æ¥ï¼›å¦‚æœå‘é€è€…ä¸æ¥å—è€…å¤„åœ¨ä¸åŒçº¿ç¨‹ï¼Œç­‰åŒäºé˜Ÿåˆ—è¿æ¥ã€‚</p><p><strong>ç›´æ¥è¿æ¥(Direct Connection)</strong>ï¼šå½“ä¿¡å·å‘å°„æ—¶ï¼Œæ§½å‡½æ•°å°†ç›´æ¥è¢«è°ƒç”¨ã€‚æ— è®ºæ§½å‡½æ•°æ‰€å±å¯¹è±¡åœ¨å“ªä¸ªçº¿ç¨‹ï¼Œæ§½å‡½æ•°éƒ½åœ¨å‘å°„è€…æ‰€åœ¨çº¿ç¨‹æ‰§è¡Œã€‚</p><p><strong>é˜Ÿåˆ—è¿æ¥(Queued Connection)</strong>ï¼šå½“æ§åˆ¶æƒå›åˆ°æ¥å—è€…æ‰€åœ¨çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯å¼ï¼Œæ§½å‡½æ•°è¢«è°ƒç”¨ã€‚æ§½å‡½æ•°åœ¨æ¥æ”¶è€…æ‰€åœ¨çº¿ç¨‹æ‰§è¡Œã€‚</p><p><strong>å› æ­¤æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</strong></p><ol><li>ä¸»çº¿ç¨‹å¯¹è±¡å‘å‡ºä¿¡å·è¿æ¥QThreadå­ç±»çš„æ§½å‡½æ•°ï¼ŒQThreadå­ç±»å¯¹è±¡åœ¨ä¸»çº¿ç¨‹åˆ›å»ºçš„ï¼Œæ— è®ºé‡‡ç”¨å“ªç§è¿æ¥æ–¹å¼ï¼Œæ§½å‡½æ•°éƒ½å±åœ¨ä¸»çº¿ç¨‹è°ƒç”¨ã€‚ï¼ˆå¦‚æœåœ¨é‡å†™çš„runå‡½æ•°ä¸­è°ƒç”¨äº†æ§½å‡½æ•°ï¼Œæ­¤æ—¶æ§½å‡½æ•°åœ¨æ¬¡çº¿ç¨‹æ‰§è¡Œï¼Œæ³¨æ„æ•°æ®å®‰å…¨ï¼‰ã€‚</li><li>æ¬¡çº¿ç¨‹runä¸­å‘å‡ºä¿¡å·ï¼Œæ§½å‡½æ•°å¯ä»¥æ˜¯å‘å‡ºä¿¡å·å¯¹è±¡è‡ªèº«çš„æ§½å‡½æ•°ï¼Œè‡ªå‘è‡ªæ”¶ï¼Œéƒ½æ˜¯æ¬¡çº¿ç¨‹ä¸­è¡Œã€‚æ§½å‡½æ•°æ˜¯QThreadå­ç±»çš„æ§½å‡½æ•°ï¼Œæˆ–è€…ä¸»çº¿ç¨‹ä¸­å¯¹è±¡çš„æ§½å‡½æ•°ï¼Œè¿™é‡Œçš„ç§æƒ…å†µéœ€è¦ä½ æŒ‡æ˜runä¸­connectä¸­çš„è¿æ¥æ–¹å¼ï¼Œç›´è¿åˆ™è¯¥æ§½å‡½æ•°åœ¨æ¬¡çº¿ç¨‹ä¸­æ‰§è¡Œï¼ˆå¯èƒ½å‘ç”Ÿæ•°æ®å®‰å…¨é—®é¢˜ï¼‰ï¼Œåˆ—é˜Ÿåˆ™åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</li></ol><p><strong>ğŸ§¡ğŸ§¡æ€»ç»“ä¸€ä¸‹ï¼š</strong></p><ul><li>ä¸€å®šè¦ç”¨ä¿¡å·æ§½æœºåˆ¶ï¼Œåˆ«æƒ³ç€ç›´æ¥è°ƒç”¨ï¼Œä½ ä¼šå‘ç°å¹¶æ²¡æœ‰åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</li><li>è‡ªå®šä¹‰çš„ç±»ä¸èƒ½æŒ‡å®šçˆ¶å¯¹è±¡ï¼Œå› ä¸ºmoveToThreadå‡½æ•°ä¼šå°†çº¿ç¨‹å¯¹è±¡æŒ‡å®šä¸ºè‡ªå®šä¹‰çš„ç±»çš„çˆ¶å¯¹è±¡ï¼Œå½“è‡ªå®šä¹‰çš„ç±»å¯¹è±¡å·²ç»æœ‰äº†çˆ¶å¯¹è±¡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</li><li>å½“ä¸€ä¸ªå˜é‡éœ€è¦åœ¨å¤šä¸ªçº¿ç¨‹é—´è¿›è¡Œè®¿é—®æ—¶ï¼Œæœ€å¥½åŠ ä¸Švoliateå…³é”®å­—ï¼Œä»¥å…è¯»å–åˆ°çš„æ˜¯æ—§çš„å€¼ã€‚å½“ç„¶ï¼ŒQtä¸­æä¾›äº†çº¿ç¨‹åŒæ­¥çš„æ”¯æŒï¼Œæ¯”å¦‚äº’æ–¥é”ä¹‹ç±»çš„ç©æ„ï¼Œä½¿ç”¨è¿™äº›æ–¹å¼æ¥è®¿é—®å˜é‡ä¼šæ›´åŠ å®‰å…¨ã€‚</li><li>åˆ†æå‘å‡ºä¿¡å·çš„å¯¹è±¡å’Œæ¥å—ä¿¡å·å¯¹è±¡æ‰€åœ¨çš„çº¿ç¨‹ï¼Œå†é€šè¿‡è¿æ¥æ–¹å¼ï¼Œåˆ¤æ–­æ§½å‡½æ•°åœ¨å“ªé‡Œæ‰§è¡Œã€‚ï¼ˆå°ç™½åœ¨ä½¿ç”¨ä¸­å°±æœ‰åœ¨runä¸­åˆ›å»ºå¯¹è±¡-å› ä¸ºå¤šéæ§½å‡½æ•°éƒ½éœ€è¦åœ¨æ¬¡çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé€šè¿‡æŒ‡é’ˆå¼•å‡ºæ¥ï¼Œå†connectä¸å…¶ä»–æ¨¡å—äº¤äº’ï¼ŒæŒ‡æ˜è¿æ¥æ–¹å¼ä¸ºåˆ—é˜Ÿå½¢å¼ï¼Œæ‰€ä»¥ç›¸å…³æ‰§è¡Œéƒ½åœ¨æ¬¡çº¿ç¨‹ä¸­æ‰§è¡Œï¼‰ã€‚è¿™é‡Œè®°ä½moveToThreadåªèƒ½å°†æ§½å‡½æ•°ç§»åˆ°æ¬¡çº¿ç¨‹ä¸­ã€‚</li></ul><p><strong><p align = "center">å¯åŠ¨å¤šçº¿ç¨‹çš„æ“ä½œæ€è·¯</p></strong></p><p>å¦‚æœæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ’åºæ“ä½œï¼Œå³é¦–å…ˆè·å–1000ä¸ªéšæœºæ•°ï¼Œç„¶åç”¨å†’æ³¡æ’åºæ³•å¯¹å…¶è¿›è¡Œæ’åºã€‚</p><p><strong>æ–¹æ³•ä¸€ï¼šé‡å†™runå‡½æ•°</strong></p><p> <strong>æ€è·¯ï¼šï¼ˆæ„å»ºä¸¤ä¸ªå­çº¿ç¨‹ï¼Œä¸€ä¸ªç”¨äºç”Ÿæˆéšæœºæ•°ï¼Œä¸€ä¸ªç”¨äºå†’æ³¡æ’åºï¼Œä¸»çº¿ç¨‹è´Ÿè´£è°ƒç”¨ï¼‰</strong></p><ul><li>æ–°å»ºmyThreadç±»ï¼Œåœ¨è¯¥ç±»ä¸­é‡å†™runå‡½æ•°ï¼ˆå³ç”Ÿéšæœºæ•°ï¼‰ã€‚éœ€è¦å…ˆæ¥æ”¶ä¸»çº¿ç¨‹å‘é€çš„è¦ç”Ÿæˆéšæœºæ•°çš„ä¸ªæ•°ï¼ˆscvnumä¿¡å·ï¼‰åå†è¿›è¡Œç”Ÿæˆï¼Œç”Ÿæˆå®Œæˆä»¥åå‘é€ä¸€ä¸ªsendArrayä¿¡å·</li><li>æ–°å»ºBubbleSortç±»ï¼Œåœ¨è¯¥ç±»ä¸­é‡å†™runå‡½æ•°ï¼ˆå³å†’æ³¡æ’åºç®—æ³•ï¼‰ã€‚éœ€è¦å…ˆæ¥æ”¶å·²ç»ç”Ÿæˆçš„éšæœºæ•°ï¼ˆrcvArrayä¿¡å·ï¼‰åå†è¿›è¡Œæ’åºï¼Œæ’åºå®Œæˆåå‘é€ä¸€ä¸ªfinishä¿¡å·</li><li>ä¸»çº¿ç¨‹é€šè¿‡statingä¿¡å·å‘Šè¯‰myThreadçº¿ç¨‹è¦ç”Ÿæˆçš„ä¸ªæ•°ï¼Œç„¶åmyThreadçº¿ç¨‹é€šè¿‡scvnumä¿¡å·æ¥æ”¶ï¼Œè¿›è¡Œç”Ÿæˆéšæœºæ•°ï¼Œç„¶åå†å‘é€ä¸€ä¸ªsendArrayä¿¡å·ï¼ˆå³ç”Ÿæˆéšæœºæ•°é›†åˆï¼‰</li><li>BubbleSortå­çº¿ç¨‹é€šè¿‡rcvArrayä¿¡å·æ¥æ”¶sendArrayä¿¡å·ï¼ˆå³æ¥æ”¶éšæœºæ•°ï¼‰ç„¶åè¿›è¡Œå†’æ³¡æ’åºï¼Œå†å‘é€finishä¿¡å·</li><li>ä¸»çº¿ç¨‹æ¥æ”¶åˆ°finishä¿¡å·åï¼Œå°†æ’åºåçš„éšæœºæ•°æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Š</li></ul><p><strong>å®ç°ä»£ç ï¼š</strong></p><ul><li><strong>å­çº¿ç¨‹.h</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qvector.h&quot;</span></span></span><br><span class="line"><span class="comment">//æ–°å»ºéšæœºæ•°ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myThread</span> :</span><br><span class="line">    <span class="keyword">public</span> QThread</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">myThread</span>(QObject* parent = <span class="literal">nullptr</span>);</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">scvnum</span><span class="params">(<span class="type">int</span> num)</span></span>;<span class="comment">//æ¥æ”¶æ•°å­—</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">sendArray</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;num)</span></span>;<span class="comment">//å‘é€</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> m_num;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–°å»ºå†’æ³¡æ’åºç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BubbleSort</span> :</span><br><span class="line">    <span class="keyword">public</span> QThread</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">BubbleSort</span>(QObject* parent = <span class="literal">nullptr</span>);</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">rcvArray</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;list)</span></span>;<span class="comment">//è¦æ¥æ”¶çš„æ˜¯æ’åºçš„æ•°</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">finish</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;list)</span></span>;<span class="comment">//æ’åºå®Œæˆåå‘é€ä¸€ä¸ªfinishä¿¡å·</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QVector&lt;<span class="type">int</span>&gt;m_list;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>å­çº¿ç¨‹.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;myThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qelapsedtimer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">myThread::<span class="built_in">myThread</span>(QObject* parent) :<span class="built_in">QThread</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">BubbleSort::<span class="built_in">BubbleSort</span>(QObject* parent) : <span class="built_in">QThread</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myThread::scvnum</span><span class="params">(<span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_num = num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myThread::run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;child thread id&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    QVector&lt;<span class="type">int</span>&gt; list;</span><br><span class="line">    QElapsedTimer time;</span><br><span class="line">    time.<span class="built_in">start</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m_num; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        list.<span class="built_in">push_back</span>(<span class="built_in">qrand</span>() % <span class="number">100000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> milsec = time.<span class="built_in">elapsed</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;The number of&quot;</span> &lt;&lt; m_num &lt;&lt; <span class="string">&quot;generated&quot;</span>;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;shared&quot;</span> &lt;&lt; milsec &lt;&lt; <span class="string">&quot;second&quot;</span>;</span><br><span class="line">    <span class="function">emit <span class="title">sendArray</span><span class="params">(list)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BubbleSort::rcvArray</span><span class="params">(QVector&lt;<span class="type">int</span>&gt; list)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_list = list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BubbleSort::run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;BubbleSort thread id:&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    QElapsedTimer time;</span><br><span class="line">    time.<span class="built_in">start</span>();</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m_list.<span class="built_in">size</span>(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m_list.<span class="built_in">size</span>()-i<span class="number">-1</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (m_list[j] &gt; m_list[j + <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = m_list[j];</span><br><span class="line">                m_list[j] = m_list[j + <span class="number">1</span>];</span><br><span class="line">                m_list[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> milsec = time.<span class="built_in">elapsed</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;shared&quot;</span> &lt;&lt; milsec &lt;&lt; <span class="string">&quot;second&quot;</span>;</span><br><span class="line">    <span class="function">emit <span class="title">finish</span><span class="params">(m_list)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>ä¸»çº¿ç¨‹.h</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ui_list.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">list</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">list</span>(QWidget *parent = Q_NULLPTR);</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">stating</span><span class="params">(<span class="type">int</span> num)</span></span>;<span class="comment">//è®¾ç½®è¦ç”Ÿæˆéšæœºæ•°ä¸ªæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::listClass ui;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>ä¸»çº¿ç¨‹.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;list.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;myThread.h&quot;</span></span></span><br><span class="line">list::<span class="built_in">list</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºå­çº¿ç¨‹å¯¹è±¡</span></span><br><span class="line">    myThread* thread = <span class="keyword">new</span> <span class="built_in">myThread</span>();</span><br><span class="line">    BubbleSort* bub_thread = <span class="keyword">new</span> <span class="built_in">BubbleSort</span>();</span><br><span class="line">    <span class="comment">//å‘å­çº¿ç¨‹å‘é€è¦ç”Ÿæˆçš„éšæœºæ•°ä¸ªæ•°</span></span><br><span class="line">    <span class="built_in">connect</span>(<span class="keyword">this</span>,&amp;list::stating, thread, &amp;myThread::scvnum);</span><br><span class="line">    <span class="comment">//2å¯åŠ¨å­çº¿ç¨‹</span></span><br><span class="line">    <span class="built_in">connect</span>(ui.pushButton, &amp;QPushButton::clicked,  [=]() &#123;</span><br><span class="line">        emit <span class="built_in">stating</span>(<span class="number">1000</span>);<span class="comment">//ä¸»çº¿ç¨‹è®¾ç½®å­çº¿ç¨‹éšæœºæ•°çš„ä¸ªæ•°</span></span><br><span class="line">        thread-&gt;<span class="built_in">start</span>();</span><br><span class="line">    </span><br><span class="line">        </span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(thread, &amp;myThread::sendArray, bub_thread, &amp;BubbleSort::rcvArray);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3æ¥æ”¶å­çº¿ç¨‹å‘é€çš„æ•°æ®</span></span><br><span class="line">    <span class="built_in">connect</span>(thread, &amp;myThread::sendArray,  [=](QVector&lt;<span class="type">int</span>&gt;list) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; list.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            ui.randlist-&gt;<span class="built_in">addItem</span>(QString::<span class="built_in">number</span>(list.<span class="built_in">at</span>(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(thread, &amp;myThread::sendArray, [=](QVector&lt;<span class="type">int</span>&gt;list)&#123;</span><br><span class="line">        bub_thread-&gt;<span class="built_in">start</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="built_in">connect</span>(bub_thread, &amp;BubbleSort::finish, [=](QVector&lt;<span class="type">int</span>&gt;list) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; list. <span class="built_in">size</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            ui.bubblelist-&gt;<span class="built_in">addItem</span>(QString::<span class="built_in">number</span>(list.<span class="built_in">at</span>(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d299b1220c9.gif"></p><p><strong>æ–¹æ³•äºŒï¼šmoveToThread()</strong> </p><p><strong>æ€è·¯ï¼š</strong></p><ul><li>æ–°å»ºmyThreadç±»ï¼Œç”¨äºç”Ÿæˆéšæœºæ•°ï¼ˆworkingå‡½æ•°ï¼‰ï¼Œåœ¨æ¥å—åˆ°ä¸»çº¿ç¨‹çš„ä¿¡å·åå¼€å§‹ç”Ÿæˆéšæœºæ•°</li><li>æ–°å»ºBubbleSortç±»ï¼Œç”¨äºæ’åº(workingå‡½æ•°ï¼‰ï¼Œåœ¨æ¥å—åˆ°myThreadç±»ç”Ÿæˆçš„éšæœºæ•°åå¼€å§‹æ’åº</li><li>æœ€åæ˜¾ç¤ºåœ¨ç•Œé¢</li></ul><p><strong>ä»£ç å®ç°ï¼š</strong></p><ul><li><strong>å­çº¿ç¨‹.h</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qthread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qvector.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qobject.h&quot;</span></span></span><br><span class="line"><span class="comment">//æ–°å»ºéšæœºæ•°ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myThread</span> :</span><br><span class="line">    <span class="keyword">public</span> QObject</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">myThread</span>(QObject* parent = <span class="literal">nullptr</span>);</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">working</span><span class="params">(<span class="type">int</span> num)</span></span>;<span class="comment">//ç”Ÿæˆéšæœºæ•°</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">sendArray</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;num)</span></span>;<span class="comment">//å‘é€</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> m_num;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–°å»ºå†’æ³¡æ’åºç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BubbleSort</span> :</span><br><span class="line">    <span class="keyword">public</span> QObject</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">BubbleSort</span>(QObject* parent = <span class="literal">nullptr</span>);</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">working</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;list)</span></span>;<span class="comment">//è¦æ¥æ”¶çš„æ˜¯æ’åºçš„æ•°</span></span><br><span class="line"></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">finish</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;list)</span></span>;<span class="comment">//æ’åºå®Œæˆåå‘é€ä¸€ä¸ªfinishä¿¡å·</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>å­çº¿ç¨‹.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;myThread.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qelapsedtimer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;qdebug.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">myThread::<span class="built_in">myThread</span>(QObject* parent) :<span class="built_in">QObject</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">BubbleSort::<span class="built_in">BubbleSort</span>(QObject* parent) : <span class="built_in">QObject</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myThread::working</span><span class="params">(<span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;child thread id&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    QVector&lt;<span class="type">int</span>&gt; list;</span><br><span class="line">    QElapsedTimer time;</span><br><span class="line">    time.<span class="built_in">start</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        list.<span class="built_in">push_back</span>(<span class="built_in">qrand</span>() % <span class="number">100000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> milsec = time.<span class="built_in">elapsed</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;The number of&quot;</span> &lt;&lt; m_num &lt;&lt; <span class="string">&quot;generated&quot;</span>;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;shared&quot;</span> &lt;&lt; milsec &lt;&lt; <span class="string">&quot;second&quot;</span>;</span><br><span class="line">    <span class="function">emit <span class="title">sendArray</span><span class="params">(list)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BubbleSort::working</span><span class="params">(QVector&lt;<span class="type">int</span>&gt;list)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;BubbleSort thread id:&quot;</span> &lt;&lt; QThread::<span class="built_in">currentThreadId</span>();</span><br><span class="line">    QElapsedTimer time;</span><br><span class="line">    time.<span class="built_in">start</span>();</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; list.<span class="built_in">size</span>(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; list.<span class="built_in">size</span>()-i<span class="number">-1</span>; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (list[j] &gt; list[j + <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = list[j];</span><br><span class="line">                list[j] = list[j + <span class="number">1</span>];</span><br><span class="line">                list[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> milsec = time.<span class="built_in">elapsed</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;shared&quot;</span> &lt;&lt; milsec &lt;&lt; <span class="string">&quot;second&quot;</span>;</span><br><span class="line">    <span class="function">emit <span class="title">finish</span><span class="params">(list)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>ä¸»çº¿ç¨‹.h</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtWidgets/QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ui_list.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">list</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">list</span>(QWidget *parent = Q_NULLPTR);</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">stating</span><span class="params">(<span class="type">int</span> num)</span></span>;<span class="comment">//è®¾ç½®è¦ç”Ÿæˆéšæœºæ•°ä¸ªæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::listClass ui;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><strong>ä¸»çº¿ç¨‹.cpp</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;list.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;myThread.h&quot;</span></span></span><br><span class="line">list::<span class="built_in">list</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    ui.<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºQThreadå¯¹è±¡</span></span><br><span class="line">    QThread* thread1 = <span class="keyword">new</span> QThread;</span><br><span class="line">    QThread* thread2 = <span class="keyword">new</span> QThread;</span><br><span class="line">    <span class="comment">//2.åˆ›å»ºå­çº¿ç¨‹ç±»å¯¹è±¡</span></span><br><span class="line">    myThread* myth = <span class="keyword">new</span> <span class="built_in">myThread</span>();</span><br><span class="line">    BubbleSort* bub = <span class="keyword">new</span> <span class="built_in">BubbleSort</span>();</span><br><span class="line">    <span class="comment">//3é€šè¿‡movetothreadå°†å­çº¿ç¨‹å¯¹è±¡ç§»åŠ¨åˆ°QThreadå¯¹è±¡ä¸­</span></span><br><span class="line">    myth-&gt;<span class="built_in">moveToThread</span>(thread1);</span><br><span class="line">    bub-&gt;<span class="built_in">moveToThread</span>(thread2);</span><br><span class="line">    <span class="comment">//4å¯åŠ¨å­çº¿ç¨‹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…ˆå‘å­çº¿ç¨‹å‘é€è¦ç”Ÿæˆçš„éšæœºæ•°ä¸ªæ•°</span></span><br><span class="line">    <span class="built_in">connect</span>(<span class="keyword">this</span>,&amp;list::stating, myth, &amp;myThread::working);</span><br><span class="line">    <span class="comment">//å†å¯åŠ¨å­çº¿ç¨‹</span></span><br><span class="line">    <span class="built_in">connect</span>(ui.pushButton, &amp;QPushButton::clicked,  [=]() &#123;</span><br><span class="line">        emit <span class="built_in">stating</span>(<span class="number">1000</span>);<span class="comment">//ä¸»çº¿ç¨‹è®¾ç½®å­çº¿ç¨‹éšæœºæ•°çš„ä¸ªæ•°</span></span><br><span class="line">        thread1-&gt;<span class="built_in">start</span>();        </span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="comment">//å°†ç”Ÿæˆå¥½çš„éšæœºæ•°å‘é€ç»™BubbleSortç±»</span></span><br><span class="line">    <span class="built_in">connect</span>(myth, &amp;myThread::sendArray, bub, &amp;BubbleSort::working);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°†ç”Ÿæˆå¥½çš„éšæœºæ•°æ˜¾ç¤ºåœ¨ç•Œé¢</span></span><br><span class="line">    <span class="built_in">connect</span>(myth, &amp;myThread::sendArray,  [=](QVector&lt;<span class="type">int</span>&gt;list) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; list.<span class="built_in">size</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            ui.randlist-&gt;<span class="built_in">addItem</span>(QString::<span class="built_in">number</span>(list.<span class="built_in">at</span>(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="comment">//å‘é€çš„åŒæ—¶å¯åŠ¨æ’åºç®—æ³•</span></span><br><span class="line">    <span class="built_in">connect</span>(myth, &amp;myThread::sendArray, [=](QVector&lt;<span class="type">int</span>&gt;list)&#123;</span><br><span class="line">        thread2-&gt;<span class="built_in">start</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="comment">//å°†æ’åºå¥½çš„æ•°æ˜¾ç¤ºåœ¨ç•Œé¢</span></span><br><span class="line">    <span class="built_in">connect</span>(bub, &amp;BubbleSort::finish, [=](QVector&lt;<span class="type">int</span>&gt;list) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; list. <span class="built_in">size</span>(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            ui.bubblelist-&gt;<span class="built_in">addItem</span>(QString::<span class="built_in">number</span>(list.<span class="built_in">at</span>(i)));</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç»“è®º</strong></p><p>é€šè¿‡å¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š</p><ul><li>ç”±äºç¬¬äºŒç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å¸¦å‚çš„å­çº¿ç¨‹è¿è¡Œå‡½æ•°ï¼Œå› æ­¤ä»£ç æ›´åŠ ç®€æ´ã€‚</li><li>åœ¨ç¬¬äºŒç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥éšæ„ä¿®æ”¹éœ€è¦åœ¨å“ªä¸ªçº¿ç¨‹ä¸­è¿è¡Œï¼Œä»£ç ä¹Ÿæ›´åŠ çµæ´»ã€‚</li><li>ç¬¬ä¸€ç§æ–¹æ³•é€‚åˆåœ¨çº¿ç¨‹ä¸­å¤„ç†å•ä¸€äº‹ä»¶ï¼Œå…¶é€»è¾‘ç®€å•ï¼ˆåªéœ€è¦æ–°å»ºä¸€ä¸ªç»§æ‰¿è‡ªQThreadç±»çš„å¯¹è±¡ï¼Œé‡å†™runå‡½æ•°ï¼Œç„¶åå¯åŠ¨å³å¯ï¼‰ï¼Œå¯¹äºéœ€è¦åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†å¤šä¸ªäº‹ä»¶ï¼Œè¿˜æ˜¯ç”¨ç¬¬äºŒç§æ–¹æ³•æ¯”è¾ƒå¥½ã€‚</li><li>ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ç¬¬äºŒç§æ–¹æ³•ä¸­ï¼Œç»™å®šä¹‰çš„å­çº¿ç¨‹å¯¹è±¡æ·»åŠ çˆ¶ç±»å‘¢ï¼Ÿ ï¼šç”±äºæ·»åŠ äº†çˆ¶ç±»ä»¥åå°±ä¸èƒ½å†ç§»åŠ¨åˆ°QThreadä¸­å»äº†</li></ul><p><strong>å¦‚ä½•è¿›è¡Œçº¿ç¨‹èµ„æºçš„é‡Šæ”¾ï¼Ÿ</strong></p><ol><li>åœ¨newå¯¹è±¡æ—¶å€™ï¼Œç›´æ¥ç”¨thisæŒ‡å®šå…¶çˆ¶ç±»ï¼ˆå³æ”¾å…¥å¯¹è±¡æ•°ä¸­ï¼‰</li><li>åœ¨ç¨‹åºæœ€åè‡ªè¡Œé‡Šæ”¾èµ„æº</li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(<span class="keyword">this</span>, &amp;list::destroyed, <span class="keyword">this</span>, [=]() &#123;</span><br><span class="line">    thread1-&gt;<span class="built_in">quit</span>();</span><br><span class="line">    thread1-&gt;<span class="built_in">wait</span>();</span><br><span class="line">    thread1-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">    thread2-&gt;<span class="built_in">quit</span>();</span><br><span class="line">    thread2-&gt;<span class="built_in">wait</span>();</span><br><span class="line">    thread2-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">    myth-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">    bub-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt03æ–‡ä»¶è¯»å†™</title>
      <link href="/2025/03/13/Qt03%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/"/>
      <url>/2025/03/13/Qt03%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p>Qt æä¾›äº†ä¸¤ç§è¯»å†™çº¯æ–‡æœ¬æ–‡ä»¶çš„åŸºæœ¬æ–¹æ³•ï¼š</p><ol><li>ç”¨ <strong>QFile ç±»</strong>çš„ IODevice è¯»å†™åŠŸèƒ½ç›´æ¥è¿›è¡Œè¯»å†™</li><li>åˆ©ç”¨ <strong>QFile</strong> å’Œ <strong>QTextStream</strong> ç»“åˆèµ·æ¥ï¼Œç”¨æµï¼ˆStream)çš„æ–¹æ³•è¿›è¡Œæ–‡ä»¶è¯»å†™ã€‚</li></ol><h3 id="ä¸€ã€æ–‡ä»¶è¯»æ“ä½œ"><a href="#ä¸€ã€æ–‡ä»¶è¯»æ“ä½œ" class="headerlink" title="ä¸€ã€æ–‡ä»¶è¯»æ“ä½œ"></a><font color="FF0000">ä¸€ã€æ–‡ä»¶è¯»æ“ä½œ</font></h3><p><strong>ï¼ˆ1ï¼‰ä½¿ç”¨QFileç±»</strong></p><p>Qtå°è£…äº†QFileç±»ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤è¿›è¡Œï¼š</p><ul><li>ä½¿ç”¨QFileåŠ è½½æ–‡ä»¶å¯¹è±¡</li><li>æ‰“å¼€æ–‡ä»¶ file.open(æ‰“å¼€æ–¹å¼)</li><li>æ“ä½œæ–‡ä»¶</li><li>å…³é—­æ–‡ä»¶ file.close()</li></ul><p><strong>å®ä¾‹ï¼šç‚¹å‡»è¯»å†™æ–‡ä»¶æŒ‰é’®ï¼Œè¯»å–æ–‡ä»¶å†…å®¹åˆ°textEditä¸­</strong></p><p>1ï¸âƒ£è®¾ç½® ui ç•Œé¢</p><p><img src="https://bu.dusays.com/2025/03/13/67d284db41c18.png"></p><p>2ï¸âƒ£åœ¨widget.cppä¸­ç¼–è¾‘ä»£ç ï¼ˆQFileDialogç±»æ˜¯æ‰“å¼€æ–‡ä»¶ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç‚¹å‡»é€‰å–æ–‡ä»¶æŒ‰é’®ï¼Œå¼¹å‡ºæ–‡ä»¶å¯¹è¯æ¡†</span></span><br><span class="line"> <span class="built_in">connect</span>(ui-&gt;pushButton,&amp;QPushButton::clicked,[=]()&#123;</span><br><span class="line"> QString path = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>,<span class="string">&quot;æ‰“å¼€æ–‡ä»¶&quot;</span>,<span class="string">&quot;C:/Users/WFD/Desktop&quot;</span>);</span><br><span class="line"><span class="comment">//å°†è·¯å¾„æ˜¾ç¤ºåœ¨lineEditä¸­</span></span><br><span class="line">ui-&gt;lineEdit-&gt;<span class="built_in">setText</span>(path);</span><br><span class="line"></span><br><span class="line">   <span class="comment">//è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ”¾å…¥textEditä¸­</span></span><br><span class="line">   QFile <span class="built_in">file</span>(path);<span class="comment">//å‚æ•°å°±æ˜¯æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">   <span class="comment">//è®¾ç½®æ‰“å¼€æ–¹å¼</span></span><br><span class="line">   file.<span class="built_in">open</span>(QIODevice::ReadOnly);</span><br><span class="line">   <span class="comment">//ç”¨QByteArrayç±»å»æ¥æ”¶è¯»å–çš„ä¿¡æ¯</span></span><br><span class="line">   QByteArray array=file.<span class="built_in">readAll</span>();</span><br><span class="line">   <span class="comment">//å°†è¯»å–åˆ°çš„æ•°æ®æ”¾å…¥textEditä¸­</span></span><br><span class="line">   ui-&gt;textEdit-&gt;<span class="built_in">setText</span>(array);</span><br><span class="line">   <span class="comment">//å…³é—­æ–‡ä»¶å¯¹è±¡</span></span><br><span class="line">   file.<span class="built_in">close</span>();</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d2853788ad5.png"></p><p><strong>æ³¨æ„ï¼šåœ¨è®¾ç½®æ‰“å¼€æ–¹å¼çš„æ—¶å€™</strong></p><p>QFile::open() å‡½æ•°æ‰“å¼€æ–‡ä»¶æ—¶éœ€è¦ä¼ é€’ <code>QIODevice::OpenModeFlag</code> æšä¸¾ç±»å‹çš„å‚æ•°ï¼Œå†³å®šæ–‡ä»¶ä»¥ä»€ä¹ˆæ–¹å¼æ‰“å¼€ï¼ŒQIODevice::OpenModeFlag ç±»å‹çš„ä¸»è¦å–å€¼å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">QIODevice::ReadOnly  <span class="comment">//ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œç”¨äºè½½å…¥æ–‡ä»¶ã€‚</span></span><br><span class="line">QIODevice::WriteOnly  <span class="comment">//ä»¥åªå†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œç”¨äºä¿å­˜æ–‡ä»¶ã€‚</span></span><br><span class="line">QIODevice::ReadWrite <span class="comment">//ä»¥è¯»å†™æ–¹å¼æ‰“å¼€ã€‚</span></span><br><span class="line">QIODevice::Append  <span class="comment">//ä»¥æ·»åŠ æ¨¡å¼æ‰“å¼€ï¼Œæ–°å†™å…¥æ–‡ä»¶çš„æ•°æ®æ·»åŠ åˆ°æ–‡ä»¶å°¾éƒ¨ã€‚</span></span><br><span class="line">QIODevice::Truncate <span class="comment">//ä»¥æˆªå–æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œæ–‡ä»¶åŸæœ‰çš„å†…å®¹å…¨éƒ¨è¢«åˆ é™¤ã€‚</span></span><br><span class="line">QIODevice::Text       <span class="comment">//ä»¥æ–‡æœ¬æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œè¯»å–æ—¶â€œ\nâ€è¢«è‡ªåŠ¨ç¿»è¯‘ä¸ºæ¢è¡Œç¬¦ï¼Œå†™å…¥æ—¶å­—ç¬¦ä¸²ç»“æŸç¬¦ä¼šè‡ªåŠ¨ç¿»è¯‘ä¸ºç³»ç»Ÿå¹³å°çš„ç¼–ç ï¼Œå¦‚ Windows å¹³å°ä¸‹æ˜¯â€œ\r\nâ€ã€‚</span></span><br><span class="line"></span><br><span class="line">è¿™äº›å–å€¼å¯ä»¥ç»„åˆï¼Œä¾‹å¦‚ QIODevice::ReadOnly | QIODevice::Text è¡¨ç¤ºä»¥åªè¯»å’Œæ–‡æœ¬æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><p> <strong>æ³¨æ„ï¼šåœ¨æ“ä½œæ–‡ä»¶æ—¶</strong></p><p>ç”¨åªè¯»æ–¹å¼æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åç”¨readAll()æ–¹æ³•å°†æ–‡ä»¶å†…å®¹ä¸€æ¬¡å…¨éƒ¨è¯»å–å‡ºæ¥ï¼Œè¿”å›å€¼æ˜¯å­—èŠ‚æ•°ç»„QByteArrayã€‚QByteArrayç”¨æ¥å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®ï¼Œå¦‚æœæƒ³è¦çœ‹æ–‡å­—å†…å®¹éœ€è¦è½¬æ¢æˆQStringã€‚(æœ‰æ—¶å€™ç³»ç»Ÿä¼šè‡ªåŠ¨è½¬æ¢ï¼‰</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨readLineæ–¹æ³•ä¸€æ¬¡è¯»å–ä¸€è¡Œï¼Œç„¶åæ¯æ¬¡å¯¹ä¸€è¡Œæ–‡å­—è¿›è¡Œæ“ä½œï¼šï¼ˆç”¨file.atEndåˆ¤æ–­æ˜¯å¦è¯»åˆ°æœ€åä¸€è¡Œï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QByteArray array;</span><br><span class="line"> <span class="keyword">while</span>(!file.<span class="built_in">atEnd</span>())</span><br><span class="line"> &#123;</span><br><span class="line">      array+=file.<span class="built_in">readLine</span>();<span class="comment">//+=å åŠ è¯»è¿‡çš„è¡Œ</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><strong>ï¼ˆ2ï¼‰ä½¿ç”¨QTextStreamç±»</strong></p><p>å¦‚æœæ“ä½œçš„æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼ŒQtè¿˜ä¸“é—¨å°è£…äº†ä¸€ä¸ªå¤„ç†æ–‡æœ¬æµçš„ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¯»å–æ–‡æœ¬å†…å®¹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç‚¹å‡»é€‰å–æ–‡ä»¶æŒ‰é’®ï¼Œå¼¹å‡ºæ–‡ä»¶å¯¹è¯æ¡†</span></span><br><span class="line"><span class="built_in">connect</span>(ui-&gt;pushButton,&amp;QPushButton::clicked,[=]()&#123;</span><br><span class="line">  QString path=  QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>,<span class="string">&quot;æ‰“å¼€æ–‡ä»¶&quot;</span>,<span class="string">&quot;C:/Users/WFD/Desktop&quot;</span>);</span><br><span class="line">  <span class="comment">//å°†è·¯å¾„æ”¾åœ¨lineEditä¸­</span></span><br><span class="line">  ui-&gt;lineEdit-&gt;<span class="built_in">setText</span>(path);</span><br><span class="line">  <span class="comment">//è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ”¾å…¥textEditä¸­</span></span><br><span class="line">  QFile <span class="built_in">file</span>(path);<span class="comment">//å‚æ•°å°±æ˜¯æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">  <span class="comment">//è®¾ç½®æ‰“å¼€æ–¹å¼</span></span><br><span class="line">  file.<span class="built_in">open</span>(QIODevice::ReadOnly);</span><br><span class="line">  <span class="comment">//ç”¨QTextStreamç±»å»è¯»å–æ–‡æœ¬ä¿¡æ¯</span></span><br><span class="line"> QTextStream <span class="built_in">QS</span>(&amp;file);</span><br><span class="line"> <span class="comment">//ç”¨QStringç±»å»æ¥æ”¶è¯»å–çš„ä¿¡æ¯</span></span><br><span class="line"> QString array=QS.<span class="built_in">readAll</span>();</span><br><span class="line">  <span class="comment">//å°†è¯»å–åˆ°çš„æ•°æ®æ”¾å…¥textEditä¸­</span></span><br><span class="line">  ui-&gt;textEdit-&gt;<span class="built_in">setText</span>(array);</span><br><span class="line">  <span class="comment">//å…³é—­æ–‡ä»¶å¯¹è±¡</span></span><br><span class="line">  file.<span class="built_in">close</span>();</span><br></pre></td></tr></table></figure><h3 id="äºŒã€æ–‡ä»¶å†™æ“ä½œ"><a href="#äºŒã€æ–‡ä»¶å†™æ“ä½œ" class="headerlink" title="äºŒã€æ–‡ä»¶å†™æ“ä½œ"></a><font color="FF0000">äºŒã€æ–‡ä»¶å†™æ“ä½œ</font></h3><p><strong>ï¼ˆ1ï¼‰ä½¿ç”¨QFileç±»</strong></p><p>ä½¿ç”¨QFileåŒæ ·å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå†™æ“ä½œï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d28680b7eb2.png"></p><p><strong>2ï¼‰ä½¿ç”¨QTextStreamç±»</strong></p><p> QTextStreamç±»å¯¹æ“ä½œç¬¦è¿›è¡Œäº†é‡è½½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;&lt; æ“ä½œç¬¦å°†å­—ç¬¦ä¸²æµå…¥æ–‡æœ¬æ–‡ä»¶ï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d2869e099cf.png"></p><h3 id="ä¸‰ã€æ–‡ä»¶ä¿¡æ¯è¯»å–"><a href="#ä¸‰ã€æ–‡ä»¶ä¿¡æ¯è¯»å–" class="headerlink" title="ä¸‰ã€æ–‡ä»¶ä¿¡æ¯è¯»å–"></a><font color="FF0000">ä¸‰ã€æ–‡ä»¶ä¿¡æ¯è¯»å–</font></h3><p>é™¤äº†å¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œï¼ŒQtè¿˜å°è£…äº†QFileInfoç±»å¸®åŠ©æˆ‘ä»¬è·å–æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°ã€åç¼€åã€åˆ›å»ºæ—¶é—´ã€æœ€åä¿®æ”¹æ—¶é—´ç­‰ç­‰ï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d286ffb59dc.png"></p><p><strong>æ‹“å±•ï¼š</strong></p><ul><li><strong>å„ç¼–ç è½¬æ¢</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QString -&gt; QByteArray      QString.<span class="built_in">toUtf8</span>();</span><br><span class="line"></span><br><span class="line">QByteArray -&gt; std::string  QByteArray.<span class="built_in">toStdString</span>();</span><br><span class="line"></span><br><span class="line">std::string -&gt; <span class="type">char</span> *        string.<span class="built_in">date</span>();</span><br></pre></td></tr></table></figure><ul><li><strong>å¸¸ç”¨é™æ€å‡½æ•°</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QFileDialog::<span class="built_in">getOpenFileName</span>()    <span class="comment">//è·å–æŒ‡å®šæ–‡ä»¶è·¯å¾„åè¿”å›QString</span></span><br><span class="line">QFileDialog::<span class="built_in">getExistingDirectory</span>()  <span class="comment">//è·å–æŒ‡å®šè·¯å¾„è¿”å›QString</span></span><br><span class="line">QFileDialog::<span class="built_in">getSaveFileName</span>()    <span class="comment">//è·å–æŒ‡å®šä¿å­˜è·¯å¾„åè¿”å›QString</span></span><br></pre></td></tr></table></figure><p><strong><p align = "center">QTé…ç½®iniæ–‡ä»¶çš„å»ºç«‹ï¼Œè¯»å–ï¼Œå†™å…¥æ“ä½œ</p></strong></p><p><strong>1 iniæ–‡ä»¶ä»‹ç»</strong></p><p>.ini æ–‡ä»¶æ˜¯Initialization Fileçš„ç¼©å†™ï¼Œå³åˆå§‹åŒ–æ–‡ä»¶ã€‚</p><p>é™¤äº†windowsç°åœ¨å¾ˆå¤šå…¶ä»–æ“ä½œç³»ç»Ÿä¸‹é¢çš„åº”ç”¨è½¯ä»¶ä¹Ÿæœ‰.iniæ–‡ä»¶ï¼Œç”¨æ¥é…ç½®åº”ç”¨è½¯ä»¶ä»¥å®ç°ä¸åŒç”¨æˆ·çš„è¦æ±‚ã€‚ä¸€èˆ¬ä¸ç”¨ç›´æ¥ç¼–è¾‘è¿™äº›.iniæ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºçš„å›¾å½¢ç•Œé¢å³å¯æ“ä½œä»¥å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚å®ƒå¯ä»¥ç”¨æ¥å­˜æ”¾è½¯ä»¶ä¿¡æ¯,æ³¨å†Œè¡¨ä¿¡æ¯ç­‰ã€‚</p><p><strong>2 iniæ–‡ä»¶æ ¼å¼</strong></p><p>INIæ–‡ä»¶ç”±èŠ‚ã€é”®ã€å€¼ç»„æˆã€‚ </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">èŠ‚</span><br><span class="line"></span><br><span class="line">ã€€ã€€[section] </span><br><span class="line"></span><br><span class="line">å‚æ•°ï¼ˆé”®=å€¼ï¼‰</span><br><span class="line"></span><br><span class="line">name=value</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ªiniæ–‡ä»¶çš„ä¾‹å­</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Section1 Name] ã€€ã€€</span><br><span class="line"></span><br><span class="line">KeyName1=value1 ã€€ã€€</span><br><span class="line"></span><br><span class="line">KeyName2=value2 ã€€ã€€</span><br><span class="line"></span><br><span class="line">... ã€€ã€€</span><br><span class="line"></span><br><span class="line">[Section2 Name] ã€€ã€€</span><br><span class="line"></span><br><span class="line">KeyName21=value21 ã€€ã€€</span><br><span class="line"></span><br><span class="line">KeyName22=value22 ã€€ã€€</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š[Section1 Name]ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªæ®µè½ã€‚å› ä¸ºINIæ–‡ä»¶å¯èƒ½æ˜¯é¡¹ç›®ä¸­å…±ç”¨çš„ï¼Œæ‰€ä»¥ä½¿ç”¨[Section Name]æ®µåæ¥åŒºåˆ†ä¸åŒç”¨é€”çš„å‚æ•°åŒºã€‚ä¾‹å¦‚ï¼š[Section1 Name]è¡¨ç¤ºä¼ æ„Ÿå™¨çµæ•åº¦å‚æ•°åŒºï¼›[Section2 Name]è¡¨ç¤ºæµ‹é‡é€šé“å‚æ•°åŒºç­‰ç­‰ã€‚</p><p>æ³¨è§£ï¼šä½¿ç”¨åˆ†å·è¡¨ç¤ºï¼ˆ;ï¼‰ã€‚åœ¨åˆ†å·åé¢çš„æ–‡å­—ï¼Œç›´åˆ°è¯¥è¡Œç»“å°¾éƒ½å…¨éƒ¨ä¸ºæ³¨è§£ã€‚</p><p><strong>3 Qtå†™iniæ–‡ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QSettings&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    <span class="comment">//Qtä¸­ä½¿ç”¨QSettingsç±»è¯»å†™iniæ–‡ä»¶</span></span><br><span class="line">    <span class="comment">//QSettingsæ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯iniæ–‡ä»¶çš„è·¯å¾„,ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºé’ˆå¯¹iniæ–‡ä»¶,ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥ç¼ºçœ</span></span><br><span class="line">    QSettings *configIniWrite = <span class="keyword">new</span> <span class="built_in">QSettings</span>(<span class="string">&quot;hahaya.ini&quot;</span>, QSettings::IniFormat);</span><br><span class="line">    <span class="comment">//å‘iniæ–‡ä»¶ä¸­å†™å…¥å†…å®¹,setValueå‡½æ•°çš„ä¸¤ä¸ªå‚æ•°æ˜¯é”®å€¼å¯¹</span></span><br><span class="line">    <span class="comment">//å‘iniæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªèŠ‚å†™å…¥å†…å®¹,ipèŠ‚ä¸‹çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">    configIniWrite-&gt;<span class="built_in">setValue</span>(<span class="string">&quot;/ip/first&quot;</span>, <span class="string">&quot;192.168.0.1&quot;</span>);</span><br><span class="line">    <span class="comment">//å‘iniæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªèŠ‚å†™å…¥å†…å®¹,ipèŠ‚ä¸‹çš„ç¬¬äºŒä¸ªå‚æ•°</span></span><br><span class="line">    configIniWrite-&gt;<span class="built_in">setValue</span>(<span class="string">&quot;ip/second&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">    <span class="comment">//å‘iniæ–‡ä»¶çš„ç¬¬äºŒä¸ªèŠ‚å†™å…¥å†…å®¹,portèŠ‚ä¸‹çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">    configIniWrite-&gt;<span class="built_in">setValue</span>(<span class="string">&quot;port/open&quot;</span>, <span class="string">&quot;2222&quot;</span>);</span><br><span class="line">    <span class="comment">//å†™å…¥å®Œæˆååˆ é™¤æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">delete</span> configIniWrite;</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºåï¼Œæ‰“å¼€ç¨‹åºç›®å½•ä¸‹çš„hahaya.iniæ–‡ä»¶ï¼Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d287cd1be9a.png"></p><p> <strong>4 Qtè¯»iniæ–‡ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QSettings&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">      <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">      QSettings *configIniRead = <span class="keyword">new</span> <span class="built_in">QSettings</span>(<span class="string">&quot;hahaya.ini&quot;</span>, QSettings::IniFormat);</span><br><span class="line">      <span class="comment">//å°†è¯»å–åˆ°çš„iniæ–‡ä»¶ä¿å­˜åœ¨QStringä¸­ï¼Œå…ˆå–å€¼ï¼Œç„¶åé€šè¿‡toString()å‡½æ•°è½¬æ¢æˆQStringç±»å‹</span></span><br><span class="line">      QString ipResult = configIniRead-&gt;<span class="built_in">value</span>(<span class="string">&quot;/ip/second&quot;</span>).<span class="built_in">toString</span>();</span><br><span class="line">      QString portResult = configIniRead-&gt;<span class="built_in">value</span>(<span class="string">&quot;/port/open&quot;</span>).<span class="built_in">toString</span>();</span><br><span class="line">      <span class="comment">//æ‰“å°å¾—åˆ°çš„ç»“æœ</span></span><br><span class="line">      <span class="built_in">qDebug</span>() &lt;&lt; ipResult;</span><br><span class="line">      <span class="built_in">qDebug</span>() &lt;&lt; portResult;</span><br><span class="line">      <span class="comment">//è¯»å…¥å…¥å®Œæˆååˆ é™¤æŒ‡é’ˆ</span></span><br><span class="line">      <span class="keyword">delete</span> configIniRead;</span><br><span class="line">      <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d287e4a3dc2.png"></p><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt02ä¿¡å·å’Œæ§½</title>
      <link href="/2025/03/13/Qt02%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD/"/>
      <url>/2025/03/13/Qt02%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€ã€ä¿¡å·å’Œæ§½æœºåˆ¶åˆ†æ"><a href="#ä¸€ã€ä¿¡å·å’Œæ§½æœºåˆ¶åˆ†æ" class="headerlink" title="ä¸€ã€ä¿¡å·å’Œæ§½æœºåˆ¶åˆ†æ"></a><font color="FF0000">ä¸€ã€ä¿¡å·å’Œæ§½æœºåˆ¶åˆ†æ</font></h3><p>â€‹<strong>ä¿¡å·</strong>ï¼ˆSignalï¼‰å°±æ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹è¢«å‘å°„çš„äº‹ä»¶ï¼Œä¾‹å¦‚PushButton æœ€å¸¸è§çš„ä¿¡å·å°±æ˜¯é¼ æ ‡å•å‡»æ—¶å‘å°„çš„ clicked() ä¿¡å·ï¼Œä¸€ä¸ª ComboBox æœ€å¸¸è§çš„ä¿¡å·æ˜¯é€‰æ‹©çš„åˆ—è¡¨é¡¹å˜åŒ–æ—¶å‘å°„çš„ CurrentIndexChanged() ä¿¡å·ã€‚</p><p>â€‹GUI ç¨‹åºè®¾è®¡çš„ä¸»è¦å†…å®¹å°±æ˜¯å¯¹ç•Œé¢ä¸Šå„ç»„ä»¶çš„ä¿¡å·çš„å“åº”ï¼Œåªéœ€è¦çŸ¥é“ä»€ä¹ˆæƒ…å†µä¸‹å‘å°„å“ªäº›ä¿¡å·ï¼Œåˆç†åœ°å»å“åº”å’Œå¤„ç†è¿™äº›ä¿¡å·å°±å¯ä»¥äº†ã€‚</p><p>â€‹<strong>æ§½</strong>ï¼ˆSlotï¼‰å°±æ˜¯å¯¹ä¿¡å·å“åº”çš„å‡½æ•°ã€‚æ§½å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸ä¸€èˆ¬çš„C++å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥å®šä¹‰åœ¨ç±»çš„ä»»ä½•éƒ¨åˆ†ï¼ˆpublicã€private æˆ– protectedï¼‰ï¼Œå¯ä»¥å…·æœ‰ä»»ä½•å‚æ•°ï¼Œä¹Ÿå¯ä»¥è¢«ç›´æ¥è°ƒç”¨ã€‚æ§½å‡½æ•°ä¸ä¸€èˆ¬çš„å‡½æ•°ä¸åŒçš„æ˜¯ï¼šæ§½å‡½æ•°å¯ä»¥ä¸ä¸€ä¸ªä¿¡å·å…³è”ï¼Œå½“ä¿¡å·è¢«å‘å°„æ—¶ï¼Œå…³è”çš„æ§½å‡½æ•°è¢«è‡ªåŠ¨æ‰§è¡Œã€‚</p><p>â€‹ä¿¡å·ä¸æ§½å…³è”æ˜¯ç”¨ QObject::connect() å‡½æ•°å®ç°çš„ï¼Œå…¶åŸºæœ¬æ ¼å¼æ˜¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QObject::<span class="built_in">connect</span>(sender, <span class="built_in">SIGNAL</span>(<span class="built_in">signal</span>()), receiver, <span class="built_in">SLOT</span>(<span class="built_in">slot</span>()));</span><br><span class="line"><span class="built_in">connect</span>(å‘å‡ºä¿¡å·çš„å¯¹è±¡ï¼Œå‘å‡ºçš„ä¿¡å·ï¼Œæ¥æ”¶ä¿¡å·çš„å¯¹è±¡ï¼Œæ¥æ”¶åˆ°ä¿¡å·ä¹‹åéœ€è¦è°ƒç”¨çš„å‡½æ•°ï¼ˆæ§½å‡½æ•°ï¼‰ï¼‰</span><br></pre></td></tr></table></figure><p><strong>connect()å‡½æ•°æœ€å¸¸ç”¨çš„ä¸€èˆ¬å½¢å¼ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(sender, <span class="built_in">signal</span>(ä¿¡å·ï¼‰, receiver, slotï¼ˆæ§½ï¼‰);</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2025/03/13/67d27c859f78b.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºç¬¬ä¸€ä¸ªæŒ‰é’®</span></span><br><span class="line">  QPushButton *btn=<span class="keyword">new</span> QPushButton;</span><br><span class="line">  <span class="comment">//ä¸èƒ½ç”¨btn-&gt;show();//showæ˜¯ä»¥é¡¶å±‚æ–¹å¼å¼¹å‡ºæ§ä»¶</span></span><br><span class="line">  <span class="comment">//è®©btnåœ¨widgetçª—å£æ˜¾ç¤º</span></span><br><span class="line">  btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//thisæŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆï¼ˆå³widgetçš„åœ°å€ï¼‰</span></span><br><span class="line">  <span class="comment">//æ˜¾ç¤ºæ–‡æœ¬</span></span><br><span class="line">  btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;å…³é—­çª—å£&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ç”¨ä¿¡å·å’Œæ§½å»å®ç°ç‚¹å‡»æŒ‰é’®å…³é—­çª—å£</span></span><br><span class="line">  <span class="built_in">connect</span>(btn,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;QWidget::close);</span><br></pre></td></tr></table></figure><h3 id="äºŒã€è‡ªå®šä¹‰ä¿¡å·æ§½"><a href="#äºŒã€è‡ªå®šä¹‰ä¿¡å·æ§½" class="headerlink" title="äºŒã€è‡ªå®šä¹‰ä¿¡å·æ§½"></a><font color="FF0000">äºŒã€è‡ªå®šä¹‰ä¿¡å·æ§½</font></h3><p>1ã€å®šä¹‰è‡ªå®šä¹‰ä¿¡å·</p><p>åœ¨è¿™ä¸ªçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å…ˆè®¾å®šä¸€ä¸ªéœ€æ±‚ï¼šå±Œä¸ç”·å‘å‘ç™½å¯Œç¾è¡¨ç™½ï¼Œå‘é€è¡¨ç™½ä¿¡å·ï¼Œç™½å¯Œç¾æ¥æ”¶ä¿¡å·ï¼Œå¹¶å›åº”åŒæ„ã€‚</p><p>è¿™é‡Œé¢æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªå±Œä¸ç”·ï¼Œä¸€ä¸ªç™½å¯Œç¾ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è‡ªå®šä¹‰çš„ä¿¡å·å’Œæ§½å°†ä»–ä»¬è”ç³»èµ·æ¥ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d27ebd77f3f.png"></p><p>ç±»åè‡ªå®šä¹‰ä¸ºboyï¼Œé€‰æ‹©QObjectä¸ºåŸºç±»æ˜¯ä¸ºäº†å°†æ­¤ç±»åŠ å…¥qt childrenä¸­ï¼Œè€Œ QObject æ˜¯æœ€åŸºæœ¬çš„ç±»ã€‚ä»¥åŒæ ·çš„æ–¹å¼åˆ›å»ºGirlç±»ã€‚</p><p>2ã€åœ¨boyç±»ä¸­åŠ å…¥è‡ªå®šä¹‰ä¿¡å·</p><p><img src="https://bu.dusays.com/2025/03/14/67d3e97f319ca.png"></p><p>3ã€ åœ¨Girlç±»å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶æ·»åŠ è‡ªå®šä¹‰æ§½å‡½æ•°çš„å®šä¹‰å’Œå®ç°</p><p><img src="https://bu.dusays.com/2025/03/14/67d3ea0b48134.png"></p><p><img src="https://bu.dusays.com/2025/03/14/67d3ea110e236.png"></p><p>4ã€ åœ¨widget.hä¸­çš„widgetç±»ä¸­æ·»åŠ ä¸¤ä¸ªæˆå‘˜ï¼Œä¸€ä¸ªboyå¯¹è±¡xggï¼ˆå°å“¥å“¥ï¼‰ï¼Œgirlå¯¹è±¡xjjï¼ˆå°å§å§ï¼‰ä¸¤ä¸ªæŒ‡é’ˆã€‚</p><p><img src="https://bu.dusays.com/2025/03/14/67d3ea460c19f.png"></p><p>5ã€ åœ¨widget.cppä¸­newå‡ºå¯¹è±¡å¹¶æ·»åŠ è¿æ¥ã€‚</p><p><img src="https://bu.dusays.com/2025/03/07/67cad87144911.png"></p><p>6ã€ è¿è¡Œç¨‹åºï¼Œç¨‹åºåœ¨è¡¨ç™½å‡½æ•°ä¸­å‘é€ç¤ºçˆ±ä¿¡æ¯ï¼Œæ¥æ”¶è€…æ”¶åˆ°ä¿¡æ¯å¹¶æ‰§è¡Œç›¸åº”çš„æ§½å‡½æ•°ã€‚</p><p>è¿è¡Œç»“æœï¼šæ‰“å°å‡ºäº†æ§½å‡½æ•°ä¸­çš„ä¿¡æ¯ã€‚å®ç°äº†è‡ªå®šä¹‰çš„ä¿¡å·å’Œæ§½å‡½æ•°</p><p><img src="https://bu.dusays.com/2025/03/14/67d3ea8da7844.png"></p><p>7ã€ æ€»ç»“ï¼šè‡ªå®šä¹‰ä¿¡å·å’Œæ§½çš„åŒºåˆ«ï¼Œ<strong>ä¿¡å·å’Œæ§½éƒ½ä¸ºvoidç±»å‹</strong>ï¼Œä¿¡å·åªéœ€è¦å®šä¹‰ï¼Œ<strong>ä¸éœ€è¦å®ç°</strong>ï¼Œè€Œæ§½å‡½æ•°<strong>æ—¢éœ€è¦å®šä¹‰ï¼Œä¹Ÿéœ€è¦å®ç°</strong>ï¼Œ<strong>ä¿¡å·å’Œæ§½éƒ½å¯ä»¥æœ‰å‚æ•°ä¹Ÿéƒ½å¯ä»¥é‡è½½</strong>ã€‚emitæ˜¯å‡ºå‘ä¿¡å·çš„æ ‡å¿—ï¼Œå¯è¦å¯ä¸è¦ã€‚</p><h3 id="ä¸‰ã€è‡ªå®šä¹‰ä¿¡å·å’Œæ§½å‘ç”Ÿé‡è½½å¦‚ä½•è§£å†³ï¼Ÿ"><a href="#ä¸‰ã€è‡ªå®šä¹‰ä¿¡å·å’Œæ§½å‘ç”Ÿé‡è½½å¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="ä¸‰ã€è‡ªå®šä¹‰ä¿¡å·å’Œæ§½å‘ç”Ÿé‡è½½å¦‚ä½•è§£å†³ï¼Ÿ"></a><font color="FF0000">ä¸‰ã€è‡ªå®šä¹‰ä¿¡å·å’Œæ§½å‘ç”Ÿé‡è½½å¦‚ä½•è§£å†³ï¼Ÿ</font></h3><p>è‡ªå®šä¹‰çš„ä¿¡å·å’Œæ§½<strong>å¯ä»¥å¸¦å‚æ•°</strong>ï¼Œ<strong>å¯ä»¥é‡è½½</strong>ï¼Œä½†æ˜¯é‡è½½ï¼ˆæˆ–è€…å¸¦å‚æ•°ï¼‰åå¦‚ä½•å»ç”¨connectå…³è”å‘¢ï¼Ÿ</p><p>é¦–å…ˆçœ‹éœ€æ±‚ï¼Œé«˜å¯Œå¸…è¡¨ç™½æˆåŠŸåï¼Œä»–ä»¬å°±å¾ˆæœ‰é»˜å¥‘äº†ã€‚ä»–ä»¬å°±è¦çº¦ä¼šå¯¹ä¸ä¼šï¼Œç”·çš„æƒ³è¯´æˆ‘ä»¬å»çœ‹ç”µå½±å§ï¼Œå¥³å­©å°±å¾ˆå¬ç”·çš„è¯ï¼Œæ”¶åˆ°ä¿¡å·åï¼Œå°±åŒæ„ç”·å­©ï¼Œæˆ‘ä»¬å°±å»çœ‹ç”µå½±ï¼Œå°±æ˜¯ç”·å­©è¯´ä»€ä¹ˆï¼Œå¥³å­©å°±åŒæ„ç”·å­©ä¹Ÿè¯´ä»€ä¹ˆï¼Œè¿™ä¹‹é—´çš„è¯ï¼Œå°±é€šè¿‡ä¿¡å·çš„å‚æ•°æ¥ä¼ é€’ã€‚</p><p>å¥½ï¼Œè¿˜æ˜¯æ¥åˆ°æˆ‘ä»¬ä¸ŠèŠ‚è¯¾çš„é¡¹ç›®ã€‚</p><p>1ã€ åœ¨boy.hçš„signalsä¸‹é‡è½½loveå‡½æ•°ï¼Œå¸¦ä¸€ä¸ªQStringå‚æ•°ï¼Œå°±æ˜¯è¿™ä¸ªä¼ è¿‡å»ä¸€å¥è¯ï¼Œå¥³å­©ä¹Ÿè¯´è¿™å¥è¯ã€‚</p><p><img src="https://bu.dusays.com/2025/03/14/67d3eb6b3233b.png"></p><p>è®°ä½ï¼Œè¿™ä¸ªä¿¡å·åªéœ€è¦å®šä¹‰ï¼Œä¸éœ€è¦å®ç°ï¼Œåªè¦çŸ¥é“å®šä¹‰äº†è¿™ä¹ˆä¸€ä¸ªå¸¦ä¸€ä¸ªå‚æ•°çš„ä¿¡å·å°±è¡Œäº†ã€‚è§¦å‘è¿™ä¸ªä¿¡å·ï¼Œè¿˜éœ€è¦ä¸€ä¸ªQStringçš„å‚æ•°ã€‚</p><p>2ã€ åœ¨girl.cppä¹Ÿé‡è½½ä¸€ä¸ªå¸¦å‚æ•°çš„å›åº”çš„æ§½å‡½æ•°</p><p><img src="https://bu.dusays.com/2025/03/14/67d3eafc0227e.png"></p><p><img src="https://bu.dusays.com/2025/03/14/67d3eb4298513.png"></p><p>åœ¨å®ç°çš„å‡½æ•°ï¼Œå°†å‚æ•°è¾“å‡º</p><p>3ã€ å›åˆ°widget.cppä¸­ä¼šå‘ç°åŸæ¥å†™å¥½çš„æ²¡é—®é¢˜çš„connectå‡½æ•°æœ‰é”™è¯¯äº†ã€‚</p><p><img src="https://bu.dusays.com/2025/03/07/67cadb9162646.png"></p><p><img src="https://bu.dusays.com/2025/03/14/67d3ebb51a45e.png"></p><p>ç¼–è¯‘åå‘ç°é”™è¯¯ï¼Œé‡è½½å‡½æ•°æœ‰æ­§ä¹‰é”™è¯¯ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Œä¿¡å·å’Œæ§½çš„è¿æ¥å‡½æ•°ä¸­ï¼Œå°±æ˜¯ä¸€ä¸ªå‡½æ•°åï¼Œä¹Ÿå°±æ˜¯å‡½æ•°åœ°å€ï¼Œæœ‰æ²¡æœ‰å‘ç°ï¼Œæˆ‘ä»¬åœ¨é‡è½½ä¹‹åï¼Œå°±æœ‰äº†ä¸¤ä¸ªloveä¿¡å·ï¼Œä¹Ÿæœ‰äº†ä¸¤ä¸ªlovetooæ§½ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œåˆ°åº•æŒ‡çš„æ˜¯å“ªä¸€ä¸ªå‘¢ï¼Ÿè¿™å°±è®©ç¼–è¯‘å™¨ä¸ºéš¾äº†ã€‚</p><p>4ã€ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¦å‚æ•°çš„å‡½æ•°æŒ‡é’ˆæ¥æŒ‡å‘æˆ‘ä»¬æ‰€è¦æŒ‡å‘çš„é‚£ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå°±å¯ä»¥æ¶ˆé™¤æ­§ä¹‰ã€‚</p><p><img src="https://bu.dusays.com/2025/03/14/67d3ec0d033cf.png"></p><p>è¿™æ ·å­å°±æ¶ˆé™¤é”™è¯¯äº†ã€‚å¯ä»¥ç¼–è¯‘é€šè¿‡ï¼Œå¹¶è¿è¡Œã€‚</p><p>5ã€ ä½†æ˜¯æˆ‘å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ ·èƒ½è¿è¡Œï¼Œä½†æ˜¯å°±ä»€ä¹ˆè¾“å‡ºéƒ½æ²¡äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘å·²ç»æŠŠå‰é¢çš„è¿æ¥å‡½æ•°æ³¨é‡Šäº†ï¼Œæˆ‘ä»¬è¿æ¥çš„å¸¦å‚æ•°çš„ä¿¡å·ï¼Œè€Œæˆ‘ä»¬åŸæ¥çš„å‡ºå‘ä¿¡å·çš„å‡½æ•°æ˜¯æ²¡æœ‰å¸¦å‚æ•°çš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºå‘è¿™ä¸ªå¸¦å‚æ•°çš„ä¿¡å·ï¼Œä¿¡å·æ˜¯å¯ä»¥å¤šæ¬¡å‡ºå‘çš„ï¼Œæˆ‘ä»¬åœ¨è¡¨ç™½çš„å‡½æ•°ä¸­å‡ºå‘ä¸€ä¸ªå¸¦å‚æ•°çš„ä¿¡å·</p><p><img src="https://bu.dusays.com/2025/03/14/67d3ec52acb19.png"></p><p>å†è¿è¡Œ</p><p><img src="https://bu.dusays.com/2025/03/14/67d3ec6b5ced4.png"></p><p>è¿™å°±èƒ½çœ‹åˆ°å¥³å­©é‚£è¾¹å›åº”çš„ä¹Ÿæ˜¯åŒæ ·çš„ä¸€å¥è¯ã€‚è¯´æ˜ä¿¡å·è·‘é€šäº†ã€‚</p><p>6ã€ æ€»ç»“ï¼šæ³¨æ„ä¿¡å·é‡è½½å‡½æ•°æŒ‡é’ˆæŒ‡å‘å“ªä¸€ä¸ªå‡½æ•°çš„é—®é¢˜ï¼Œå¯¹äºé‡è½½å‡½æ•°çš„ä¿¡å·è¿æ¥ï¼Œè¦æŒ‡æ˜åˆ°åº•è¿æ¥çš„æ˜¯å“ªä¸€ä¸ªï¼Ÿ</p><h3 id="å››ã€ä¿¡å·è¿æ¥ä¿¡å·"><a href="#å››ã€ä¿¡å·è¿æ¥ä¿¡å·" class="headerlink" title="å››ã€ä¿¡å·è¿æ¥ä¿¡å·"></a><font color="FF0000">å››ã€ä¿¡å·è¿æ¥ä¿¡å·</font></h3><p>è¿™éƒ¨åˆ†ä¸æ”¾ä»£ç äº†ï¼Œè‡ªå·±å°è¯•ç€å®è·µã€‚</p><ol><li>ä¿¡å·å¯ä»¥è¿æ¥ä¿¡å·</li><li>ä¸€ä¸ªä¿¡å·å¯ä»¥è¿æ¥å¤šä¸ªæ§½ï¼ˆç‚¹å‡»æŒ‰é’®ï¼Œè§¦å‘ä¿¡å·å¹¶å…³é—­çª—å£ï¼‰</li><li>å¤šä¸ªä¿¡å·å¯ä»¥è¿æ¥åŒä¸€ä¸ªæ§½ï¼ˆæ¯”å¦‚å¤šä¸ªæŒ‰é’®éƒ½å¯ä»¥å…³é—­çª—å£ï¼‰</li><li>è‡ªå®šä¹‰æ§½å‡½æ•°å¯ä»¥å†™æˆï¼š<ol><li>ç±»çš„ä»»æ„æˆå‘˜å‡½æ•°</li><li>é™æ€å‡½æ•°</li><li>å…¨å±€å‡½æ•°</li><li>lambdaè¡¨è¾¾å¼</li></ol></li></ol><p><strong>å½’æ ¹ç©¶åº•ï¼šè¿æ¥çš„åŸåˆ™å°±æ˜¯ä¿¡å·å’Œæ§½çš„å‚æ•°å¿…é¡»ä¸€ä¸€å¯¹åº”ï¼ï¼</strong></p><h3 id="äº”ã€lambadè¡¨è¾¾å¼"><a href="#äº”ã€lambadè¡¨è¾¾å¼" class="headerlink" title="äº”ã€lambadè¡¨è¾¾å¼"></a><font color="FF0000">äº”ã€lambadè¡¨è¾¾å¼</font></h3><p>è¡¨è¾¾å¼ç”¨äºå®šä¹‰å¹¶åˆ›å»ºåŒ¿åçš„å‡½æ•°å¯¹è±¡ï¼Œä»¥ç®€åŒ–ç¼–ç¨‹å·¥ä½œã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[å‡½æ•°å¯¹è±¡å‚æ•°](æ“ä½œç¬¦é‡è½½å‡½æ•°å‚æ•°)<span class="keyword">mutable</span>æˆ–exception-&gt;è¿”å›å€¼</span><br><span class="line">&#123;</span><br><span class="line">å‡½æ•°ä½“</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>1ï¸âƒ£å‡½æ•°å¯¹è±¡å‚æ•°</strong></p><p>[ ]ï¼Œæ ‡è¯†ä¸€ä¸ª Lambda çš„å¼€å§‹ï¼Œè¿™éƒ¨åˆ†å¿…é¡»å­˜åœ¨ï¼Œä¸èƒ½çœç•¥ã€‚å‡½æ•°å¯¹è±¡å‚æ•° æ˜¯ä¼ é€’ç»™ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°å¯¹è±¡ç±»çš„æ„é€ å‡½æ•°çš„ã€‚å‡½æ•°å¯¹è±¡å‚æ•°åªèƒ½ä½¿ ç”¨é‚£äº›åˆ°å®šä¹‰ Lambda ä¸ºæ­¢æ—¶ Lambda æ‰€åœ¨ä½œç”¨èŒƒå›´å†…å¯è§çš„å±€éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬ Lambda æ‰€åœ¨ç±»çš„ thisï¼‰ã€‚å‡½æ•°å¯¹è±¡å‚æ•°æœ‰ä»¥ä¸‹å½¢å¼ï¼šï¼ˆå¸¸ç”¨çš„å°±æ˜¯&#x3D; &amp; this aï¼‰</p><ul><li><strong>ç©º</strong>ã€‚æ²¡æœ‰ä½¿ç”¨ä»»ä½•å‡½æ•°å¯¹è±¡å‚æ•°ã€‚</li><li><strong>&#x3D;</strong>ã€‚å‡½æ•°ä½“å†…å¯ä»¥ä½¿ç”¨ Lambda æ‰€åœ¨ä½œç”¨èŒƒå›´å†…æ‰€æœ‰å¯è§çš„å±€éƒ¨å˜é‡ï¼ˆåŒ… æ‹¬ Lambda æ‰€åœ¨ç±»çš„ thisï¼‰ï¼Œå¹¶ä¸”æ˜¯<strong>å€¼ä¼ é€’æ–¹å¼</strong>ï¼ˆç›¸å½“äºç¼–è¯‘å™¨è‡ªåŠ¨ä¸ºæˆ‘ ä»¬æŒ‰å€¼ä¼ é€’äº†æ‰€æœ‰å±€éƒ¨å˜é‡ï¼‰ã€‚</li><li><strong>&amp;</strong>ã€‚å‡½æ•°ä½“å†…å¯ä»¥ä½¿ç”¨ Lambda æ‰€åœ¨ä½œç”¨èŒƒå›´å†…æ‰€æœ‰å¯è§çš„å±€éƒ¨å˜é‡ï¼ˆåŒ… æ‹¬ Lambda æ‰€åœ¨ç±»çš„ thisï¼‰ï¼Œå¹¶ä¸”æ˜¯<strong>å¼•ç”¨ä¼ é€’æ–¹å¼</strong>ï¼ˆç›¸å½“äºç¼–è¯‘å™¨è‡ªåŠ¨ä¸º æˆ‘ä»¬æŒ‰å¼•ç”¨ä¼ é€’äº†æ‰€æœ‰å±€éƒ¨å˜é‡ï¼‰ã€‚</li><li><strong>this</strong>ã€‚å‡½æ•°ä½“å†…å¯ä»¥ä½¿ç”¨ Lambda æ‰€åœ¨ç±»ä¸­çš„æˆå‘˜å˜é‡ã€‚</li><li><strong>a</strong>ã€‚å°† a æŒ‰å€¼è¿›è¡Œä¼ é€’ã€‚æŒ‰å€¼è¿›è¡Œä¼ é€’æ—¶ï¼Œå‡½æ•°ä½“å†…ä¸èƒ½ä¿®æ”¹ä¼ é€’è¿›æ¥çš„ a çš„æ‹·è´ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹å‡½æ•°æ˜¯ const çš„ã€‚è¦ä¿®æ”¹ä¼ é€’è¿›æ¥çš„ a çš„æ‹·è´ï¼Œå¯ä»¥æ·»åŠ  mutable ä¿®é¥°ç¬¦ã€‚</li><li><strong>&amp;a</strong>ã€‚å°† a æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ã€‚</li><li><strong>a, &amp;b</strong>ã€‚å°† a æŒ‰å€¼è¿›è¡Œä¼ é€’ï¼Œb æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ã€‚</li><li><strong>&#x3D;ï¼Œ&amp;a, &amp;b</strong>ã€‚é™¤ a å’Œ b æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’å¤–ï¼Œå…¶ä»–å‚æ•°éƒ½æŒ‰å€¼è¿›è¡Œä¼ é€’ã€‚</li><li><strong>&amp;, a, b</strong>ã€‚é™¤ a å’Œ b æŒ‰å€¼è¿›è¡Œä¼ é€’å¤–ï¼Œå…¶ä»–å‚æ•°éƒ½æŒ‰å¼•ç”¨è¿›è¡Œä¼ é€’ã€‚</li></ul><p><strong>å¦‚ä½•ç”¨lambdaè¡¨è¾¾å¼å»ä¿®æ”¹æŒ‰é’®çš„åç§°ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‡½æ•°å¯¹è±¡å‚æ•°: =</span></span><br><span class="line">[=]()&#123;</span><br><span class="line">         btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;aaaa&quot;</span>);</span><br><span class="line">     &#125;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°å¯¹è±¡å‚æ•°:a</span></span><br><span class="line">     [btn]()&#123;</span><br><span class="line">          btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;aaaa&quot;</span>);</span><br><span class="line">   <span class="comment">//ç”±äºå‡½æ•°å¯¹è±¡å‚æ•°ä¸ºbtnï¼Œå› æ­¤åªèƒ½å¯¹btnæ“ä½œï¼Œå¼•å…¥btn1ä¼šæŠ¥é”™</span></span><br><span class="line">          <span class="comment">//btn1-&gt;setText(&quot;bbbb&quot;);</span></span><br><span class="line">      &#125;();</span><br></pre></td></tr></table></figure><p><font color="FF0000"><strong>æ³¨æ„ï¼š</strong></font>ä¸åŠ ( )åªæ˜¯å¯¹lambadè¡¨è¾¾å¼çš„å£°æ˜ï¼ŒåŠ ä¸Š( )æ‰æ˜¯å¯¹å®ƒçš„è°ƒç”¨ã€‚ï¼ˆç”±äºbtnåœ¨åˆ›å»ºçš„æ—¶å€™lambadä½œç”¨èŒƒå›´å†…æ˜¯ä¸å¯è§çš„ï¼Œå› æ­¤éœ€è¦ç”¨&#x3D;è®©lambadè¡¨è¾¾å¼è®¤è¯†btnè¿™ä¸ªå±€éƒ¨å˜é‡ï¼‰</p><p><strong>2ï¸âƒ£æ“ä½œç¬¦é‡è½½å‡½æ•°å‚æ•°</strong></p><p>æ ‡è¯†é‡è½½çš„()æ“ä½œç¬¦çš„å‚æ•°ï¼Œæ²¡æœ‰å‚æ•°æ—¶ï¼Œè¿™éƒ¨åˆ†å¯ä»¥çœç•¥ã€‚å‚æ•°å¯ä»¥é€šè¿‡ æŒ‰å€¼ï¼ˆå¦‚ï¼š(a,b)ï¼‰å’ŒæŒ‰å¼•ç”¨ï¼ˆå¦‚ï¼š(&amp;a,&amp;b)ï¼‰ä¸¤ç§æ–¹å¼è¿›è¡Œä¼ é€’</p><p><strong>3ï¸âƒ£å¯ä¿®æ”¹æ ‡ç¤ºç¬¦</strong></p><p>mutable å£°æ˜ï¼Œè¿™éƒ¨åˆ†å¯ä»¥çœç•¥ã€‚æŒ‰å€¼ä¼ é€’å‡½æ•°å¯¹è±¡å‚æ•°æ—¶ï¼ŒåŠ ä¸Š mutable ä¿®é¥°ç¬¦åï¼Œå¯ä»¥ä¿®æ”¹æŒ‰å€¼ä¼ é€’è¿›æ¥çš„æ‹·è´ï¼ˆæ³¨æ„æ˜¯èƒ½ä¿®æ”¹æ‹·è´ï¼Œè€Œä¸æ˜¯å€¼æœ¬èº«ï¼‰</p><p><strong>4ï¸âƒ£é”™è¯¯æŠ›å‡ºæ ‡ç¤ºç¬¦</strong></p><p>exception å£°æ˜ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå¯ä»¥çœç•¥ã€‚exception å£°æ˜ç”¨äºæŒ‡å®šå‡½æ•°æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¦‚æŠ›å‡ºæ•´æ•°ç±»å‹çš„å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ throw(intï¼‰</p><p><strong>5ï¸âƒ£å‡½æ•°è¿”å›å€¼</strong></p><p>-&gt; è¿”å›å€¼ç±»å‹ï¼Œæ ‡è¯†å‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œå½“è¿”å›å€¼ä¸º voidï¼Œæˆ–è€…å‡½æ•°ä½“ä¸­åªæœ‰ä¸€å¤„ return çš„åœ°æ–¹ï¼ˆæ­¤æ—¶ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨æ¨æ–­å‡ºè¿”å›å€¼ç±»å‹ï¼‰æ—¶ï¼Œè¿™éƒ¨åˆ†å¯ä»¥çœç•¥ã€‚</p><p><strong>å¦‚</strong>ï¼šintä¸€ä¸ªretå»æ¥æ”¶lanbdaè¡¨è¾¾å¼è¿”å›çš„ç»“æœï¼ˆæ³¨æ„ï¼šè¦ç”¨-&gt;æ ‡è¯†è¿”å›å€¼çš„ç±»å‹ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ret=[]()-&gt;<span class="type">int</span>&#123;<span class="keyword">return</span> <span class="number">1000</span>;&#125;();</span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;ret=:&quot;</span>&lt;&lt;ret;ã€€ã€€</span><br></pre></td></tr></table></figure><p><strong>6ï¸âƒ£å‡½æ•°ä½“</strong></p><p>{ }ï¼Œæ ‡è¯†å‡½æ•°çš„å®ç°ï¼Œè¿™éƒ¨åˆ†ä¸èƒ½çœç•¥ï¼Œä½†å‡½æ•°ä½“å¯ä»¥ä¸ºç©º</p><p><strong>ğŸ’›ğŸ’›ğŸ’›æ§½å‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">//åˆ›å»ºä¸¤ä¸ªæŒ‰é’®</span></span><br><span class="line"> QPushButton *myBtn = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="keyword">this</span>);</span><br><span class="line"> QPushButton *myBtn1 = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="keyword">this</span>);</span><br><span class="line"> <span class="comment">//ç§»åŠ¨ç¬¬äºŒä¸ªæŒ‰é’®</span></span><br><span class="line"> myBtn1-&gt;<span class="built_in">move</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line"> <span class="type">int</span> m =<span class="number">10</span>;</span><br><span class="line"> <span class="comment">//ç”¨æ§½å‡½æ•°ï¼ˆlambdaè¡¨è¾¾å¼ï¼‰æ”¹å˜mçš„copyå€¼</span></span><br><span class="line"> <span class="built_in">connect</span>(myBtn,&amp;QPushButton::clicked,<span class="keyword">this</span>,[m]()<span class="keyword">mutable</span>&#123;m=<span class="number">100</span> + <span class="number">10</span>;<span class="built_in">qDebug</span>() &lt;&lt; m;&#125;);</span><br><span class="line"> <span class="built_in">connect</span>(myBtn1,&amp;QPushButton::clicked,<span class="keyword">this</span>,[=]() &#123;<span class="built_in">qDebug</span>() &lt;&lt; m;&#125;);</span><br><span class="line"> <span class="built_in">qDebug</span>() &lt;&lt; m;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºç¬¬ä¸€ä¸ªconnectå‡½æ•°æ¥è¯´ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(myBtn,&amp;QPushButton::clicked,<span class="keyword">this</span>,[m]()<span class="keyword">mutable</span>&#123;m=<span class="number">100</span><span class="number">+10</span>;<span class="built_in">qDebug</span>()&lt;&lt;m;&#125;);</span><br></pre></td></tr></table></figure><p>å½“å‡½æ•°å¯¹è±¡å‚æ•°ä¸ºmæ—¶å€™ï¼Œè‹¥è¦ä¿®æ”¹è¯¥å€¼ä¼ é€’è¿›æ¥çš„æ‹·è´ï¼Œéœ€è¦åŠ ä¸Šmutable å…³é”®å­—ã€‚ï¼ˆæ³¨æ„åªèƒ½ä¿®æ”¹æ‹·è´ï¼Œè€Œä¸æ˜¯å€¼æœ¬èº«ï¼‰</p><p><strong>ä¸€èˆ¬æ¥è¯´ï¼Œlambdaè¡¨è¾¾å¼ä¸­å¾ˆå°‘å»åŠ å…³é”®å­—çš„ï¼Œé™¤éä½ æœ‰ä»€ä¹ˆç‰¹æ®Šçš„éœ€æ±‚ã€‚</strong></p><p><strong>æ€»çš„æ¥è¯´ï¼š</strong></p><ul><li>ç”¨lambdaå†™æ§½å‡½æ•°å¯ä»¥åœ¨lambdaè¡¨è¾¾å¼çš„å‡½æ•°ä½“å†…å†™å¤šä¸ªå‡½æ•°ã€‚ï¼ˆå¦‚ä¸Šé¢m&#x3D;100+10;å’ŒqDebug()&lt;&lt;m;)</li><li>lambdaå¸¸ç”¨è¡¨è¾¾å¼ï¼š</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[=]()&#123;&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºåµŒå¥—çª—å£ï¼Œå…¶åæ ‡æ˜¯ç›¸å¯¹äºçˆ¶çª—å£æ¥è¯´çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qt01å¯¹è±¡æ ‘å’Œçª—å£åæ ‡ä½“ç³»</title>
      <link href="/2025/03/13/Qt01%E5%AF%B9%E8%B1%A1%E6%A0%91%E5%92%8C%E7%AA%97%E5%8F%A3%E5%9D%90%E6%A0%87%E4%BD%93%E7%B3%BB/"/>
      <url>/2025/03/13/Qt01%E5%AF%B9%E8%B1%A1%E6%A0%91%E5%92%8C%E7%AA%97%E5%8F%A3%E5%9D%90%E6%A0%87%E4%BD%93%E7%B3%BB/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€ã€QTåŸºæœ¬æ¡†æ¶"><a href="#ä¸€ã€QTåŸºæœ¬æ¡†æ¶" class="headerlink" title="ä¸€ã€QTåŸºæœ¬æ¡†æ¶"></a><font color = "FF0000">ä¸€ã€QTåŸºæœ¬æ¡†æ¶</font></h3><p>åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå…ˆçœ‹ä¸‹main.cppè¿™ä¸ªæ–‡ä»¶</p><p><img src="https://bu.dusays.com/2025/03/13/67d2403c08fc9.png"></p><p><strong><font color = "FF0000">æ³¨æ„ï¼š</font></strong></p><ol><li>æ¯ä¸ªQtç¨‹åºæœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªQApplicationå¯¹è±¡ï¼Œæ²¡æœ‰ä¼šæŠ¥é”™ã€‚</li><li>Qté‡Œé¢çš„å¤´æ–‡ä»¶å’Œç±»åæ˜¯ä¸€è‡´çš„ï¼ŒçŸ¥é“å¤´æ–‡ä»¶å°±çŸ¥é“ç±»åï¼Œåä¹‹äº¦ç„¶</li><li>Qtå¤´æ–‡ä»¶æ˜¯æ²¡æœ‰.hçš„ï¼ŒåŸºæœ¬éƒ½æ˜¯ä»¥å¤§å†™çš„Qå¼€å¤´</li></ol><p>æ ¹æ®ä»¥ä¸Šçš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºQtçš„ç¨‹åºæ¡†æ¶ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span>      </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;  </span><br><span class="line">     <span class="comment">/*</span></span><br><span class="line"><span class="comment">       åœ¨è¿™é‡Œå†™ä½ çš„ä»£ç </span></span><br><span class="line"><span class="comment">     */</span>     </span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>widget.hå’Œwidget.cppåˆ†æ</strong></li></ul><p>æ‰“å¼€å¤´æ–‡ä»¶é‡Œé¢çš„widget.h,å’Œsourcesé‡Œé¢çš„widget.appï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä»£ç ï¼š</p><p><img src="https://bu.dusays.com/2025/03/13/67d242912f352.png"></p><p><img src="https://bu.dusays.com/2025/03/13/67d242a1e99ab.png"></p><p>æœ€ä¸Šé¢çš„<strong>MyfirstQt.pro</strong>,æ˜¯ç®¡ç†é¡¹ç›®çš„æ–‡ä»¶ï¼Œç”¨æ¥å­˜å‚¨é¡¹ç›®è®¾ç½®ã€‚</p><p>åç¼€ä¸ºâ€œ.proâ€çš„æ–‡ä»¶æ˜¯é¡¹ç›®çš„ç®¡ç†æ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯é¡¹ç›®çš„åç§°ï¼Œå¦‚æœ¬é¡¹ç›®ä¸­çš„ MyfirstQt.proã€‚ï¼ˆç±»ä¼¼ä¸VSå·¥ç¨‹çš„.slnæ–‡ä»¶ï¼‰</p><p><strong>ğŸ’›ğŸ’›å®ä¾‹ï¼ˆç”¨ä»£ç åˆ›å»ºä¸€ä¸ªbuttonï¼‰ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_widget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QPushButton&gt;</span><span class="comment">//æŒ‰é’®æ§ä»¶çš„å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::Widget)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ›å»ºç¬¬ä¸€ä¸ªæŒ‰é’®</span></span><br><span class="line">    QPushButton *btn=<span class="keyword">new</span> QPushButton;</span><br><span class="line">    <span class="comment">//ä¸èƒ½ç”¨btn-&gt;show();//showæ˜¯ä»¥é¡¶å±‚æ–¹å¼å¼¹å‡ºæ§ä»¶</span></span><br><span class="line">    <span class="comment">//è®©btnåœ¨widgetçª—å£æ˜¾ç¤º</span></span><br><span class="line">    btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);<span class="comment">//thisæŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆï¼ˆå³widgetçš„åœ°å€ï¼‰</span></span><br><span class="line">    <span class="comment">//æ˜¾ç¤ºæ–‡æœ¬</span></span><br><span class="line">    btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;ç¬¬ä¸€ä¸ªæŒ‰é’®&quot;</span>);</span><br><span class="line">    <span class="comment">//åˆ›å»ºç¬¬äºŒä¸ªæŒ‰é’®</span></span><br><span class="line">    <span class="comment">//æ³¨æ„ï¼šè¿™ç§æ–¹æ³•æ˜¯æŒ‰ç…§æŒ‰é’®çš„å¤§å°åˆ›å»ºçª—å£</span></span><br><span class="line">    QPushButton *btn2=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;ç¬¬äºŒä¸ªæŒ‰é’®&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">//ç§»åŠ¨btn2çš„ä½ç½®ï¼ˆç”±äºåˆ›å»ºçš„ä¸¤ä¸ªæŒ‰é’®ä½ç½®é‡å äº†ï¼‰</span></span><br><span class="line">    btn2-&gt;<span class="built_in">move</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="comment">//å› æ­¤éœ€è¦é‡ç½®çª—å£å¤§å°</span></span><br><span class="line">    <span class="built_in">resize</span>(<span class="number">600</span>,<span class="number">400</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®çª—å£æ ‡é¢˜</span></span><br><span class="line">    <span class="built_in">setWindowTitle</span>(<span class="string">&quot;å”¯æœ‰è‡ªå·±å¼ºå¤§&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒã€å¯¹è±¡æ ‘"><a href="#äºŒã€å¯¹è±¡æ ‘" class="headerlink" title="äºŒã€å¯¹è±¡æ ‘"></a><font color = "FF0000">äºŒã€å¯¹è±¡æ ‘</font></h3><p><strong>ğŸ’šğŸ’šä»€ä¹ˆæ˜¯å¯¹è±¡æ ‘ï¼Ÿ</strong></p><p>æˆ‘ä»¬å¸¸å¸¸å¬åˆ° QObject ä¼šç”¨å¯¹è±¡æ ‘æ¥ç»„ç»‡ç®¡ç†è‡ªå·±ï¼Œé‚£ä»€ä¹ˆæ˜¯å¯¹è±¡æ ‘ï¼Ÿ</p><p>è¿™ä¸ªæ¦‚å¿µéå¸¸å¥½ç†è§£ã€‚å› ä¸º QObject ç±»å°±æœ‰ä¸€ä¸ªç§æœ‰å˜é‡ QList&lt;QObject *&gt;ï¼Œä¸“é—¨å­˜å‚¨è¿™ä¸ªç±»çš„å­å­™åä»£ä»¬ã€‚æ¯”å¦‚åˆ›å»ºä¸€ä¸ª QObject å¯¹è±¡å¹¶æŒ‡å®šçˆ¶å¯¹è±¡æ—¶ï¼Œå°±ä¼šæŠŠè‡ªå·±åŠ å…¥åˆ°çˆ¶å¯¹è±¡çš„ childre() åˆ—è¡¨ä¸­ï¼Œä¹Ÿå°±æ˜¯ QList&lt;QObject *&gt; å˜é‡ä¸­ã€‚</p><p> çˆ¶å¯¹è±¡ææ„çš„æ—¶å€™ï¼Œè¿™ä¸ªåˆ—è¡¨ä¸­çš„æ‰€æœ‰å¯¹è±¡ä¹Ÿä¼šè¢«ææ„ã€‚<strong>ï¼ˆæ³¨æ„ï¼Œè¿™ é‡Œçš„çˆ¶å¯¹è±¡å¹¶ä¸æ˜¯ç»§æ‰¿æ„ä¹‰ä¸Šçš„çˆ¶ç±»ï¼ï¼‰</strong></p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰ä¸€ä¸ªçª—å£ Windowï¼Œé‡Œé¢æœ‰ Labelæ ‡ç­¾ã€TextEditæ–‡æœ¬è¾“å…¥æ¡†ã€ButtonæŒ‰é’®è¿™ä¸‰ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”éƒ½è®¾ç½® Window ä¸ºå®ƒä»¬çš„çˆ¶å¯¹è±¡ã€‚è¿™æ—¶å€™æˆ‘åšäº†ä¸€ä¸ªå…³é—­çª—å£çš„æ“ä½œï¼Œä½œä¸ºç¨‹åºå‘˜çš„ä½ æ˜¯ä¸æ˜¯è‡ªç„¶æƒ³åˆ°å°†æ‰€æœ‰å’Œçª—å£ç›¸å…³çš„å¯¹è±¡ææ„å•Šï¼Ÿå¤è€çš„åŠæ³•å°±æ˜¯ä¸€ä¸ªä¸ªæ‰‹åŠ¨ delete å‘—ã€‚æ˜¯ä¸æ˜¯å¾ˆéº»çƒ¦ï¼ŸQt è¿ç”¨å¯¹è±¡æ ‘æ¨¡å¼ï¼Œå½“çˆ¶å¯¹è±¡è¢«ææ„æ—¶ï¼Œå­å¯¹è±¡è‡ªåŠ¨å°± delete æ‰äº†ï¼Œä¸ç”¨å†å†™ä¸€å¤§å †çš„ä»£ç äº†ã€‚</p><p><strong>QWidget æ˜¯èƒ½å¤Ÿåœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„ä¸€åˆ‡ç»„ä»¶çš„çˆ¶ç±»ï¼ˆQWidget ç»§æ‰¿è‡ª QObjectï¼Œå› æ­¤ä¹Ÿç»§æ‰¿äº†è¿™ç§å¯¹è±¡æ ‘å…³ç³»ã€‚ï¼‰</strong></p><p><strong>ğŸ’›ğŸ’›æ³¨æ„æ„å»º&#x2F;ææ„ QObject çš„é¡ºåºé—®é¢˜</strong></p><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæœ€åè¢«åˆ›å»ºå‡ºæ¥çš„ä¼šå…ˆè¢«ææ„æ‰ã€‚å°±å¥½æ¯”æˆ‘æœ‰ä¸€ä¸ªå¤§æ¡Œå­ï¼Œä¸Šé¢å…ˆæ‘†æ”¾ä¸€ä¸ªç›˜å­ï¼Œå†æ‘†æ”¾ä¸€ä¸ªç¢—ã€‚å½“æˆ‘è¦æŠŠæ¡Œå­æ’¤æ‰çš„æ—¶å€™ï¼Œä¼šå…ˆæ’¤æ‰ç¢—ï¼Œå†æ’¤æ‰ç›˜å­ï¼Œæœ€åæ’¤æ‰æ¡Œå­ã€‚</p><p>ç”¨ä»£ç æ¼”ç¤ºä¸€ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     QWidget window;</span><br><span class="line">     <span class="function">QPushButton <span class="title">quit</span><span class="params">(<span class="string">&quot;Quit&quot;</span>, &amp;window)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååˆ›å»ºçš„ quit å¯¹è±¡æŒ‡å®šäº† window ä¸ºå…¶çˆ¶å¯¹è±¡ã€‚é‚£ä¹ˆå…³é—­ç¨‹åºæ—¶ï¼Œä¼šå…ˆè°ƒç”¨å®ƒçš„ææ„å‡½æ•°ï¼Œç„¶åè°ƒç”¨ window çš„ææ„å‡½æ•°ã€‚</p><p><strong><font color="FF0000">è¿™å°±ç‰µæ‰¯åˆ°ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼š</font></strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QPushButton <span class="title">quit</span><span class="params">(<span class="string">&quot;Quit&quot;</span>)</span></span>;</span><br><span class="line">    QWidget window;</span><br><span class="line"> </span><br><span class="line">    quit.<span class="built_in">setParent</span>(&amp;window);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœåè¿‡æ¥ï¼Œç”±äº window ååˆ›å»ºï¼Œç¨‹åºå…³é—­æ—¶å…ˆè°ƒç”¨ window çš„ææ„å‡½æ•°ï¼ˆæ­¤æ—¶ quit è¢«ç¬¬ä¸€æ¬¡ææ„ï¼‰ã€‚æ¥ç€è°ƒç”¨ quit çš„ææ„å‡½æ•°ï¼ˆæ­¤æ—¶ quit è¢«ç¬¬äºŒæ¬¡ææ„ï¼‰ï¼Œè¿™æ—¶ç”±äºè¢«ä¸¤æ¬¡ææ„ï¼Œæ‰€ä»¥å‡ºé—®é¢˜äº†ã€‚</p><p>è¿™ç§ç‰¹æ®Šæƒ…å†µåœ¨ç¼–ç¨‹ä¸­å¾ˆéšè”½ï¼Œä¸å®¹æ˜“å‘ç°ã€‚å› ä¸ºç¼–è¯‘çš„æ—¶å€™ä¸ä¼šæŠ¥é”™ï¼Œåªæœ‰è¿è¡Œæ—¶æ‰ä¼šäº§ç”Ÿé—®é¢˜ã€‚</p><p><strong>è§£å†³åŠæ³•å¦‚ä¸‹ï¼š</strong></p><ol><li><p><strong>æ ˆå¯¹è±¡çš„ææ„é¡ºåº</strong><br> ä¸¤ä¸ªæ ˆå¯¹è±¡ <code>window</code>ï¼ˆçˆ¶ï¼‰å’Œ <code>quit</code>ï¼ˆå­ï¼‰ä¼šåœ¨ <code>main</code> å‡½æ•°ç»“æŸæ—¶æŒ‰åˆ›å»º<strong>ç›¸åçš„é¡ºåº</strong>ææ„ï¼š</p><ul><li>å…ˆææ„ <code>window</code>ï¼ˆååˆ›å»ºï¼‰</li><li>å†ææ„ <code>quit</code>ï¼ˆå…ˆåˆ›å»ºï¼‰</li></ul></li><li><p><strong>Qt çš„çˆ¶å­å¯¹è±¡æœºåˆ¶</strong><br> å½“çˆ¶å¯¹è±¡ï¼ˆ<code>window</code>ï¼‰è¢«é”€æ¯æ—¶ï¼ŒQt ä¼šè‡ªåŠ¨é€’å½’é”€æ¯å…¶å­å¯¹è±¡ï¼ˆ<code>quit</code>ï¼‰ã€‚ç”±äº <code>window</code> æ˜¯æ ˆå¯¹è±¡ï¼Œå…¶ææ„è¿‡ç¨‹ä¼š<strong>è§¦å‘ <code>delete &amp;quit</code></strong>ï¼Œä½† <code>quit</code> åŒæ ·æ˜¯ä¸ªæ ˆå¯¹è±¡ï¼ˆæœªé€šè¿‡ <code>new</code> åœ¨å †ä¸Šåˆ†é…ï¼‰ã€‚</p></li><li><p><strong>åŒé‡é‡Šæ”¾é”™è¯¯</strong></p><ul><li>ç¬¬ä¸€æ¬¡ææ„ï¼ˆé”™è¯¯ï¼‰ï¼šé€šè¿‡ <code>window</code> é”€æ¯å­å¯¹è±¡æ—¶ï¼Œå¯¹æ ˆåœ°å€ <code>&amp;quit</code> è°ƒç”¨ <code>delete</code>ï¼Œæœ¬è´¨æ˜¯å¯¹éå †å†…å­˜è¿›è¡Œé‡Šæ”¾ã€‚</li><li>ç¬¬äºŒæ¬¡ææ„ï¼ˆæ­£å¸¸ï¼‰ï¼š<code>quit</code> ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œè§¦å‘æ ˆå¯¹è±¡çš„è‡ªç„¶ææ„ï¼Œå†æ¬¡è°ƒç”¨ææ„å‡½æ•°ã€‚</li></ul><p>âŒ è¿™å°†å¼•å‘<strong>åŒé‡é‡Šæ”¾ï¼ˆdouble freeï¼‰æˆ–å†…å­˜è®¿é—®å†²çª</strong>ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p></li></ol><p>æˆ‘ä»¬æœ€å¥½ä»å¼€å§‹å°±å…»æˆè‰¯å¥½ä¹ æƒ¯ï¼Œåœ¨ Qt ä¸­ï¼Œå°½é‡åœ¨æ„é€ çš„æ—¶å€™å°±æŒ‡å®š parent å¯¹è±¡ï¼Œå¹¶ä¸”å¤§èƒ†åœ¨å †ä¸Šåˆ›å»ºã€‚</p><h3 id="ä¸‰ã€Qtçª—å£åæ ‡ä½“ç³»"><a href="#ä¸‰ã€Qtçª—å£åæ ‡ä½“ç³»" class="headerlink" title="ä¸‰ã€Qtçª—å£åæ ‡ä½“ç³»"></a><font color = "FF0000">ä¸‰ã€Qtçª—å£åæ ‡ä½“ç³»</font></h3><p>Qtçš„çª—å£åæ ‡ç³»ä»¥å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼ŒX å‘å³å¢åŠ ï¼ŒY å‘ä¸‹å¢åŠ ã€‚</p><p><img src="https://bu.dusays.com/2025/03/13/67d277561fcbf.png"></p><p>å¯¹äºåµŒå¥—çª—å£ï¼Œå…¶åæ ‡æ˜¯ç›¸å¯¹äºçˆ¶çª—å£æ¥è¯´çš„ã€‚</p><br><br><br><p><span style="color: red; font-size: 20px;">è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/xyf327">å”¯æœ‰è‡ªå·±å¼ºå¤§</a>          å¦‚æœ‰ä¾µæƒï¼Œåœ¨ä¸‹æ–¹è¯„è®º  ç«‹åˆ»åˆ é™¤ã€‚</span></p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qtå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Qtå‡ ä¸ªé¢è¯•é—®é¢˜</title>
      <link href="/2025/03/07/Qt%E5%87%A0%E4%B8%AA%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98/"/>
      <url>/2025/03/07/Qt%E5%87%A0%E4%B8%AA%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h4 id="QTå¤šçº¿ç¨‹"><a href="#QTå¤šçº¿ç¨‹" class="headerlink" title="QTå¤šçº¿ç¨‹"></a>QTå¤šçº¿ç¨‹</h4><h4 id="QML"><a href="#QML" class="headerlink" title="QML"></a>QML</h4><p><strong>QMLï¼ˆQt Meta-Object Languageï¼‰</strong> æ˜¯ <strong>Qtæ¡†æ¶</strong> ä¸­ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰çš„å£°æ˜å¼ç¼–ç¨‹è¯­è¨€ã€‚å®ƒä¸“æ³¨äºç•Œé¢è®¾è®¡ä¸ç”¨æˆ·äº¤äº’ï¼Œä¸C++åç«¯é€»è¾‘ç»“åˆï¼Œé€‚ç”¨äºå¼€å‘è·¨å¹³å°ã€åŠ¨æ€ä¸”ç°ä»£åŒ–çš„åº”ç”¨ç¨‹åºï¼ˆå¦‚æ¡Œé¢ã€ç§»åŠ¨åŠåµŒå…¥å¼åº”ç”¨ï¼‰ã€‚ä»¥ä¸‹æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§ä¸ä½œç”¨ï¼š</p><ul><li>ECMAScript</li><li>Qt å¯¹è±¡ç³»ç»Ÿ</li><li>Qt Quick æ ‡å‡†åº“</li></ul><p>ç”¨äºå®šä¹‰å’Œåˆ›å»ºåŠ¨æ€å¯è§†åŒ–ç•Œé¢</p><p>Qt Quick æ˜¯ä¸€ç§åŸºäº Qt çš„ç”¨æˆ·ç•Œé¢è®¾è®¡æŠ€æœ¯ã€‚å®ƒå…è®¸å¼€å‘äººå‘˜ä½¿ç”¨ QMLï¼ˆQt Meta-Object Languageï¼‰è¯­è¨€å’Œ JavaScript ä»¥å£°æ˜å¼çš„æ–¹å¼åˆ›å»ºåŠ¨æ€çš„ã€é«˜æ•ˆçš„ã€æµç•…çš„ç”¨æˆ·ç•Œé¢ã€‚Qt Quick æŠ€æœ¯ä¸åŒäºä¼ ç»Ÿçš„åŸºäºéƒ¨ä»¶ï¼ˆwidget-basedï¼‰çš„ç”¨æˆ·ç•Œé¢è®¾è®¡ï¼Œå…¶è®¾è®¡å“²å­¦æ˜¯å°†ç•Œé¢çš„å„ä¸ªå…ƒç´ æŠ½è±¡å‡ºæ¥ï¼Œç„¶åé€šè¿‡ç»„åˆè¿™äº›å…ƒç´ æ¥å®ç°å„ç§ä¸åŒçš„ç•Œé¢å’Œäº¤äº’æ•ˆæœã€‚</p><h4 id="å¤šçº¿ç¨‹çš„å®ç°ï¼šä¿¡å·å’Œæ§½"><a href="#å¤šçº¿ç¨‹çš„å®ç°ï¼šä¿¡å·å’Œæ§½" class="headerlink" title="å¤šçº¿ç¨‹çš„å®ç°ï¼šä¿¡å·å’Œæ§½"></a>å¤šçº¿ç¨‹çš„å®ç°ï¼šä¿¡å·å’Œæ§½</h4><p>apiå‡½æ•°   æˆå‘˜å‡½æ•°ã€<strong>2.2 ä¿¡å·æ§½</strong>  <strong>2.3é™æ€å‡½æ•°</strong></p><p><strong>æ´¾ç”ŸQThreadç±»å¯¹è±¡çš„æ–¹æ³•ï¼ˆé‡å†™Runå‡½æ•°ï¼‰</strong></p><p>å¯åŠ¨äº‹ä»¶å¾ªç¯ï¼šå½“ä¸€ä¸ªç¨‹åºè°ƒç”¨ exec()ï¼ˆ3456ä¾‹å¦‚ QApplication::exec()ï¼‰åï¼Œå½“å‰çº¿ç¨‹ä¼šè¿›å…¥ä¸€ä¸ªé˜»å¡çŠ¶æ€ï¼Œå¹¶å¼€å§‹æ— é™å¾ªç¯åœ°ç›‘å¬å’Œåˆ†å‘äº‹ä»¶ï¼ˆå¦‚é¼ æ ‡ç‚¹å‡»ã€é”®ç›˜è¾“å…¥ã€å®šæ—¶å™¨è§¦è¾¾ã€ç½‘ç»œå“åº”ç­‰ï¼‰ã€‚</p><p><strong>ä½¿ç”¨ä¿¡å·ä¸æ§½æ–¹å¼æ¥å®ç°å¤šçº¿ç¨‹</strong></p><p>ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªå±€é™æ€§ï¼Œåªæœ‰ä¸€ä¸ªrun()å‡½æ•°èƒ½å¤Ÿåœ¨çº¿ç¨‹ä¸­å»è¿è¡Œï¼Œä½†æ˜¯å½“æœ‰å¤šä¸ªå‡½æ•°åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œæ—¶ï¼Œå°±æ²¡åŠæ³•äº†ï¼Œè‡³å°‘å®ç°èµ·æ¥å¾ˆéº»çƒ¦</p><p>ä» QObject æ´¾ç”Ÿï¼Œåœ¨è¿™ä¸ªç±»ä¸­æ·»åŠ ä¸€ä¸ªå…¬å…±çš„æˆå‘˜å‡½æ•°(working)ï¼Œå‡½æ•°ä½“å°±æ˜¯æˆ‘ä»¬è¦å­çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘</p><ul><li>åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ª QThread å¯¹è±¡ï¼Œè¿™å°±æ˜¯å­çº¿ç¨‹çš„å¯¹è±¡</li><li>åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºå·¥ä½œçš„ç±»å¯¹è±¡ï¼ˆåƒä¸‡ä¸è¦æŒ‡å®šç»™åˆ›å»ºçš„å¯¹è±¡æŒ‡å®šçˆ¶å¯¹è±¡ï¼‰</li><li>å°† MyWork å¯¹è±¡ç§»åŠ¨åˆ°åˆ›å»ºçš„å­çº¿ç¨‹å¯¹è±¡ä¸­ï¼Œéœ€è¦è°ƒç”¨ QObject ç±»æä¾›çš„ moveToThread() æ–¹æ³•</li><li>å¯åŠ¨å­çº¿ç¨‹ï¼Œè°ƒç”¨ start(), è¿™æ—¶å€™çº¿ç¨‹å¯åŠ¨äº†ï¼Œä½†æ˜¯ç§»åŠ¨åˆ°çº¿ç¨‹ä¸­çš„å¯¹è±¡å¹¶æ²¡æœ‰å·¥ä½œ</li><li>è°ƒç”¨ MyWork ç±»å¯¹è±¡çš„å·¥ä½œå‡½æ•°ï¼Œè®©è¿™ä¸ªå‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œè¿™æ—¶å€™æ˜¯åœ¨ç§»åŠ¨åˆ°çš„é‚£ä¸ªå­çº¿ç¨‹ä¸­è¿è¡Œçš„</li></ul><h3 id="å…±äº«å†…å­˜-é˜Ÿåˆ—"><a href="#å…±äº«å†…å­˜-é˜Ÿåˆ—" class="headerlink" title="å…±äº«å†…å­˜  é˜Ÿåˆ—"></a>å…±äº«å†…å­˜  é˜Ÿåˆ—</h3><p>åœ¨Qtä¸­ï¼Œ<strong>å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰</strong> æ˜¯ä¸€ç§å…è®¸ä¸åŒè¿›ç¨‹è®¿é—®åŒä¸€å—å†…å­˜åŒºåŸŸçš„æœºåˆ¶ã€‚è¿™æ˜¯å®ç°è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰çš„ä¸€ç§é«˜æ•ˆæ–¹å¼ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦<strong>é«˜é¢‘æ•°æ®äº¤æ¢</strong>çš„åœºæ™¯ï¼ˆå¦‚å®æ—¶æ•°æ®ä¼ è¾“ï¼‰ã€‚Qtæä¾›äº† <strong><code>QSharedMemory</code></strong> ç±»æ¥ç®€åŒ–å…±äº«å†…å­˜çš„æ“ä½œã€‚Qtæä¾›äº† <strong><code>QSharedMemory</code></strong> ç±»æ¥ç®€åŒ–å…±äº«å†…å­˜çš„æ“ä½œ</p><h3 id="QT-äº‹ä»¶è¿‡æ»¤å™¨"><a href="#QT-äº‹ä»¶è¿‡æ»¤å™¨" class="headerlink" title="QT äº‹ä»¶è¿‡æ»¤å™¨"></a>QT äº‹ä»¶è¿‡æ»¤å™¨</h3><p>åœ¨Qtä¸­ï¼Œ<strong>äº‹ä»¶è¿‡æ»¤å™¨ï¼ˆEvent Filterï¼‰</strong> æ˜¯ä¸€ç§å¼ºå¤§çš„æœºåˆ¶ï¼Œå…è®¸ä¸€ä¸ªå¯¹è±¡ç›‘è§†æˆ–æ‹¦æˆªå¦ä¸€ä¸ªå¯¹è±¡çš„äº‹ä»¶å¤„ç†æµç¨‹ã€‚é€šè¿‡äº‹ä»¶è¿‡æ»¤å™¨ï¼Œå¯ä»¥åœ¨äº‹ä»¶åˆ°è¾¾ç›®æ ‡å¯¹è±¡å‰è¿›è¡Œé¢„å¤„ç†æˆ–å®Œå…¨æ‹¦æˆªï¼Œè¿™åœ¨éœ€è¦è‡ªå®šä¹‰äº‹ä»¶è¡Œä¸ºæˆ–è·¨ç»„ä»¶äº¤äº’æ—¶éå¸¸å®ç”¨ã€‚</p><p>ç»§æ‰¿ <code>QObject</code> å¹¶é‡å†™ <code>eventFilter()</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•åœ¨ç›®æ ‡å¯¹è±¡çš„äº‹ä»¶è¢«å¤„ç†å‰è°ƒç”¨ã€‚</p><h4 id="å®‰è£…è¿‡æ»¤å™¨åˆ°ç›®æ ‡å¯¹è±¡"><a href="#å®‰è£…è¿‡æ»¤å™¨åˆ°ç›®æ ‡å¯¹è±¡" class="headerlink" title="å®‰è£…è¿‡æ»¤å™¨åˆ°ç›®æ ‡å¯¹è±¡"></a><strong>å®‰è£…è¿‡æ»¤å™¨åˆ°ç›®æ ‡å¯¹è±¡</strong></h4><p>ç›®æ ‡å¯¹è±¡é€šè¿‡ <code>installEventFilter()</code> æ³¨å†Œè¿‡æ»¤å™¨ï¼Œä½¿å…¶äº‹ä»¶è¢«ç›‘æ§ã€‚</p><h3 id="QTå®šæ—¶å™¨"><a href="#QTå®šæ—¶å™¨" class="headerlink" title="QTå®šæ—¶å™¨"></a>QTå®šæ—¶å™¨</h3><p>Qtä¸­æœ‰ä¸¤ç§æ–¹æ³•æ¥ä½¿ç”¨å®šæ—¶å™¨ï¼Œä¸€ç§æ˜¯å®šæ—¶å™¨äº‹ä»¶ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨ä¿¡å·å’Œæ§½ã€‚</p><ul><li>åˆ©ç”¨å¯¹void timerEvent(QTimerEvent* e)äº‹ä»¶çš„é‡å†™ã€‚</li><li>å¯åŠ¨å®šæ—¶å™¨ int QObject::startTimer ( int interval ) ;</li></ul><p>å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¿”å›å€¼ä¸ºintç±»å‹ã€‚ä»–çš„å‚æ•°intervalæ˜¯æ¯«ç§’çº§åˆ«ã€‚å½“å¼€å¯æˆåŠŸåä¼šè¿”å›è¿™ä¸ªå®šæ—¶å™¨çš„ID, å¹¶ä¸”æ¯éš”interval æ—¶é—´åä¼šè¿›å…¥timerEvent å‡½æ•°ã€‚ç›´åˆ°å®šæ—¶å™¨è¢«æ€æ­»ï¼ˆkillTimerï¼‰</p><ul><li>timerEventçš„è¿”å›å€¼æ˜¯å®šæ—¶å™¨çš„å”¯ä¸€æ ‡è¯†ã€‚å¯ä»¥å’Œe-&gt;timerIdæ¯”è¾ƒ</li><li>void killTimer(int id); &#x2F;&#x2F;åœæ­¢ ID ä¸º id çš„è®¡æ—¶å™¨ï¼ŒID ç”± startTimer()å‡½æ•°è¿”å›</li></ul><p><strong>æ–¹å¼ï¼š</strong></p><ol><li>åˆ©ç”¨å®šæ—¶å™¨ç±»QTimer</li><li>åˆ›å»ºå®šæ—¶å™¨å¯¹è±¡ QTimer *timer&#x3D;new QTimer(this)</li><li>å¯åŠ¨å®šæ—¶å™¨timer-&gt;start( 500ï¼‰ &#x2F;&#x2F;å‚æ•°ï¼šæ¯éš”næ¯«ç§’å‘é€ä¸€ä¸ªä¿¡å·ï¼ˆtimeoutï¼‰</li><li>ç”¨connectè¿æ¥ä¿¡å·å’Œæ§½å‡½æ•°ï¼ˆè‡ªå®šä¹‰æ§½ï¼‰</li><li>æš‚åœ timer-&gt;stop</li></ol><p>**å®ä¾‹ï¼š**å¯åŠ¨label æ¯éš”0.5ç§’è®¡æ—¶</p><h3 id="QTå’ŒMFCåº•å±‚æœºåˆ¶"><a href="#QTå’ŒMFCåº•å±‚æœºåˆ¶" class="headerlink" title="QTå’ŒMFCåº•å±‚æœºåˆ¶"></a>QTå’ŒMFCåº•å±‚æœºåˆ¶</h3><p>QT</p><p><strong>äº‹ä»¶é©±åŠ¨æ¨¡å‹</strong>ï¼š</p><ul><li><p><strong>äº‹ä»¶å¾ªç¯</strong>ï¼šæ¯ä¸ª Qt åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªå…¨å±€äº‹ä»¶é˜Ÿåˆ—ï¼ˆ<code>QEventLoop</code>ï¼‰ï¼Œç®¡ç†ç”¨æˆ·è¾“å…¥ã€å®šæ—¶å™¨ã€ç½‘ç»œäº‹ä»¶ç­‰ã€‚</p></li><li><p>äº‹ä»¶åˆ†å‘</p><p>ï¼š</p><ul><li>Qt å°†æ“ä½œç³»ç»Ÿçš„åŸç”Ÿäº‹ä»¶ï¼ˆå¦‚é¼ æ ‡ç‚¹å‡»ã€æŒ‰é”®ï¼‰å°è£…ä¸º <code>QEvent</code> å¯¹è±¡ï¼ˆå¦‚ <code>QMouseEvent</code>ï¼‰ã€‚</li><li>é€šè¿‡ <code>QObject::event()</code> å’Œ <code>QWidget::eventFilter()</code> åˆ†å‘äº‹ä»¶ã€‚</li></ul></li><li><p>ä¿¡å·æ§½æœºåˆ¶</p><p>ï¼š</p><ul><li>é€šè¿‡å…ƒå¯¹è±¡ç³»ç»Ÿï¼ˆMeta-Object Systemï¼Œç”± <code>moc</code> ç”Ÿæˆï¼‰å®ç°æ¾è€¦åˆé€šä¿¡ã€‚</li><li>ç±»å‹å®‰å…¨ï¼Œæ”¯æŒè·¨çº¿ç¨‹é€šä¿¡ã€‚</li></ul></li></ul><p>MFC</p><p>æ ¸å¿ƒï¼šåŸºäº Win32 APIï¼Œä¾èµ– Windows çš„ HWNDï¼ˆçª—å£å¥æŸ„ï¼‰å’Œæ¶ˆæ¯é˜Ÿåˆ—ã€‚<br>æ¶ˆæ¯ä¼ é€’ï¼š<br>Windows æ¶ˆæ¯ï¼ˆå¦‚ WM_PAINTã€WM_CLOSEï¼‰é€šè¿‡ æ¶ˆæ¯å¾ªç¯ï¼ˆPeekMessage&#x2F;GetMessageï¼‰åˆ†å‘ç»™çª—å£è¿‡ç¨‹ï¼ˆWndProcï¼‰ã€‚<br>MFC å°è£…äº†æ¶ˆæ¯å¤„ç†æµç¨‹ï¼Œé€šè¿‡ æ¶ˆæ¯æ˜ å°„å®ï¼ˆå¦‚ ON_WM_PAINT()ï¼‰å°†æ¶ˆæ¯ä¸æˆå‘˜å‡½æ•°ç»‘å®šã€‚</p><p><strong>QJSON</strong></p><p>Json æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚å®ƒä½¿å¾—äººä»¬å¾ˆå®¹æ˜“è¿›è¡Œé˜…è¯»å’Œç¼–å†™ã€‚</p><p>QJson æ˜¯ Jsonçš„ä¸€ç§æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§ç®€å•çš„æ•°æ®ç»“æ„ã€‚</p><p>JSON åŸºäºä¸¤ç§ç»“æ„ï¼š1ï¸âƒ£åç§°ï¼šå€¼       2ï¸âƒ£å€¼çš„æœ‰åºåˆ—è¡¨</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QJsonDocument&gt;</span>  <span class="comment">// è¯»å–å’Œå†™å…¥Jsonç±»</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QJsonValue&gt;</span>   <span class="comment">// Jsonå€¼æœ‰ä¸‹é¢å‡ ç§å½¢å¼ï¼šç©ºã€å¸ƒå°”å€¼ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯å¦ä¸€ä¸ªJsonï¼‰ã€æœªå®šä¹‰</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QJsonObject&gt;</span><span class="comment">// JSONå¯¹è±¡æ˜¯é”®å€¼å¯¹çš„åˆ—è¡¨ä¸­ï¼Œå…¶ä¸­é”®æ˜¯å”¯ä¸€çš„å­—ç¬¦ä¸²ï¼Œå€¼ç”±QJsonValueè¡¨ç¤ºã€‚</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QJsonArray&gt;</span>  <span class="comment">// JSON æ•°ç»„æ˜¯ä¸€ä¸ªå€¼åˆ—è¡¨ã€‚å¯é€šè¿‡ä»æ•°ç»„ä¸­æ’å…¥å’Œåˆ é™¤QJsonValue æ¥æ“ä½œåˆ—è¡¨ã€‚</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QJsonParseError&gt;</span> <span class="comment">// æŠ¥å‘ŠJsonè§£æè¿‡ç¨‹ä¸­çš„é”™è¯¯ã€‚</span></span></span><br></pre></td></tr></table></figure><h4 id="QTå›¾è¡¨åŠŸèƒ½"><a href="#QTå›¾è¡¨åŠŸèƒ½" class="headerlink" title="QTå›¾è¡¨åŠŸèƒ½"></a>QTå›¾è¡¨åŠŸèƒ½</h4><p>Qt Chartsæ˜¯åŸºäºQt Graphics Viewå®ç°çš„ä¸€ä¸ªå›¾è¡¨çš„ç»„ä»¶ï¼Œå¯ä»¥ç”¨æ¥åœ¨QT GUIç¨‹åºä¸­æ·»åŠ ç°åœ¨é£æ ¼çš„ã€å¯äº¤äº’çš„ã€ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„å›¾è¡¨ï¼Œå¯ä»¥ç”¨ä½œQWidgetæˆ–è€… QGraphicsWidgetï¼Œä¹Ÿå¯ç”¨åœ¨QMLä¸­ã€‚æ”¯æŒçš„å›¾æ ‡ç±»å‹æœ‰ï¼šæŠ˜çº¿å›¾è·Ÿæ›²çº¿å›¾ã€é¢ç§¯å›¾ã€é¥¼å›¾ã€æŸ±çŠ¶å›¾ç­‰ã€‚</p><h4 id="QT-QSS"><a href="#QT-QSS" class="headerlink" title="QT QSS"></a>QT QSS</h4><p>â€‹    QTæ ·å¼è¡¨ï¼Œç”¨æ¥å®ç°å¯¹æ§ä»¶å¤–è§‚çš„è‡ªå®šä¹‰ã€‚</p><h4 id="QT-ä¿¡å·åªå£°æ˜æ²¡æœ‰å®šä¹‰"><a href="#QT-ä¿¡å·åªå£°æ˜æ²¡æœ‰å®šä¹‰" class="headerlink" title="QT  ä¿¡å·åªå£°æ˜æ²¡æœ‰å®šä¹‰"></a>QT  ä¿¡å·åªå£°æ˜æ²¡æœ‰å®šä¹‰</h4><p>â€‹<strong>åœ¨ Qt ä¸­ï¼Œè‡ªå®šä¹‰ä¿¡å·ï¼ˆSignalï¼‰åªéœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜ï¼Œæ— éœ€æ‰‹åŠ¨åœ¨æºæ–‡ä»¶ä¸­å®ç°ï¼ˆå®šä¹‰ï¼‰ã€‚</strong> è¿™æ˜¯å› ä¸º Qt çš„å…ƒå¯¹è±¡ç³»ç»Ÿï¼ˆMeta-Object Systemï¼Œç”± <code>Q_OBJECT</code> å®å’Œå…ƒå¯¹è±¡ç¼–è¯‘å™¨ <code>moc</code> å®ç°ï¼‰<strong>ä¼šè‡ªåŠ¨ç”Ÿæˆä¿¡å·çš„åº•å±‚ä»£ç </strong>ï¼Œè´Ÿè´£ä¿¡å·çš„è§¦å‘ä¸æ§½çš„è¿æ¥æœºåˆ¶ã€‚</p><p><strong>Qtå…ƒå¯¹è±¡ç³»ç»ŸMOCçš„è´£ä»»</strong></p><p>ä¿¡å·çš„â€œå®ç°â€ç”± moc å®Œæˆ<br>ä¿¡å·æœ¬è´¨æ˜¯ä¸€ä¸ªâ€œæ ‡è®°â€ï¼Œå½“ä½ åœ¨ä»£ç ä¸­ä½¿ç”¨ <code>emit mySignal();</code> æ—¶ï¼š<code>emit</code> å…³é”®å­—å‘ moc ç”Ÿæˆçš„ä»£ç ä¸‹å‘è§¦å‘æŒ‡ä»¤ã€‚moc è´Ÿè´£ç®¡ç†ä¿¡å·ä¸æ§½çš„è¿æ¥å…³ç³»ï¼Œå¹¶å°†å‚æ•°ä¼ é€’ç»™æ§½å‡½æ•°ã€‚</p><p><strong>ä¿¡å·çš„æœ¬è´¨</strong>ï¼šä¿¡å·æ˜¯æ¥å£è€ŒéåŠŸèƒ½å‡½æ•°   ä¿¡å·çš„ç›®çš„æ˜¯è§¦å‘äº‹ä»¶é€šçŸ¥ï¼Œè€Œéå…·ä½“å®ç°é€»è¾‘ã€‚ç”¨æˆ·åªéœ€è¦å£°æ˜ä¿¡å·çš„æ ¼å¼ï¼ˆåç§°ã€å‚æ•°ç±»å‹ï¼‰ï¼Œå‘ŠçŸ¥å…ƒå¯¹è±¡ç³»ç»Ÿå¦‚ä½•ä¼ é€’æ•°æ®ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">signals:</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">healthChanged</span><span class="params">(<span class="type">int</span> newHealth)</span></span>;  <span class="comment">// å£°æ˜ä¿¡å·</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">positionUpdated</span><span class="params">(<span class="type">double</span> x, <span class="type">double</span> y)</span></span>; <span class="comment">// è¡€é‡</span></span><br></pre></td></tr></table></figure><p><strong>å‘å°„ä¿¡å·</strong> <code>emit</code>ï¼šåœ¨éœ€è¦çš„ä½ç½®è°ƒç”¨<code>emit</code>ï¼Œæ—¶é—´çš„é€»è¾‘å¤„ç†ç”±æ¥æ”¶è¯¥ä¿¡å·çš„æ§½å‡½æ•°å®ç°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Aladdin::takeDamage</span><span class="params">(<span class="type">int</span> damage)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_health -= damage;</span><br><span class="line">    <span class="function">emit <span class="title">healthChanged</span><span class="params">(m_health)</span></span>; <span class="comment">// è§¦å‘ä¿¡å·ï¼Œé€šçŸ¥å¤–éƒ¨å½“å‰çš„è¡€é‡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹æ¯”æ§½å‡½æ•°ï¼ˆéœ€è¦æ‰‹åŠ¨å®ç°ï¼‰</p><h4 id="ä¿¡å·ä¸ºä½•å¿…é¡»æ˜¯-void-ç±»å‹ï¼Ÿ"><a href="#ä¿¡å·ä¸ºä½•å¿…é¡»æ˜¯-void-ç±»å‹ï¼Ÿ" class="headerlink" title="ä¿¡å·ä¸ºä½•å¿…é¡»æ˜¯ void ç±»å‹ï¼Ÿ"></a>ä¿¡å·ä¸ºä½•å¿…é¡»æ˜¯ <code>void</code> ç±»å‹ï¼Ÿ</h4><p>ä¿¡å·çš„ä½œç”¨æ˜¯è§¦å‘äº‹ä»¶é€šçŸ¥ï¼Œè€Œä¸æ˜¯è¿”å›å€¼ã€‚è‹¥æƒ³ä¼ é€’æ•°æ®ï¼Œåº”é€šè¿‡å‚æ•°ä¼ é€’ï¼Œè€Œéè¿”å›å€¼ã€‚</p><h4 id="ä¿¡å·æ˜¯å¦å¯é‡è½½ï¼Ÿ"><a href="#ä¿¡å·æ˜¯å¦å¯é‡è½½ï¼Ÿ" class="headerlink" title="ä¿¡å·æ˜¯å¦å¯é‡è½½ï¼Ÿ"></a><strong>ä¿¡å·æ˜¯å¦å¯é‡è½½ï¼Ÿ</strong></h4><p>æ˜¯çš„ï¼Œå…è®¸é€šè¿‡å‚æ•°ç±»å‹æˆ–æ•°é‡é‡è½½ä¿¡å·ã€‚è¿æ¥æ—¶éœ€ä½¿ç”¨ <code>QOverload</code> æˆ– <code>static_cast</code> æ˜ç¡®æŒ‡å®šé‡è½½ç‰ˆæœ¬ã€‚</p><h4 id="ä¸ºä½•æœ‰æ—¶æ— æ³•è§¦å‘ä¿¡å·ï¼Ÿ"><a href="#ä¸ºä½•æœ‰æ—¶æ— æ³•è§¦å‘ä¿¡å·ï¼Ÿ" class="headerlink" title="ä¸ºä½•æœ‰æ—¶æ— æ³•è§¦å‘ä¿¡å·ï¼Ÿ"></a><strong>ä¸ºä½•æœ‰æ—¶æ— æ³•è§¦å‘ä¿¡å·ï¼Ÿ</strong></h4><ul><li>æœªæ­£ç¡®è¿æ¥ä¿¡å·ä¸æ§½ï¼ˆ<code>connect</code> é”™è¯¯ï¼‰ã€‚</li><li>æœªæ·»åŠ  <code>Q_OBJECT</code> å®æˆ–æœªé‡æ–°ç”Ÿæˆ mocã€‚</li><li>å‘å°„ä¿¡å·çš„å¯¹è±¡è¢«æå‰é”€æ¯ã€‚</li></ul><h4 id="QTè‡ªå®šä¹‰æ§ä»¶çš„ä½¿ç”¨æµç¨‹"><a href="#QTè‡ªå®šä¹‰æ§ä»¶çš„ä½¿ç”¨æµç¨‹" class="headerlink" title="QTè‡ªå®šä¹‰æ§ä»¶çš„ä½¿ç”¨æµç¨‹"></a>QTè‡ªå®šä¹‰æ§ä»¶çš„ä½¿ç”¨æµç¨‹</h4><p>å¤‡æ³¨ä¸‹</p>]]></content>
      
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯•é—®é¢˜ </tag>
            
            <tag> Qt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ä½¿ç”¨æ»¡è¡€ç‰ˆdeepseek</title>
      <link href="/2025/02/18/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E6%BB%A1%E8%A1%80%E7%89%88deepseek/"/>
      <url>/2025/02/18/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E6%BB%A1%E8%A1%80%E7%89%88deepseek/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ•™ç¨‹æ˜¯åœ¨ç¡…åŸºæµåŠ¨è·å–APIï¼Œå¹¶åœ¨Cherry Studioä¸Šé¢ä½¿ç”¨</p><h3 id="ä¸€ã€æ³¨å†Œç¡…åŸºæµåŠ¨"><a href="#ä¸€ã€æ³¨å†Œç¡…åŸºæµåŠ¨" class="headerlink" title="ä¸€ã€æ³¨å†Œç¡…åŸºæµåŠ¨"></a>ä¸€ã€æ³¨å†Œç¡…åŸºæµåŠ¨</h3><p>SiliconCloud åŸºäºåä¸ºäº‘æ˜‡è…¾äº‘æœåŠ¡ï¼Œé¦–å‘æ¨å‡ºäº† DeepSeek R1 &amp; V3 æ¨¡å‹æ¨ç†æœåŠ¡ã€‚æ³¨å†Œå³èµ é€ 14 å…ƒä½™é¢ï¼Œé‚€è¯·æ³¨å†Œè¿˜å¯å†è·å¾— 14 å…ƒä½™é¢ï¼ˆ2000 ä¸‡ Tokensï¼‰ã€‚</p><ul><li><strong>é‚€è¯·é“¾æ¥ï¼š</strong> <a href="https://cloud.siliconflow.cn/i/ePZNK3HT">ç¡…åŸºæµåŠ¨ç»Ÿä¸€ç™»å½•</a></li><li><strong>é‚€è¯·ç ï¼š</strong> ePZNK3HT</li></ul><p>æ³¨å†Œå®Œæˆåï¼Œå¯åœ¨æ¨¡å‹å¹¿åœºä¸Šæ‰¾åˆ° deepseek-ai&#x2F;DeepSeek-R1 æ¨¡å‹ï¼Œæ˜¾ç¤º 671B çš„æ»¡è¡€ç‰ˆã€‚</p><p><img src="https://bu.dusays.com/2025/02/18/67b3659255843.png"></p><p>ä½†è¿™ä¸ªé¡µé¢ä¸å¿…ç†ä¼šï¼Œç‚¹å‡»å·¦ä¾§APIå¯†é’¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç‚¹å‡»æ–°å»ºAPIå¯†é’¥ï¼ˆæ³¨æ„ä¿æŠ¤éšç§ï¼‰ï¼Œå¯†é’¥æè¿°éšä¾¿å¡«ã€‚</p><p><img src="https://bu.dusays.com/2025/02/18/67b366658f7b3.png"></p><p>å»ºå®ŒAPIå¯†é’¥åå°±æ¥åˆ°ç¬¬äºŒæ­¥äº†ã€‚</p><h3 id="äºŒã€ä¸‹è½½Cherry-Studio"><a href="#äºŒã€ä¸‹è½½Cherry-Studio" class="headerlink" title="äºŒã€ä¸‹è½½Cherry Studio"></a>äºŒã€ä¸‹è½½Cherry Studio</h3><p>ç”¨æˆ·å¯ä»¥é€‰æ‹©éœ€è¦çš„è½¯ä»¶æ¥è°ƒç”¨æ¥å£ã€‚æ¨èä½¿ç”¨ã€ŒCherryStudioã€è½¯ä»¶ï¼Œæ”¯æŒ Windowsã€Mac å’Œ Linux å®¢æˆ·ç«¯ã€‚</p><p><strong>Cherry Studio å®˜ç½‘ä¸‹è½½é“¾æ¥ï¼š</strong> <a href="https://docs.cherry-ai.com/cherrystudio/download?login=from_csdn">https://docs.cherry-ai.com/cherrystudio/download?login=from_csdn</a></p><p>å®‰è£…å®Œæˆä¹‹åï¼Œè¿è¡Œã€ŒCherryStudioã€è½¯ä»¶ï¼Œç‚¹å‡»å·¦ä¸‹è§’çš„è®¾ç½®æŒ‰é’®ï¼Œé€‰æ‹© <strong>ç¡…åŸºæµåŠ¨</strong>ï¼Œå¤åˆ¶ç¬¬ä¸€æ­¥åˆ›å»ºçš„APIå¯†é’¥ï¼Œè¾“å…¥åˆšåˆšå¤åˆ¶çš„å¯†é’¥ç²˜è´´è¿›å»å³å¯ã€‚ç‚¹å‡»æ£€æŸ¥ï¼Œè½¯ä»¶å°†ä¼šè‡ªåŠ¨å¯¹å¯†é’¥è¿›è¡ŒéªŒè¯ï¼Œé€šè¿‡å³å¯è¿›è¡Œä½¿ç”¨ã€‚</p><p><img src="https://bu.dusays.com/2025/02/18/67b3677c3ff7b.png"></p><p>é€šè¿‡ä¸‹é¢çš„ç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥æ·»åŠ ç¡…åŸºæµåŠ¨å¹³å°æ‰€æœ‰çš„æ¨¡å‹ï¼Œéœ€è¦ä»€ä¹ˆç‚¹å‡»æ·»åŠ å³å¯ã€‚</p><p><img src="https://bu.dusays.com/2025/02/18/67b368c449509.png"></p><p>ç‚¹å‡»åŠ©æ‰‹å³å¯è¿›å…¥å¯¹è¯é¡µé¢ï¼Œä¸Šæ–¹ç‚¹å‡»å³å¯é€‰æ‹©å¯¹è¯çš„æ¨¡å‹</p><p><img src="https://bu.dusays.com/2025/02/18/67b3690603033.png"></p><p>ä»¥ä¸Šæ˜¯å®Œæ•´çš„ä½¿ç”¨æ•™ç¨‹ï¼ï¼ï¼å¦‚æœå¯ä»¥çš„è¯ï¼Œè¯·ä½¿ç”¨æˆ‘çš„é‚€è¯·ç ï¼šePZNK3HT</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†äº« </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
